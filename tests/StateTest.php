<?php

use PHPUnit\Framework\TestCase;

use CleantalkSP\SpbctWP\State;

class StateTest extends TestCase
{
    private $state;

    public function setUp()
    {
        $this->state = new State(
            'spbc',
            array(
                'settings',
                'data',
                'remote_calls',
                'debug',
                'installing',
                'errors',
                'fw_stats'
            ),
            is_multisite(),
            is_main_site()
        );
    }

    public function testIsHaveErrors()
    {
        $this->state->errors = array();
        $this->assertFalse($this->state->isHaveErrors());

        $this->state->errors = array('cron'=>array());
        $this->assertFalse($this->state->isHaveErrors());

        $this->state->errors = array('apikey' => array(
            'error' => 'Access key is not valid. Key: someapikey',
            'error_time' => 1657218128,
        ));
        $this->assertTrue($this->state->isHaveErrors());
    }
}
