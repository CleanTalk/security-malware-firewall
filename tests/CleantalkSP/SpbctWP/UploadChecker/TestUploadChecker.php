<?php

class TestUploadChecker extends PHPUnit\Framework\TestCase
{
    private $bad_source;
    private $good_source;

    public function setUp()
    {
        $this->bad_source = __DIR__ . '/files/bad_source';
        $this->good_source = __DIR__ . '/files/good_source';
    }

    public function testCheckVulnerabilityBad()
    {
        $this->assertTrue(is_dir($this->bad_source));
        $result = \CleantalkSP\SpbctWP\Firewall\UploadChecker::checkVulnerability($this->bad_source);
        $this->assertTrue($result, $this->bad_source);
    }

    public function testCheckVulnerabilityGood()
    {
        $this->assertTrue(is_dir($this->good_source));
        $result = \CleantalkSP\SpbctWP\Firewall\UploadChecker::checkVulnerability($this->good_source);
        $this->assertFalse($result);
    }
}
