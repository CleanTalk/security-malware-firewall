{"version":3,"file":"spbc-scanner-plugin.min.js","sources":["spbc-scanner-plugin.js"],"sourcesContent":["'use strict';\n\nclass spbcMalwareScanner{\n\n\tfirst_start = true;\n\n\tactive = false;\n\n\troot  = '';\n\tsettings = [];\n\tstates = [\n\t\t'get_cms_hashes',\n\t\t'get_modules_hashes',\n\t\t'clean_results',\n\t\t'file_system_analysis',\n\t\t'get_approved_hashes',\n\t\t'signature_analysis',\n\t\t'heuristic_analysis',\n\t\t'auto_cure_backup',\n\t\t'auto_cure',\n\t\t'outbound_links',\n\t\t'frontend_analysis',\n\t\t'important_files_listing',\n\t\t'send_results',\n\t];\n\tstate = null;\n\toffset = 0;\n\tamount = 0;\n\ttotal_scanned = 0;\n\tscan_percent = 0;\n\tpercent_completed = 0;\n\n\tpaused = false;\n\n\tbutton = null;\n\tspinner = null;\n\n\tprogress_overall = null;\n\tprogressbar = null;\n\tprogressbar_text = null;\n\n\ttimeout = 60000;\n\n\tstate_timer = 0;\n\n\tconstructor ( properties ) {\n\n\t\tconsole.log('init');\n\n\t\t// Crunch for cure backups\n\t\tif( typeof properties['settings']['auto_cure'] !== 'undefined' ){\n\t\t\tproperties['settings']['scanner__auto_cure_backup'] = '1';\n\t\t}\n\n\t\tfor( let key in properties ){\n\t\t\tif( typeof this[key] !== 'undefined' ){\n\t\t\t\tthis[key] = properties[key];\n\t\t\t}\n\t\t}\n\n\t};\n\n\tactionControl(){\n\n\t\tif(this.state === null){\n\t\t\tthis.start();\n\n\t\t}else if(this.paused){\n\t\t\tthis.resume();\n\t\t\tthis.controller();\n\n\t\t}else{\n\t\t\tthis.pause();\n\t\t}\n\t};\n\n\tstart(){\n\n\t\tthis.active = true;\n\t\tthis.state_timer = Math.round(new Date().getTime() /1000);\n\n\t\tthis.state = this.getNextState( null );\n\n\t\tthis.setPercents( 0 );\n\t\tthis.scan_percent = 0;\n\t\tthis.offset = 0;\n\t\tthis.progress_overall.children('span')\n\t\t\t.removeClass('spbc_bold')\n\t\t\t.filter('.spbc_overall_scan_status_' + this.state)\n\t\t\t.addClass('spbc_bold');\n\n\t\tthis.progressbar.show(500);\n\t\tthis.progress_overall.show(500);\n\t\tthis.button.html(spbcScaner.button_scan_pause);\n\t\tthis.spinner.css({display: 'inline'});\n\n\t\tsetTimeout(() => {\n\t\t\tthis.controller();\n\t\t}, 1000);\n\n\t};\n\n\tpause( result, data, opt ){\n\t\tconsole.log('PAUSE');\n\t\tthis.button.html(spbcScaner.button_scan_resume);\n\t\tthis.spinner.css({display: 'none'});\n\t\tthis.paused = true;\n\t\tthis.active = false;\n\t};\n\n\tresume( opt ){\n\t\tconsole.log('RESUME');\n\t\tthis.button.html(spbcScaner.button_scan_pause);\n\t\tthis.spinner.css({display: 'inline'});\n\t\tthis.paused = false;\n\t\tthis.active = true;\n\t};\n\n\tend( reload ){\n\n\t\tthis.progressbar.hide(500);\n\t\tthis.progress_overall.hide(500);\n\t\tthis.button.html(spbcScaner.button_scan_perform);\n\t\tthis.spinner.css({display: 'none'});\n\t\tthis.state = null;\n\t\tthis.total_links = 0;\n\t\tthis.plug = false;\n\t\tthis.total_scanned = 0;\n\t\tthis.active = false;\n\n\t\tif(reload){\n\t\t\tdocument.location = document.location;\n\t\t}else{\n\t\t\tspbc_sendAJAXRequest(\n\t\t\t\t{action: 'spbc_scanner_tab__reload_accordion'},\n\t\t\t\t{\n\t\t\t\t\tnotJson: true,\n\t\t\t\t\tcallback: function(result, data, params, obj){\n\t\t\t\t\t\tjQuery(obj).accordion('destroy')\n\t\t\t\t\t\t\t.html(result)\n\t\t\t\t\t\t\t.accordion({\n\t\t\t\t\t\t\t\theader: 'h3',\n\t\t\t\t\t\t\t\theightStyle: 'content',\n\t\t\t\t\t\t\t\tcollapsible: true,\n\t\t\t\t\t\t\t\tactive: false,\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\tspbc_tbl__bulk_actions__listen();\n\t\t\t\t\t\tspbc_tbl__row_actions__listen();\n\t\t\t\t\t\tspbc_tbl__pagination__listen();\n\t\t\t\t\t\tspbc_tbl__sort__listen();\n\t\t\t\t\t\tspbcStartShowHide();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tjQuery('#spbc_scan_accordion')\n\t\t\t);\n\t\t}\n\n\t};\n\n\tcontroller( result ) {\n\n\t\tconsole.log(this.state);\n\n\t\t// The current stage is over. Switching to the new one\n\t\tif( typeof result !== 'undefined' && result.end ){\n\n\t\t\tthis.state = this.getNextState( this.state );\n\n\t\t\t// End condition\n\t\t\tif (typeof this.state === 'undefined'){\n\t\t\t\tthis.end();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Set percent to 0\n\t\t\tthis.setPercents( 0 );\n\t\t\tthis.scan_percent = 0;\n\t\t\tthis.offset = 0;\n\n\t\t\t// Changing visualizing of the current stage\n\t\t\tthis.progress_overall.children('span')\n\t\t\t\t.removeClass('spbc_bold')\n\t\t\t\t.filter('.spbc_overall_scan_status_' + this.state)\n\t\t\t\t.addClass('spbc_bold');\n\t\t}\n\n\t\t// Break execution if paused\n\t\tif( this.paused === true )\n\t\t\treturn;\n\n\t\t// // AJAX params\n\t\tlet data = {\n\t\t\taction: 'spbc_scanner_controller_front',\n\t\t\tmethod: this.state,\n\t\t\toffset: this.offset,\n\t\t};\n\n\t\tvar params = {\n\t\t\ttype:        'GET',\n\t\t\tsuccess:     this.success,\n\t\t\tcallback:    this.successCallback,\n\t\t\terror:       this.error,\n\t\t\terrorOutput: this.errorOutput,\n\t\t\tcomplete:    null,\n\t\t\tcontext:     this,\n\t\t\ttimeout:     120000\n\t\t};\n\n\t\tswitch (this.state) {\n\t\t\tcase 'get_modules_hashes':   this.amount = 2;        break;\n\t\t\tcase 'clear_table':          this.amount = 10000;    break;\n\t\t\tcase 'file_system_analysis': this.amount = 700;      break;\n\t\t\tcase 'auto_cure':            this.amount = 5;        break;\n\t        case 'outbound_links':       this.amount = 10;       break;\n\t        case 'frontend_analysis':    this.amount = 2;        break;\n\t\t\tcase 'signature_analysis':   this.amount = 10; data.status = 'UNKNOWN,MODIFIED,OK,INFECTED'; break;\n\t\t\tcase 'heuristic_analysis':   this.amount = 4;  data.status = 'UNKNOWN,MODIFIED,OK,INFECTED'; break;\n\t\t}\n\n\t\tdata.amount = this.amount;\n\n\t\tspbc_sendAJAXRequest(\n\t\t\tdata,\n\t\t\tparams,\n\t\t\tjQuery('#spbc_scan_accordion')\n\t\t);\n\n\t};\n\n\tgetNextState( state ) {\n\n\t\tstate = state === null ? this.states[0] : this.states[ this.states.indexOf( state ) + 1 ];\n\n\t\tif (typeof this.settings[ 'scanner__' + state ] !== 'undefined' && +this.settings[ 'scanner__' + state ] === 0)\n\t\t\tstate = this.getNextState( state );\n\n\t\treturn state;\n\t};\n\n\tsetPercents( percents ){\n\t\tthis.percent_completed = Math.floor( percents * 100 ) / 100;\n\t\tthis.progressbar.progressbar( 'option', 'value', this.percent_completed );\n\t\tthis.progressbar_text.text( spbcScaner[ 'progressbar_' + this.state ] + ' - ' + this.percent_completed + '%' );\n\t};\n\n\tsuccess( response ){\n\n\t\tif( !! response.error ){\n\n\t\t\tthis.error(\n\t\t\t\t{status: 200, responseText: response.error},\n\t\t\t\tresponse.error,\n\t\t\t\tresponse.msg\n\t\t\t);\n\n\t\t}else{\n\t\t\tif( this.successCallback )\n\t\t\t\tthis.successCallback( response, this.data, this.obj );\n\t\t}\n\n\t};\n\n\t// Processing response from backend\n\tsuccessCallback( result ){\n\n\t\tconsole.log( result );\n\n\t\tif( typeof result.total !== 'undefined' )\n\t\t\tthis.scan_percent = 100 / result.total;\n\n\t\tif( typeof result.processed_items !== 'undefined'){\n\n\t\t\tif( this.state === 'heuristic_analysis' && typeof result.total !== 0 )\n\t\t\t\tthis.logRaw('<h3 class=\"spbc_log-block_header\">Heuristic Analysis</h3>');\n\t\t\tif( this.state === 'signature_analysis' && typeof result.total !== 0 )\n\t\t\t\tthis.logRaw('<h3 class=\"spbc_log-block_header\">Signature Analysis</h3>');\n\n\t\t\tthis.logFileEntry( result.processed_items );\n\t\t}\n\t\t\n\t\t// Add link on shuffle salt if cured\n\t\tif (result.cured !== 'undefined' && Number(result.cured) > 0) {\n\t\t\tthis.showLinkForShuffleSalts(result.message);\n\t\t}\n\n\t\tif( result.end !== true && result.end !== 1 ){\n\t\t\tthis.setPercents( this.percent_completed + result.processed * this.scan_percent );\n\t\t\tthis.offset = this.offset + result.processed;\n\t\t\tthis.controller( result );\n\t\t}else{\n\t\t\tconsole.log( this.state + \" stage took \" + ( Math.round(new Date().getTime() /1000) - this.state_timer ) + \" seconds to complete\" );\n\t\t\tthis.state_timer = Math.round(new Date().getTime()/1000);\n\t\t\tthis.setPercents( 100 );\n\t\t\tthis.scan_percent = 0;\n\t\t\tthis.offset = 0;\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.controller( result );\n\t\t\t}, 300);\n\t\t}\n\t};\n\n\terror( xhr, status, error ){\n\n\t\tlet errorOutput = this.errorOutput;\n\n\t\tconsole.log( '%c APBCT_AJAX_ERROR', 'color: red;' );\n\t\tconsole.log( status );\n\t\tconsole.log( error );\n\t\tconsole.log( xhr );\n\n\t\tif( xhr.status === 200 ){\n\t\t\tif( status === 'parsererror' ){\n\t\t\t\terrorOutput( 'Unexpected response from server. See console for details.', this.state );\n\t\t\t\tconsole.log( '%c ' + xhr.responseText, 'color: pink;' );\n\t\t\t}else{\n\t\t\t\tlet error_string = status;\n\t\t\t\tif( typeof error !== 'undefined' )\n\t\t\t\t\terror_string += ' Additional info: ' + error;\n\t\t\t\terrorOutput( error_string, this.state );\n\t\t\t}\n\t\t}else if(xhr.status === 500){\n\t\t\terrorOutput( 'Internal server error.', this.state);\n\t\t}else\n\t\t\terrorOutput('Unexpected response code: ' + xhr.status + '. Error: ' + status, this.state);\n\n\t\tif( this.progressbar )\n\t\t\tthis.progressbar.fadeOut('slow');\n\n\t\tthis.end();\n\t};\n\n\terrorOutput( error_msg, stage ){\n\t\tspbcModal.open().putError( error_msg + '<br>Stage: ' + stage);\n\t};\n\n\tlogRaw(message_to_log ){\n\t\tjQuery('.spbc_log-wrapper').removeClass('spbc---hidden')\n\t\t\t.prepend( message_to_log );\n\t};\n\n\tlogFileEntry(items){\n\t\tvar ct_date = new Date(),\n\t\t\tshortMonthName = new Intl.DateTimeFormat(\"en-US\", { month: \"short\" }).format,\n\t\t\ttime_string = shortMonthName(ct_date) + ' ' + ct_date.getDate() + ' ' + ct_date.getFullYear() + ' ' + ct_date.getHours() + ':' + ct_date.getMinutes() + ':' + ct_date.getSeconds();\n\t\tfor ( var key in items ){\n\t\t\tthis.logRaw( '<p class=\"spbc_log-line\">' + time_string + ' - ' + items[ key ].path + '<b>: ' + items[ key ].status + '</b></p>' );\n\t\t}\n\t};\n\n\tshowLinkForShuffleSalts(message) {\n\t\tjQuery('#spbc_notice_about_shuffle_link').remove();\n\t\tjQuery(jQuery('.spbc_tab--active .spbc_wrapper_field p')[1])\n\t\t\t.after(\n\t\t\t\t'<div style=\"text-align: center;\" id=\"spbc_notice_about_shuffle_link\">' +\n\t\t\t\t'<a href=\"#\" ' +\n\t\t\t\t'onclick=\"spbc_switchTab(document.getElementsByClassName(\\'spbc_tab_nav-settings_general\\')[0], {target: \\'action-shuffle-salts-wrapper\\', action: \\'highlight\\', times: 3})\">' +\n\t\t\t\tmessage +\n\t\t\t\t'</a>' +\n\t\t\t\t'</div>'\n\t\t\t);\n\t}\n\n};"],"names":["spbcMalwareScanner","properties","key","console","log","this","state","start","paused","resume","controller","pause","active","state_timer","Math","round","Date","getTime","getNextState","setPercents","scan_percent","offset","progress_overall","children","removeClass","filter","addClass","progressbar","show","button","html","spbcScaner","button_scan_pause","spinner","css","display","setTimeout","result","data","opt","button_scan_resume","reload","hide","button_scan_perform","total_links","plug","total_scanned","document","location","spbc_sendAJAXRequest","action","notJson","callback","params","obj","jQuery","accordion","header","heightStyle","collapsible","spbc_tbl__bulk_actions__listen","spbc_tbl__row_actions__listen","spbc_tbl__pagination__listen","spbc_tbl__sort__listen","spbcStartShowHide","end","method","type","success","successCallback","error","errorOutput","complete","context","timeout","amount","status","states","indexOf","settings","percents","percent_completed","floor","progressbar_text","text","response","responseText","msg","total","processed_items","logRaw","logFileEntry","cured","Number","showLinkForShuffleSalts","message","processed","xhr","error_string","fadeOut","error_msg","stage","spbcModal","open","putError","message_to_log","prepend","items","ct_date","time_string","shortMonthName","Intl","DateTimeFormat","month","format","getDate","getFullYear","getHours","getMinutes","getSeconds","path","remove","after"],"mappings":"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"}