{"version":3,"sources":["spbc-scanner-plugin.js"],"names":["$","spbc","scanner","control","result","data","start","spbcObj","spbcScannerPlugin","param","ajax","end","pause","resume","clear","clear_callback","getHashes","countPlug","getHashesPlug","getHashesApproved","clearTable","count","scan","countModified_sign","status","checked","countModified_heur","scanModified_sign","scanModified_heur","cureBackup","countCure","cure","countLinks","scanLinks","sendResults","countFrontend","scanFrontend","getHashes_callback","countPlug_callback","getHashesPlug_callback","getHashesApproved_callback","count_callback","scan_callback","countModified_callback","scanModified_callback","cureBackup_callback","countCure_callback","cure_callback","countLinks_callback","scanLinks_callback","countFrontend_callback","scanFrontend_callback","sendResults_callback","fn","jQuery","methods","init","settings","console","log","this","window","opt","progressbar","show","progress_overall","button","html","spbcScaner","button_scan_pause","spinner","css","display","hide","button_scan_perform","removeData","paused","button_scan_resume","action","notJson","prev_action","children","removeClass","filter","addClass","progressbar_text","text","security","spbcSettings","ajax_nonce","type","url","ajaxurl","success","JSON","parse","error","alert","setTimeout","processed","precent_completed","scan_precent","Math","floor","callback","e","jqXHR","textStatus","errorThrown","timeout","check_signature","check_heuristic","auto_cure","check_links","check_frontend","total","warnings","long_scan","location","href","origin","pathname","amount","outdated","files","map","path","offset","found","total_scanned","total_links","parent","next","last_scan_was_just_now_links","printf","last_scan_was_just_now","attr","img_path","args","Array","prototype","slice","call","arguments","push","apply","extend","paused_status"],"mappings":"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","file":"spbc-scanner-plugin.min.js","sourcesContent":["(function($){\r\n\t\r\n\t// Wrappers\r\n\t$.spbc = {\r\n\t\tscanner: {\r\n\t\t\t\r\n\t\t\t// Controller\r\n\t\t\tcontrol: function(result, data, start) { return spbcObj.spbcScannerPlugin('control', result, data, start) },\r\n\t\t\t\r\n\t\t\t// Common\r\n\t\t\tdata:  function(param, data) { return spbcObj.spbcScannerPlugin('data', param, data)  },\r\n\t\t\tajax:  function(data)        { return spbcObj.spbcScannerPlugin('ajax', data)         },\r\n\t\t\tstart: function()            { return spbcObj.spbcScannerPlugin('start')              },\r\n\t\t\tend:   function()            { return spbcObj.spbcScannerPlugin('end')                },\r\n\t\t\tpause: function(result, data){ return spbcObj.spbcScannerPlugin('pause', result, data)},\r\n\t\t\tresume:function()            { return spbcObj.spbcScannerPlugin('resume')             },\r\n\t\t\t\r\n\t\t\t// Debug\r\n\t\t\tclear:           function() { return spbcObj.spbcScannerPlugin('clear')          },\r\n\t\t\tclear_callback:  function() { return spbcObj.spbcScannerPlugin('clear_callback') },\r\n\t\t\t\r\n\t\t\t// Actions\r\n\t\t\tgetHashes:     function()                     { return spbcObj.spbcScannerPlugin('getHashes')},\r\n\t\t\tcountPlug:     function()                     { return spbcObj.spbcScannerPlugin('countPlug')},\r\n\t\t\tgetHashesPlug: function()                     { return spbcObj.spbcScannerPlugin('getHashesPlug')},\r\n\t\t\tgetHashesApproved: function()                 { return spbcObj.spbcScannerPlugin('getHashesApproved')},\r\n\t\t\tclearTable:    function()                     { return spbcObj.spbcScannerPlugin('clearTable')},\r\n\t\t\tcount:         function()                     { return spbcObj.spbcScannerPlugin('count')},\r\n\t\t\tscan:          function()                     { return spbcObj.spbcScannerPlugin('scan')},\r\n\t\t\tcountModified_sign: function(status, checked) { return spbcObj.spbcScannerPlugin('countModified_sign', status, checked)},\r\n\t\t\tcountModified_heur: function(status, checked) { return spbcObj.spbcScannerPlugin('countModified_heur', status, checked)},\r\n\t\t\tscanModified_sign:  function(status)          { return spbcObj.spbcScannerPlugin('scanModified_sign',  status)},\r\n\t\t\tscanModified_heur:  function(status)          { return spbcObj.spbcScannerPlugin('scanModified_heur',  status)},\r\n\t\t\tcureBackup:    function()                     { return spbcObj.spbcScannerPlugin('cureBackup')},\r\n\t\t\tcountCure:     function()                     { return spbcObj.spbcScannerPlugin('countCure')},\r\n\t\t\tcure:          function()                     { return spbcObj.spbcScannerPlugin('cure')},\r\n\t\t\tcountLinks:    function()                     { return spbcObj.spbcScannerPlugin('countLinks')},\r\n\t\t\tscanLinks:     function()                     { return spbcObj.spbcScannerPlugin('scanLinks')},\r\n\t\t\tsendResults:   function()                     { return spbcObj.spbcScannerPlugin('sendResults')},\r\n            countFrontend: function()                     { return spbcObj.spbcScannerPlugin('countFrontend')},\r\n            scanFrontend:  function()                     { return spbcObj.spbcScannerPlugin('scanFrontend')},\r\n\r\n\t\t\t// Callbacks\r\n\t\t\tgetHashes_callback:     function(result, data) { return spbcObj.spbcScannerPlugin('getHashes_callback',     result, data) },\r\n\t\t\tcountPlug_callback:     function(result, data) { return spbcObj.spbcScannerPlugin('countPlug_callback',     result, data) },\r\n\t\t\tgetHashesPlug_callback: function(result, data) { return spbcObj.spbcScannerPlugin('getHashesPlug_callback', result, data) },\r\n\t\t\tgetHashesApproved_callback: function(result, data) { return spbcObj.spbcScannerPlugin('getHashesApproved_callback', result, data) },\r\n\t\t\tcount_callback:         function(result, data) { return spbcObj.spbcScannerPlugin('count_callback',         result, data) },\r\n\t\t\tscan_callback:          function(result, data) { return spbcObj.spbcScannerPlugin('scan_callback',          result, data) },\r\n\t\t\tcountModified_callback: function(result, data) { return spbcObj.spbcScannerPlugin('countModified_callback', result, data) },\r\n\t\t\tscanModified_callback:  function(result, data) { return spbcObj.spbcScannerPlugin('scanModified_callback',  result, data) },\r\n\t\t\tcureBackup_callback:    function(result, data) { return spbcObj.spbcScannerPlugin('cureBackup_callback',    result, data) },\r\n\t\t\tcountCure_callback:     function(result, data) { return spbcObj.spbcScannerPlugin('countCure_callback',     result, data) },\r\n\t\t\tcure_callback:          function(result, data) { return spbcObj.spbcScannerPlugin('cure_callback',          result, data) },\r\n\t\t\tcountLinks_callback:    function(result, data) { return spbcObj.spbcScannerPlugin('countLinks_callback',    result, data) },\r\n\t\t\tscanLinks_callback:     function(result, data) { return spbcObj.spbcScannerPlugin('scanLinks_callback',     result, data) },\r\n            countFrontend_callback: function(result, data) { return spbcObj.spbcScannerPlugin('countFrontend_callback', result, data) },\r\n            scanFrontend_callback:  function(result, data) { return spbcObj.spbcScannerPlugin('scanFrontend_callback',  result, data) },\r\n\t\t\tsendResults_callback:   function(result, data) { return spbcObj.spbcScannerPlugin('sendResults_callback',   result, data) },\r\n\t\t\t\r\n\t\t},\r\n\t};\r\n\t\r\n\t$.fn.spbcScannerPlugin = function(param){\r\n\t\t\r\n\t\tvar scanner = jQuery.spbc.scanner;\r\n\t\t\r\n\t\t// Methods\r\n\t\tvar methods = {\r\n\t\t\tinit: function(settings) {\r\n\t\t\t\tconsole.log('init');\r\n\t\t\t\tthis.data(settings);\r\n\t\t\t\twindow.spbcObj = this;\r\n\t\t\t},\r\n\t\t\tstart: function(opt){\r\n\t\t\t\topt.progressbar.show(500)\r\n\t\t\t\t\t.progressbar('option', 'value', 0);\r\n\t\t\t\topt.progress_overall.show(500);\r\n\t\t\t\topt.button.html(spbcScaner.button_scan_pause);\r\n\t\t\t\topt.spinner.css({display: 'inline'});\r\n\t\t\t},\r\n\t\t\tend: function(opt){\r\n\t\t\t\topt.progressbar.hide(500)\r\n\t\t\t\t\t.progressbar('option', 'value', 100);\r\n\t\t\t\topt.progress_overall.hide(500);\r\n\t\t\t\topt.button.html(spbcScaner.button_scan_perform);\r\n\t\t\t\topt.spinner.css({display: 'none'});\r\n\t\t\t\tthis.removeData('status');\r\n\t\t\t\tthis.data('total_links', 0)\r\n\t\t\t\t\t.data('plug', false)\r\n\t\t\t\t\t.data('total_scanned', 0);\r\n\t\t\t},\r\n\t\t\tresume: function(opt){\r\n\t\t\t\tconsole.log('RESUME');\r\n\t\t\t\topt.button.html(spbcScaner.button_scan_pause);\r\n\t\t\t\topt.spinner.css({display: 'inline'});\r\n\t\t\t\topt.paused = false;\r\n\t\t\t},\t\t\t\r\n\t\t\tpause: function(result, data, opt){\r\n\t\t\t\tconsole.log('PAUSE');\r\n\t\t\t\topt.button.html(spbcScaner.button_scan_resume);\r\n\t\t\t\topt.spinner.css({display: 'none'});\r\n\t\t\t\topt.result = result;\r\n\t\t\t\topt.data = data;\r\n\t\t\t\topt.paused = true;\r\n\t\t\t},\r\n\t\t\tdata: function(param, data){\r\n\t\t\t\tif(typeof data === 'undefined'){\r\n\t\t\t\t\tif(param === 'all')\r\n\t\t\t\t\t\treturn this.data();\r\n\t\t\t\t\treturn this.data(param);\r\n\t\t\t\t}\r\n\t\t\t\tthis.data(param, data);\r\n\t\t\t},\r\n\t\t\tclear: function(){\r\n\t\t\t\tconsole.log('CLEAR');\r\n\t\t\t\tscanner.start();\r\n\t\t\t\tthis.data('scan_status', 'clear')\r\n\t\t\t\t\t.data('callback', scanner.clear_callback);\r\n\t\t\t\tvar data = { action : 'spbc_scanner_clear' };\r\n\t\t\t\tscanner.ajax(data);\r\n\t\t\t},\r\n\t\t\tclear_callback: function(){\r\n\t\t\t\tconsole.log('CLEARED');\r\n\t\t\t\tscanner.end();\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// AJAX request\r\n\t\t\tajax: function(data, opt){\r\n\t\t\t\t// Default prarams\r\n\t\t\t\tvar notJson = this.data('notJson') || false;\r\n\t\t\t\tconsole.log(opt.status);\r\n\t\t\t\t// Changing text and precent\r\n\t\t\t\tif(opt.prev_action != data.action && typeof opt.progressbar !== 'undefined'){\r\n\t\t\t\t\topt.progress_overall.children('span')\r\n\t\t\t\t\t\t.removeClass('spbc_bold')\r\n\t\t\t\t\t\t.filter('.spbc_overall_scan_status_'+opt.status)\r\n\t\t\t\t\t\t\t.addClass('spbc_bold');\r\n\t\t\t\t\topt.progressbar.progressbar('option', 'value', 0);\r\n\t\t\t\t\topt.progressbar_text.text(spbcScaner['progressbar_'+opt.status] + ' - 0%');\r\n\t\t\t\t}\r\n\t\t\t\tthis.data('prev_action', data.action);\r\n\t\t\t\t\r\n\t\t\t\t// Default params\r\n\t\t\t\tdata.security = spbcSettings.ajax_nonce; // Adding security code\r\n\t\t\t\tjQuery.ajax({\r\n\t\t\t\t\ttype: \"GET\",\r\n\t\t\t\t\turl: spbcSettings.ajaxurl,\r\n\t\t\t\t\tdata: data,\r\n\t\t\t\t\tsuccess: function(result){\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\tif(!notJson) result = JSON.parse(result);\r\n\t\t\t\t\t\t\tif(result.error){\r\n\t\t\t\t\t\t\t\tconsole.log(result); console.log(data);\tconsole.log(opt);\r\n\t\t\t\t\t\t\t\talert('Error happens: ' + (result.error || 'Unkown'));\r\n\t\t\t\t\t\t\t\tsetTimeout(function(){ scanner.end(); }, 1000);\r\n\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\tconsole.log(result); console.log(data);\tconsole.log(opt);\r\n\t\t\t\t\t\t\t\tif(result.processed)\r\n\t\t\t\t\t\t\t\t\topt.button.data('precent_completed', opt.precent_completed + result.processed / opt.scan_precent);\r\n\t\t\t\t\t\t\t\tif(typeof opt.progressbar !== 'undefined'){\r\n\t\t\t\t\t\t\t\t\topt.progressbar.progressbar('option', 'value', Math.floor(opt.precent_completed));\r\n\t\t\t\t\t\t\t\t\topt.progressbar_text.text(spbcScaner['progressbar_'+opt.status] + ' - ' + Math.floor(opt.precent_completed) + '%');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif(typeof opt.callback !== 'undefined'){\r\n\t\t\t\t\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\t\t\t\t\topt.callback(result, data);\r\n\t\t\t\t\t\t\t\t\t}, 1000);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\t\talert('Unexpected error: ' + result);\r\n\t\t\t\t\t\t\tsetTimeout(function(){ scanner.end(); }, 1000);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t},\r\n\t\t\t\t\terror: function(jqXHR, textStatus, errorThrown){\r\n\t\t\t\t\t\tscanner.end();\r\n\t\t\t\t\t\tconsole.log('SPBC_AJAX_ERROR');\r\n\t\t\t\t\t\tconsole.log(jqXHR);\r\n\t\t\t\t\t\tconsole.log(textStatus);\r\n\t\t\t\t\t\tconsole.log(errorThrown);\r\n\t\t\t\t\t\tif(errorThrown)\r\n\t\t\t\t\t\t\talert(errorThrown);\r\n\t\t\t\t\t},\r\n\t\t\t\t\ttimeout: opt.timeout,\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// CONTROL\r\n\t\t\t\r\n\t\t\tcontrol: function(result, data, action, opt){\r\n\t\t\t\t\r\n\t\t\t\tthis.data('callback', scanner.control)\r\n\t\t\t\t\t.data('precent_completed', 100);\r\n\t\t\t\t\t\r\n\t\t\t\tif(typeof action !== 'undefined' && action){\r\n\t\t\t\t\tif(opt.status == null){\r\n\t\t\t\t\t\tscanner.start();\r\n\t\t\t\t\t\tscanner.getHashes();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tif(opt.paused == true){\r\n\t\t\t\t\t\t\tscanner.resume();\r\n\t\t\t\t\t\t\tresult = opt.result;\r\n\t\t\t\t\t\t\tdata = opt.data;\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tscanner.pause(result, data);\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif(opt.paused == true) return;\r\n\t\t\t\t\r\n\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\tswitch(opt.status){\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// WP Core\r\n\t\t\t\t\t\tcase 'get_hashes':\r\n\t\t\t\t\t\t\tscanner.countPlug();\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'count_hashes_plug':\r\n\t\t\t\t\t\t\tscanner.getHashesPlug();\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'get_hashes_plug':\r\n\t\t\t\t\t\t\tscanner.clearTable();\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'clear_table':\r\n\t\t\t\t\t\t\tscanner.count();\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'count':\r\n\t\t\t\t\t\t\tscanner.scan();\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'scan':\r\n\t\t\t\t\t\t\tscanner.getHashesApproved();\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'get_hashes_approved':\r\n\t\t\t\t\t\t\tif( +spbcScaner.check_signature ){ scanner.countModified_sign('UNKNOWN,MODIFIED,OK,INFECTED', 'NO,YES_HEURISTIC');  return;}\r\n\t\t\t\t\t\t\tif( +spbcScaner.check_heuristic ){ scanner.countModified_heur('UNKNOWN,MODIFIED,OK,INFECTED', 'NO,YES_SIGNATURE');  return;}\r\n\t\t\t\t\t\t\tif( +spbcScaner.auto_cure       ){ scanner.cureBackup(); return;}\r\n\t\t\t\t\t\t\tif( +spbcScaner.check_links )    { scanner.countLinks(); return;}\r\n\t\t\t\t\t\t\tif( +spbcScaner.check_frontend ) { scanner.countFrontend(); return;}\r\n\t\t\t\t\t\t\tscanner.sendResults();\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t// Signatures\r\n\t\t\t\t\t\tcase 'count_modified_sign':\r\n\t\t\t\t\t\t\tif(result.total > 30 || true)\r\n\t\t\t\t\t\t\t\topt.warnings.long_scan.show(500);\r\n\t\t\t\t\t\t\tscanner.scanModified_sign('UNKNOWN,MODIFIED,OK,INFECTED'); \r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tcase 'scan_modified_sign':\r\n\t\t\t\t\t\t\tif( +spbcScaner.check_heuristic ){ scanner.countModified_heur('UNKNOWN,MODIFIED,OK,INFECTED', 'NO,YES_SIGNATURE');  return;}\r\n\t\t\t\t\t\t\tif( +spbcScaner.auto_cure       ){ scanner.cureBackup(); return;}\r\n\t\t\t\t\t\t\tif( +spbcScaner.check_links )    { scanner.countLinks(); return; }\r\n                            if( +spbcScaner.check_frontend ) { scanner.countFrontend(); return;}\r\n\t\t\t\t\t\t\tscanner.sendResults(); \r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t// Heuristic\r\n\t\t\t\t\t\tcase 'count_modified_heur':\r\n\t\t\t\t\t\t\tif(result.total > 30)\r\n\t\t\t\t\t\t\t\topt.warnings.long_scan.show(500);\r\n\t\t\t\t\t\t\tscanner.scanModified_heur('UNKNOWN,MODIFIED,OK,INFECTED'); \r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tcase 'scan_modified_heur':\r\n\t\t\t\t\t\t\tif( +spbcScaner.auto_cure   )    { scanner.cureBackup();  return;}\r\n\t\t\t\t\t\t\tif( +spbcScaner.check_links )    { scanner.countLinks(); return;}\r\n                            if( +spbcScaner.check_frontend ) { scanner.countFrontend(); return;}\r\n\t\t\t\t\t\t\tscanner.sendResults(); \r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t// Cure\r\n\t\t\t\t\t\tcase 'cure_backup':\r\n\t\t\t\t\t\t\tscanner.countCure();\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'count_cure':\r\n\t\t\t\t\t\t\tscanner.cure();\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'cure':\r\n\t\t\t\t\t\t\tif( +spbcScaner.check_links ) { scanner.countLinks(); return;}\r\n                            if( +spbcScaner.check_frontend ) { scanner.countFrontend(); return;}\r\n\t\t\t\t\t\t\tscanner.sendResults(); \r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t// Links\r\n\t\t\t\t\t\tcase 'count_links':\r\n\t\t\t\t\t\t\tscanner.scanLinks();\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'scan_links':\r\n                            if( +spbcScaner.check_frontend ) { scanner.countFrontend(); return;}\r\n\t\t\t\t\t\t\tscanner.sendResults();\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t// Frontend\r\n\t\t\t\t\t\tcase 'frontend_count':\r\n\t\t\t\t\t\t\tscanner.scanFrontend();\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'frontend_scan':\r\n\t\t\t\t\t\t\tscanner.sendResults();\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t// Send results\r\n\t\t\t\t\t\tcase 'send_results':\r\n\t\t\t\t\t\t\tscanner.end();\r\n\t\t\t\t\t\t\topt.button.data('status', null);\r\n\t\t\t\t\t\t\tlocation.href=location.origin+location.pathname+\"?page=spbc&spbc_tab=scanner\";\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}, 300);\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// ACTIONS\r\n\t\t\tgetHashes: function(opt){\r\n\t\t\t\tconsole.log('GET_HASHES');\r\n\t\t\t\tthis.data('status', 'get_hashes');\r\n\t\t\t\tscanner.ajax({ action: 'spbc_scanner_get_remote_hashes'\t});\r\n\t\t\t},\r\n\t\t\tcountPlug: function(opt){\r\n\t\t\t\tconsole.log('COUNT_PLUG');\r\n\t\t\t\tthis.data('status', 'count_hashes_plug')\r\n\t\t\t\t\t.data('callback', scanner.countPlug_callback);\r\n\t\t\t\tscanner.ajax({ action: 'spbc_scanner_count_plug' });\r\n\t\t\t},\r\n\t\t\tcountPlug_callback: function(result, data, opt){\r\n\t\t\t\tconsole.log('PLUG_COUNTED');\r\n\t\t\t\tthis.data('scan_precent', +result.total / 98);\r\n\t\t\t\tscanner.control();\r\n\t\t\t},\r\n\t\t\tgetHashesPlug: function(opt){\r\n\t\t\t\tconsole.log('GETTING_HASHES');\r\n\t\t\t\tthis.data('status', 'get_hashes_plug')\r\n\t\t\t\t\t.data('precent_completed', 0)\r\n\t\t\t\t\t.data('callback', scanner.getHashesPlug_callback);\r\n\t\t\t\tscanner.ajax({\r\n\t\t\t\t\taction: 'spbc_scanner_get_remote_hashes_plug',\r\n\t\t\t\t\tamount : 2,\r\n\t\t\t\t});\r\n\t\t\t\tconsole.log('HASHES_RECEIVED');\r\n\t\t\t},\r\n\t\t\tgetHashesPlug_callback: function(result, data, opt){\r\n\t\t\t\tconsole.log('GETTING_HASHES_PLUG');\r\n                if(result.outdated)\r\n                    opt.warnings.outdated.show(500);\r\n\t\t\t\tif(result.processed >= data.amount){\r\n\t\t\t\t\tscanner.ajax(data);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tconsole.log('HASHES_PLUG_RECEIVED');\r\n\t\t\t\topt.progressbar.progressbar('option', 'value', 100);\r\n\t\t\t\topt.progressbar_text.text(spbcScaner['progressbar_'+opt.status] + ' - 100%');\r\n\t\t\t\tscanner.control();\r\n\t\t\t},\r\n\t\t\tgetHashesApproved: function(opt){\r\n\t\t\t\tconsole.log('GET_HASHES');\r\n\t\t\t\tthis.data('status', 'get_hashes_approved');\r\n\t\t\t\tscanner.ajax({ action: 'spbc_scanner_get_remote_hashes_approved' });\r\n\t\t\t},\r\n\t\t\tgetHashesApproved_callback: function(result, data, opt){\r\n\t\t\t\tconsole.log('HASHES_APPROVED_RECEIVED');\r\n\t\t\t\tthis.data('scan_precent', +result.total / 98);\r\n\t\t\t\tscanner.control();\r\n\t\t\t},\r\n\t\t\tclearTable: function(){\r\n\t\t\t\tconsole.log('CLEAR_TABLE');\r\n\t\t\t\tthis.data('status', 'clear_table');\r\n\t\t\t\tscanner.ajax({action : 'spbc_scanner_clear_table'});\r\n\t\t\t},\t\t\t\r\n\t\t\tcount: function(opt){\r\n\t\t\t\tconsole.log('COUNT_FILES');\r\n\t\t\t\tthis.data('status', 'count')\r\n\t\t\t\t\t.data('precent_completed', 0)\r\n\t\t\t\t\t.data('callback', scanner.count_callback);\r\n\t\t\t\tscanner.ajax({\r\n\t\t\t\t\taction : 'spbc_scanner_count_files',\r\n\t\t\t\t\ttotal : 0\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tcount_callback: function(result, data, opt){\r\n\t\t\t\tdata.total = data.total + result.files;\r\n\t\t\t\tif(!result.end){\r\n\t\t\t\t\tconsole.log('COUNTING FILES');\r\n\t\t\t\t\tdata.map = result.map;\r\n\t\t\t\t\tdata.path = result.path;\r\n\t\t\t\t\tscanner.ajax(data);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tconsole.log('FILES COUNTED');\r\n\t\t\t\tthis.data('precent_completed', 100);\r\n\t\t\t\tthis.data('total_scanned', this.data('total_scanned') + +data.total)\r\n\t\t\t\t\t.data('scan_precent', +data.total / 98);\r\n\t\t\t\tscanner.control();\r\n\t\t\t},\r\n\t\t\tscan: function(opt){\r\n\t\t\t\tconsole.log('SCAN FILES');\r\n\t\t\t\tdata = {\r\n\t\t\t\t\taction : 'spbc_scanner_scan',\r\n\t\t\t\t\toffset : 0,\r\n\t\t\t\t\tamount : 700,\r\n\t\t\t\t};\r\n\t\t\t\tthis.data('status', 'scan')\r\n\t\t\t\t\t.data('precent_completed', 0)\r\n\t\t\t\t\t.data('callback', scanner.scan_callback);\r\n\t\t\t\tscanner.ajax(data);\r\n\t\t\t},\r\n\t\t\tscan_callback: function(result, data, opt){\r\n\t\t\t\tconsole.log('SCANNING FILES');\r\n\t\t\t\tif(result.processed >= data.amount && !result.end){\r\n\t\t\t\t\tdata.offset += data.amount;\r\n\t\t\t\t\tdata.map = result.map;\r\n\t\t\t\t\tdata.path = result.path;\r\n\t\t\t\t\tscanner.ajax(data);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tconsole.log('SCAN COMPLETED');\r\n\t\t\t\topt.progressbar.progressbar('option', 'value', 100);\r\n\t\t\t\topt.progressbar_text.text(spbcScaner['progressbar_'+opt.status] + ' - 100%');\r\n\t\t\t\tscanner.control();\r\n\t\t\t},\r\n\t\t\tcountModified_heur: function(status, checked, opt){\r\n\t\t\t\tconsole.log('COUNT MODIFIED FILES');\r\n\t\t\t\tthis.data('status', 'count_modified_heur')\r\n\t\t\t\t\t.data('callback', scanner.countModified_callback);\r\n\t\t\t\tdata = {\r\n\t\t\t\t\taction : 'spbc_scanner_count_files__by_status',\r\n\t\t\t\t\tstatus : status,\r\n\t\t\t\t\tchecked: checked\r\n\t\t\t\t};\r\n\t\t\t\tscanner.ajax(data);\r\n\t\t\t},\r\n\t\t\tcountModified_sign: function(status, checked, opt){\r\n\t\t\t\tconsole.log('COUNT MODIFIED FILES');\r\n\t\t\t\tthis.data('status', 'count_modified_sign')\r\n\t\t\t\t\t.data('callback', scanner.countModified_callback);\r\n\t\t\t\tdata = {\r\n\t\t\t\t\taction : 'spbc_scanner_count_files__by_status',\r\n\t\t\t\t\tstatus : status,\r\n\t\t\t\t\tchecked: checked\r\n\t\t\t\t};\r\n\t\t\t\tscanner.ajax(data);\r\n\t\t\t},\r\n\t\t\tcountModified_callback: function(result, data, opt){\r\n\t\t\t\tconsole.log('MODIFIED FILES COUNTED');\r\n\t\t\t\tthis.data('scan_precent', +result.total / 98);\r\n\t\t\t\tscanner.control(result, data);\r\n\t\t\t},\r\n\t\t\tscanModified_sign: function(status, opt){\r\n\t\t\t\tconsole.log('SCAN MODIFIED FILES');\r\n\t\t\t\tthis.data('status', 'scan_modified_sign')\r\n\t\t\t\t\t.data('precent_completed', 0)\r\n\t\t\t\t\t.data('callback', scanner.scanModified_callback)\r\n\t\t\t\t\t.data('timeout',  60000);\r\n\t\t\t\tdata = {\r\n\t\t\t\t\taction : 'spbc_scanner_scan_signatures',\r\n\t\t\t\t\tamount : 50,\r\n\t\t\t\t\tstatus : status\r\n\t\t\t\t};\r\n\t\t\t\tscanner.ajax(data);\r\n\t\t\t},\r\n\t\t\tscanModified_heur: function(status, opt){\r\n\t\t\t\tconsole.log('SCAN MODIFIED FILES');\r\n\t\t\t\tthis.data('status', 'scan_modified_heur')\r\n\t\t\t\t\t.data('precent_completed', 0)\r\n\t\t\t\t\t.data('callback', scanner.scanModified_callback)\r\n\t\t\t\t\t.data('timeout',  60000);\r\n\t\t\t\tdata = {\r\n\t\t\t\t\taction : 'spbc_scanner_scan_heuristic',\r\n\t\t\t\t\tamount : 5,\r\n\t\t\t\t\tstatus : status\r\n\t\t\t\t};\r\n\t\t\t\tscanner.ajax(data);\r\n\t\t\t},\r\n\t\t\tscanModified_callback: function(result, data, opt){\r\n\t\t\t\tconsole.log('MODIFIED FILES SCANNING');\r\n\t\t\t\tif(result.processed >= data.amount){\r\n\t\t\t\t\tscanner.ajax(data);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tconsole.log('MODIFIED FILES END');\r\n\t\t\t\topt.progressbar.progressbar('option', 'value', 100);\r\n\t\t\t\topt.progressbar_text.text(spbcScaner['progressbar_'+opt.status] + ' - 100%');\r\n\t\t\t\tscanner.control();\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\tcureBackup: function(opt){\r\n\t\t\t\tconsole.log('CURE BACKUP');\r\n\t\t\t\tthis.data('status', 'cure_backup')\r\n\t\t\t\t\t.data('callback', scanner.cureBackup_callback);\r\n\t\t\t\tdata ={\r\n\t\t\t\t\taction: 'spbc_scanner_backup_sigantures',\r\n\t\t\t\t};\r\n\t\t\t\tscanner.ajax(data);\r\n\t\t\t},\r\n\t\t\tcureBackup_callback: function(result, data, opt){\r\n\t\t\t\tconsole.log('CURE BACKUPED');\r\n\t\t\t\tthis.data('scan_precent', +result.total / 98);\r\n\t\t\t\tscanner.control();\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\tcountCure: function(opt){\r\n\t\t\t\tconsole.log('COUNT LINKS');\r\n\t\t\t\tthis.data('status', 'count_cure')\r\n\t\t\t\t\t.data('callback', scanner.countCure_callback);\r\n\t\t\t\tdata ={\r\n\t\t\t\t\taction: 'spbc_scanner_count_cure',\r\n\t\t\t\t};\r\n\t\t\t\tscanner.ajax(data);\r\n\t\t\t},\r\n\t\t\tcountCure_callback: function(result, data, opt){\r\n\t\t\t\tconsole.log('CURE COUNTED');\r\n\t\t\t\tthis.data('scan_precent', +result.total / 98);\r\n\t\t\t\tscanner.control();\r\n\t\t\t},\r\n\t\t\tcure: function(opt){\r\n\t\t\t\tconsole.log('CURE');\r\n\t\t\t\tthis.data('status', 'cure')\r\n\t\t\t\t\t.data('precent_completed', 0)\r\n\t\t\t\t\t.data('callback', scanner.cure_callback)\r\n\t\t\t\t\t.data('timeout', 30000);\r\n\t\t\t\tdata ={\r\n\t\t\t\t\taction: 'spbc_scanner_cure',\r\n\t\t\t\t\tamount: 1,\r\n\t\t\t\t};\r\n\t\t\t\tscanner.ajax(data);\r\n\t\t\t},\r\n\t\t\tcure_callback: function(result, data, opt){\r\n\t\t\t\tconsole.log('FILES CURED');\r\n\t\t\t\topt.progressbar.progressbar('option', 'value', 100);\r\n\t\t\t\topt.progressbar_text.text(spbcScaner['progressbar_'+opt.status] + ' - 100%');\r\n\t\t\t\tscanner.control();\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\tcountLinks: function(opt){\r\n\t\t\t\tconsole.log('COUNT LINKS');\r\n\t\t\t\tthis.data('status', 'count_links')\r\n\t\t\t\t\t.data('callback', scanner.countLinks_callback);\r\n\t\t\t\tdata ={\r\n\t\t\t\t\taction: 'spbc_scanner_count_links',\r\n\t\t\t\t};\r\n\t\t\t\tscanner.ajax(data);\r\n\t\t\t},\r\n\t\t\tcountLinks_callback: function(result, data, opt){\r\n\t\t\t\tconsole.log('LINKS COUNTED');\r\n\t\t\t\tthis.data('scan_precent', +result.total / 98);\r\n\t\t\t\tscanner.control();\r\n\t\t\t},\r\n\t\t\tscanLinks: function(opt){\r\n\t\t\t\tconsole.log('SCAN LINKS');\r\n\t\t\t\tthis.data('status', 'scan_links')\r\n\t\t\t\t\t.data('precent_completed', 0)\r\n\t\t\t\t\t.data('callback', scanner.scanLinks_callback)\r\n\t\t\t\t\t.data('timeout', 30000);\r\n\t\t\t\tvar data ={\r\n\t\t\t\t\taction: 'spbc_scanner_scan_links',\r\n\t\t\t\t\tamount: 10,\r\n\t\t\t\t};\r\n\t\t\t\tscanner.ajax(data);\r\n\t\t\t},\r\n\t\t\tscanLinks_callback: function(result, data, opt){\r\n\t\t\t\tconsole.log('LINKS SCANNING');\r\n\t\t\t\tif ( +result.processed){\r\n\t\t\t\t\tthis.data('total_links', +opt.total + +result.found);\r\n\t\t\t\t\tscanner.ajax(data);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tconsole.log('LINKS SCANNED');\r\n\t\t\t\topt.progressbar.progressbar('option', 'value', 100);\r\n\t\t\t\topt.progressbar_text.text(spbcScaner['progressbar_'+opt.status] + ' - 100%');\r\n\t\t\t\tscanner.control();\r\n\t\t\t},\r\n            countFrontend: function(opt){\r\n                console.log('COUNT FRONTEND');\r\n                this.data('status', 'frontend_count')\r\n                    .data('callback', scanner.countFrontend_callback);\r\n                var data ={\r\n                    action: 'spbc_scanner_frontend__count',\r\n                };\r\n                scanner.ajax(data);\r\n            },\r\n            countFrontend_callback: function(result, data, opt){\r\n                console.log('FRONTEND COUNTED');\r\n                this.data('scan_precent', +result.total / 98);\r\n                scanner.control();\r\n            },\r\n            scanFrontend: function(opt){\r\n                console.log('SCAN FRONTEND');\r\n                this.data('status', 'frontend_scan')\r\n                    .data('precent_completed', 0)\r\n                    .data('callback', scanner.scanFrontend_callback)\r\n                    .data('timeout', 30000);\r\n                var data ={\r\n                    action: 'spbc_scanner_frontend__scan',\r\n                    amount: 1,\r\n                };\r\n                scanner.ajax(data);\r\n            },\r\n            scanFrontend_callback: function(result, data, opt){\r\n                console.log('FRONTEND SCANNING');\r\n                if ( +result.processed){\r\n                    this.data('total_links', +opt.total + +result.found);\r\n                    scanner.ajax(data);\r\n                    return;\r\n                }\r\n                console.log('FRONTEND SCANNED');\r\n                opt.progressbar.progressbar('option', 'value', 100);\r\n                opt.progressbar_text.text(spbcScaner['progressbar_'+opt.status] + ' - 100%');\r\n                scanner.control();\r\n            },\r\n\t\t\tsendResults: function(){\r\n\t\t\t\tconsole.log('SEND RESULTS');\r\n\t\t\t\tthis.data('status', 'send_results')\r\n\t\t\t\t\t.data('callback', scanner.sendResults_callback);\r\n\t\t\t\tvar data = {\r\n\t\t\t\t\taction: 'spbc_scanner_send_results',\r\n\t\t\t\t\ttotal_scanned: this.data('total_scanned'),\r\n\t\t\t\t};\r\n\t\t\t\tif( +spbcScaner.check_links )\r\n\t\t\t\t\tdata.total_links = this.data('total_links');\r\n\t\t\t\tscanner.ajax(data);\r\n\t\t\t},\r\n\t\t\tsendResults_callback: function(result, data, opt){\r\n\t\t\t\tconsole.log('RESULTS_SENT');\r\n\t\t\t\tif( +spbcScaner.check_links ){\r\n\t\t\t\t\topt.button.parent().next().html(spbcScaner.last_scan_was_just_now_links.printf(data.total_scanned, data.total_links));\r\n\t\t\t\t}else{\r\n\t\t\t\t\topt.button.parent().next().html(spbcScaner.last_scan_was_just_now.printf(data.total_scanned)); \r\n\t\t\t\t}\t\r\n\t\t\t\t\t\r\n\t\t\t\tjQuery('#spbc_scanner_status_icon').attr('src', spbcSettings.img_path + '/yes.png');\r\n\t\t\t\tscanner.control();\r\n\t\t\t},\r\n\t\t};\r\n\t\t\r\n\t\t// Method call. Passing current settings to each function as the last element.\r\n\t\tif(typeof methods[param]==='function'){\r\n\t\t\tvar args = Array.prototype.slice.call(arguments, 1);\r\n\t\t\tif(param !== 'data')\r\n\t\t\t\targs.push(this.data());\r\n\t\t\t// console.log(param); console.log(args);\r\n\t\t\treturn methods[param].apply(this, args);\r\n\t\t}\r\n\t\t\r\n\t\t// Init\r\n\t\tif(typeof param === 'object'){\r\n\t\t\tvar settings = $.extend({\r\n\t\t\t\t\r\n\t\t\t\tstatus: null,\r\n\t\t\t\tpaused_status: null,\r\n\t\t\t\tpaused: false,\r\n\t\t\t\t\r\n\t\t\t\ttotal_links: 0,\r\n\t\t\t\ttotal_scanned: 0,\r\n\t\t\t\t\r\n\t\t\t\tbutton: null,\r\n\t\t\t\tspinner: null,\r\n\t\t\t\t\r\n\t\t\t\tprogress_overall: null,\r\n\t\t\t\tprogressbar: null,\r\n\t\t\t\tprogressbar_text: null,\r\n\t\t\t\t\r\n\t\t\t\tcallback: null,\r\n\t\t\t\ttimeout: 60000,\r\n\t\t\t}, param);\r\n\t\t\treturn methods.init.apply(this, [settings]);\r\n\t\t}\r\n\t\t\r\n\t\t// Error\r\n\t\t$.error( 'Method \"' +  param + '\" is unset for jQuery.spbcScannerPlugin' );\t\t\r\n\t};\r\n\t\r\n})(jQuery);\r\n"]}