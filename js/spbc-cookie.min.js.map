{"version":3,"file":"spbc-cookie.min.js","sources":["spbc-cookie.js"],"sourcesContent":["function spbc_setCookie( cookies, value, expires ){\r\n\r\n    if( typeof cookies === 'string' && ( typeof value === 'string' || typeof value === 'number' ) ){\r\n        cookies = [ [ cookies, value, expires ] ];\r\n    }\r\n\r\n    // Cookies disabled\r\n    if( +spbcPublic.data__set_cookies === 0 ){\r\n        return;\r\n\r\n    // Using traditional cookies\r\n    }else if( +spbcPublic.data__set_cookies === 1 ){\r\n        cookies.forEach( function (item, i, arr\t) {\r\n            var expires = typeof item[2] !== 'undefined' ? \"expires=\" + expires + '; ' : '';\r\n            var ctSecure = location.protocol === 'https:' ? '; secure' : '';\r\n            document.cookie = item[0] + \"=\" + encodeURIComponent(item[1]) + \"; \" + expires + \"path=/; samesite=lax\" + ctSecure;\r\n        });\r\n\r\n    // Using alternative cookies\r\n    }else if( +spbcPublic.data__set_cookies === 2 ){\r\n\r\n        // Using REST API handler\r\n        if( +spbcPublic.data__set_cookies__alt_sessions_type === 1 ){\r\n            spbc_sendRESTRequest(\r\n                'alt_sessions',\r\n                {\r\n                    method: 'POST',\r\n                    data: { cookies: cookies }\r\n                }\r\n            );\r\n\r\n        }\r\n        // Using AJAX request and handler\r\n        // }else if( +spbcPublic.data__set_cookies__alt_sessions_type === 2 ) {\r\n        //     apbct_public_sendAJAX(\r\n        //         {\r\n        //             action: 'apbct_alt_session__save__AJAX',\r\n        //             cookies: cookies,\r\n        //         },\r\n        //         {\r\n        //             apbct_ajax: 1,\r\n        //             notJson: 1,\r\n        //         }\r\n        //     );\r\n        // }\r\n    }\r\n}\r\n\r\nfunction spbc_sendRESTRequest( route, params ) {\r\n\r\n    var callback = params.callback || null;\r\n    var data     = params.data || [];\r\n    var method   = params.method || 'POST';\r\n\r\n    jQuery.ajax({\r\n        type: method,\r\n        url: spbcPublic._rest_url + 'cleantalk-security/v1/' + route,\r\n        data: data,\r\n        beforeSend : function ( xhr ) {\r\n            xhr.setRequestHeader( 'X-WP-Nonce', spbcPublic._rest_nonce );\r\n        },\r\n        success: function(result){\r\n            if(result.error){\r\n                console.log('Error happens: ' + (result.error || 'Unknown'));\r\n            }else{\r\n                if(callback) {\r\n                    var obj = null;\r\n                    callback(result, route, params, obj);\r\n                }\r\n            }\r\n        },\r\n        error: function(jqXHR, textStatus, errorThrown){\r\n            if( errorThrown ) {\r\n                console.log('SPBCT_REST_ERROR');\r\n                console.log(jqXHR);\r\n                console.log(textStatus);\r\n                console.log('Security by Cleantalk plugin REST API error: ' + errorThrown + ' Please, contact Cleantalk tech support https://wordpress.org/support/plugin/security-malware-firewall/');\r\n            }\r\n        },\r\n    });\r\n\r\n}"],"names":["spbc_setCookie","cookies","value","expires","spbcPublic","data__set_cookies","forEach","item","i","arr","ctSecure","location","protocol","document","cookie","encodeURIComponent","data__set_cookies__alt_sessions_type","spbc_sendRESTRequest","method","data","route","params","callback","jQuery","ajax","type","url","_rest_url","beforeSend","xhr","setRequestHeader","_rest_nonce","success","result","error","console","log","jqXHR","textStatus","errorThrown"],"mappings":"AAAA,SAASA,eAAgBC,EAASC,EAAOC,GAEd,iBAAZF,GAA2C,iBAAVC,GAAuC,iBAAVA,IACrED,EAAU,CAAE,CAAEA,EAASC,EAAOC,KAII,IAAjCC,WAAWC,oBAI4B,IAAjCD,WAAWC,kBAClBJ,EAAQK,QAAS,SAAUC,EAAMC,EAAGC,GAChC,IAAIN,OAA6B,IAAZI,EAAK,GAAqB,WAAaJ,EAAU,KAAO,GACzEO,EAAiC,WAAtBC,SAASC,SAAwB,WAAa,GAC7DC,SAASC,OAASP,EAAK,GAAK,IAAMQ,mBAAmBR,EAAK,IAAM,KAAOJ,EAAU,uBAAyBO,IAItE,IAAjCN,WAAWC,mBAGuC,IAApDD,WAAWY,sCACZC,qBACI,eACA,CACIC,OAAQ,OACRC,KAAM,CAAElB,QAASA,MAqBrC,SAASgB,qBAAsBG,EAAOC,GAElC,IAAIC,EAAWD,EAAOC,UAAY,KAC9BH,EAAWE,EAAOF,MAAQ,GAC1BD,EAAWG,EAAOH,QAAU,OAEhCK,OAAOC,KAAK,CACRC,KAAMP,EACNQ,IAAKtB,WAAWuB,UAAY,yBAA2BP,EACvDD,KAAMA,EACNS,WAAa,SAAWC,GACpBA,EAAIC,iBAAkB,aAAc1B,WAAW2B,cAEnDC,QAAS,SAASC,GACXA,EAAOC,MACNC,QAAQC,IAAI,mBAAqBH,EAAOC,OAAS,YAE9CZ,GAECA,EAASW,EAAQb,EAAOC,EADd,OAKtBa,MAAO,SAASG,EAAOC,EAAYC,GAC3BA,IACAJ,QAAQC,IAAI,oBACZD,QAAQC,IAAIC,GACZF,QAAQC,IAAIE,GACZH,QAAQC,IAAI,gDAAkDG,EAAc"}