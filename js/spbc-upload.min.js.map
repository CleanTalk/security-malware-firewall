{"version":3,"file":"spbc-upload.min.js","sources":["spbc-upload.js"],"sourcesContent":["var spbc_error_msg_count = 0;\n\njQuery(document).ready(function(){\n\t\n\t// Count error messages each 100ms\n\tvar spbc_timer = setTimeout(spbc_check_new_files, 1000);\n\t\n});\n\nfunction spbc_check_new_files(){\t\n\t// If there more messages than were, fire AJAX request to get data\n\tif(spbc_error_msg_count < spbc_get_error_msgs().length){\n\t\tspbc_error_msg_count = spbc_get_error_msgs().length;\n\t\tspbc_get_latest_blocked_file();\n\t// If there less messages than were, recount\n\t}else if(spbc_error_msg_count > spbc_get_error_msgs().length){\n\t\tspbc_error_msg_count = spbc_get_error_msgs().length;\n\t}\n\tspbc_timer = setTimeout(spbc_check_new_files, 1000);\n}\n\nfunction spbc_get_error_msgs(){\n\tif(jQuery('#media-upload-error .error').length)\n\t\treturn jQuery('#media-upload-error .error');\n\telse if(jQuery('.upload-error-message').length)\n\t\treturn jQuery('.upload-error-message');\n\telse\n\t\treturn [];\n}\n\n//Fires AJAX request to get more info about the block\nfunction spbc_get_latest_blocked_file(){\n\tvar data = {action: 'spbc_check_file_block', timestamp: spbc_timestamp()},\n\t\tparams = {callback: spbc_check_file_block__callback},\n\t\tobj = spbc_get_error_msgs().first();\n\tspbc_sendAJAXRequest(data, params, obj);\n}\n\n// Callback. Sets correct error message with details\nfunction spbc_check_file_block__callback(result, data, params, obj){\n\tif(result.blocked){\n\t\tvar pattern = result.pattern.CRITICAL || result.pattern.DANGER || result.pattern.SUSPICIOUS;\n\t\tobj.html(result.warning + '<br>' + result.pattern_title + ' ' + pattern);\n\t}\n\treturn;\n}"],"names":["spbc_error_msg_count","spbc_check_new_files","spbc_get_error_msgs","length","spbc_get_latest_blocked_file","spbc_timer","setTimeout","jQuery","data","action","timestamp","spbc_timestamp","params","callback","spbc_check_file_block__callback","obj","first","spbc_sendAJAXRequest","result","pattern","blocked","CRITICAL","DANGER","SUSPICIOUS","html","warning","pattern_title","document","ready"],"mappings":"AAAA,IAAIA,qBAAuB,EAS3B,SAASC,uBAELD,qBAAuBE,sBAAsBC,QAC/CH,qBAAuBE,sBAAsBC,OAC7CC,gCAEQJ,qBAAuBE,sBAAsBC,SACrDH,qBAAuBE,sBAAsBC,QAE9CE,WAAaC,WAAWL,qBAAsB,KAG/C,SAASC,sBACR,OAAGK,OAAO,8BAA8BJ,OAChCI,OAAO,8BACPA,OAAO,yBAAyBJ,OAChCI,OAAO,yBAEP,GAIT,SAASH,+BACR,IAAII,EAAO,CAACC,OAAQ,wBAAyBC,UAAWC,kBACvDC,EAAS,CAACC,SAAUC,iCACpBC,EAAMb,sBAAsBc,QAC7BC,qBAAqBT,EAAMI,EAAQG,GAIpC,SAASD,gCAAgCI,EAAQV,EAAMI,EAAQG,GAC9D,IACKI,EADFD,EAAOE,UACLD,EAAUD,EAAOC,QAAQE,UAAYH,EAAOC,QAAQG,QAAUJ,EAAOC,QAAQI,WACjFR,EAAIS,KAAKN,EAAOO,QAAU,OAASP,EAAOQ,cAAgB,IAAMP,IAxClEZ,OAAOoB,UAAUC,MAAM,WAGLtB,WAAWL,qBAAsB"}