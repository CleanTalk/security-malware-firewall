!function(t){t.spbc={scanner:{control:function(n,c,a){return spbcObj.spbcScannerPlugin("control",n,c,a)},data:function(n,c){return spbcObj.spbcScannerPlugin("data",n,c)},ajax:function(n){return spbcObj.spbcScannerPlugin("ajax",n)},start:function(){return spbcObj.spbcScannerPlugin("start")},end:function(){return spbcObj.spbcScannerPlugin("end")},pause:function(n,c){return spbcObj.spbcScannerPlugin("pause",n,c)},resume:function(){return spbcObj.spbcScannerPlugin("resume")},clear:function(){return spbcObj.spbcScannerPlugin("clear")},clear_callback:function(){return spbcObj.spbcScannerPlugin("clear_callback")},log__raw:function(n){return spbcObj.spbcScannerPlugin("log__raw",n)},log__file_entry:function(n){return spbcObj.spbcScannerPlugin("log__file_entry",n)},getHashes:function(){return spbcObj.spbcScannerPlugin("getHashes")},countPlug:function(){return spbcObj.spbcScannerPlugin("countPlug")},getHashesPlug:function(){return spbcObj.spbcScannerPlugin("getHashesPlug")},getHashesApproved:function(){return spbcObj.spbcScannerPlugin("getHashesApproved")},clearTable:function(){return spbcObj.spbcScannerPlugin("clearTable")},count:function(){return spbcObj.spbcScannerPlugin("count")},scan:function(){return spbcObj.spbcScannerPlugin("scan")},countModified_sign:function(n,c){return spbcObj.spbcScannerPlugin("countModified_sign",n,c)},countModified_heur:function(n,c){return spbcObj.spbcScannerPlugin("countModified_heur",n,c)},scanModified_sign:function(n){return spbcObj.spbcScannerPlugin("scanModified_sign",n)},scanModified_heur:function(n){return spbcObj.spbcScannerPlugin("scanModified_heur",n)},cureBackup:function(){return spbcObj.spbcScannerPlugin("cureBackup")},countCure:function(){return spbcObj.spbcScannerPlugin("countCure")},cure:function(){return spbcObj.spbcScannerPlugin("cure")},countLinks:function(){return spbcObj.spbcScannerPlugin("countLinks")},scanLinks:function(){return spbcObj.spbcScannerPlugin("scanLinks")},sendResults:function(){return spbcObj.spbcScannerPlugin("sendResults")},countFrontend:function(){return spbcObj.spbcScannerPlugin("countFrontend")},scanFrontend:function(){return spbcObj.spbcScannerPlugin("scanFrontend")},checkListing:function(){return spbcObj.spbcScannerPlugin("checkListing")},getHashes_callback:function(n,c){return spbcObj.spbcScannerPlugin("getHashes_callback",n,c)},countPlug_callback:function(n,c){return spbcObj.spbcScannerPlugin("countPlug_callback",n,c)},getHashesPlug_callback:function(n,c){return spbcObj.spbcScannerPlugin("getHashesPlug_callback",n,c)},getHashesApproved_callback:function(n,c){return spbcObj.spbcScannerPlugin("getHashesApproved_callback",n,c)},count_callback:function(n,c){return spbcObj.spbcScannerPlugin("count_callback",n,c)},scan_callback:function(n,c){return spbcObj.spbcScannerPlugin("scan_callback",n,c)},countModified_callback:function(n,c){return spbcObj.spbcScannerPlugin("countModified_callback",n,c)},scanModified_callback:function(n,c){return spbcObj.spbcScannerPlugin("scanModified_callback",n,c)},cureBackup_callback:function(n,c){return spbcObj.spbcScannerPlugin("cureBackup_callback",n,c)},countCure_callback:function(n,c){return spbcObj.spbcScannerPlugin("countCure_callback",n,c)},cure_callback:function(n,c){return spbcObj.spbcScannerPlugin("cure_callback",n,c)},countLinks_callback:function(n,c){return spbcObj.spbcScannerPlugin("countLinks_callback",n,c)},scanLinks_callback:function(n,c){return spbcObj.spbcScannerPlugin("scanLinks_callback",n,c)},countFrontend_callback:function(n,c){return spbcObj.spbcScannerPlugin("countFrontend_callback",n,c)},scanFrontend_callback:function(n,c){return spbcObj.spbcScannerPlugin("scanFrontend_callback",n,c)},sendResults_callback:function(n,c){return spbcObj.spbcScannerPlugin("sendResults_callback",n,c)}}},t.fn.spbcScannerPlugin=function(n){var e=jQuery.spbc.scanner,c={init:function(n){console.log("init"),this.data(n),window.spbcObj=this},start:function(n){n.progressbar.show(500).progressbar("option","value",0),n.progress_overall.show(500),n.button.html(spbcScaner.button_scan_pause),n.spinner.css({display:"inline"})},end:function(n){n.progressbar.hide(500).progressbar("option","value",100),n.progress_overall.hide(500),n.button.html(spbcScaner.button_scan_perform),n.spinner.css({display:"none"}),this.removeData("status"),this.data("total_links",0).data("plug",!1).data("total_scanned",0),spbc_sendAJAXRequest({action:"spbc_scanner_tab__reload_accordion"},{notJson:!0,callback:function(n,c,a,t){jQuery(t).accordion("destroy"),jQuery(t).html(n),jQuery(t).accordion({header:"h3",heightStyle:"content",collapsible:!0,active:!1}),spbc_tbl__bulk_actions__listen(),spbc_tbl__row_actions__listen(),spbc_tbl__pagination__listen(),spbc_tbl__sort__listen(),spbcStartShowHide()}},jQuery("#spbc_scan_accordion"))},resume:function(n){console.log("RESUME"),n.button.html(spbcScaner.button_scan_pause),n.spinner.css({display:"inline"}),n.paused=!1},pause:function(n,c,a){console.log("PAUSE"),a.button.html(spbcScaner.button_scan_resume),a.spinner.css({display:"none"}),a.result=n,a.data=c,a.paused=!0},data:function(n,c){if(void 0===c)return"all"===n?this.data():this.data(n);this.data(n,c)},clear:function(){console.log("CLEAR"),e.start(),this.data("scan_status","clear").data("callback",e.clear_callback);e.ajax({action:"spbc_scanner_clear"})},clear_callback:function(){console.log("CLEARED"),e.end()},log__raw:function(n){jQuery(".spbc_log-wrapper").removeClass("spbc---hidden"),jQuery(".spbc_log-wrapper").prepend(n)},log__file_entry:function(n){var c,a=new Date,t=new Intl.DateTimeFormat("en-US",{month:"short"}).format;for(c in time_string=t(a)+" "+a.getDate()+" "+a.getFullYear()+" "+a.getHours()+":"+a.getMinutes()+":"+a.getSeconds(),n)e.log__raw('<p class="spbc_log-line">'+time_string+" - "+n[c].path+"<b>: "+n[c].status+"</b></p>")},ajax:function(n,a){var t=this.data("notJson")||!1;console.log(a.status),a.prev_action!=n.action&&void 0!==a.progressbar&&(a.progress_overall.children("span").removeClass("spbc_bold").filter(".spbc_overall_scan_status_"+a.status).addClass("spbc_bold"),a.progressbar.progressbar("option","value",0),a.progressbar_text.text(spbcScaner["progressbar_"+a.status]+" - 0%")),this.data("prev_action",n.action),n.security=spbcSettings.ajax_nonce,n.no_cache=Math.random(),jQuery.ajax({type:"GET",url:spbcSettings.ajaxurl,data:n,success:function(c){try{(c=!t?JSON.parse(c):c).error?(console.log(c),console.log(n),console.log(a),spbcModal.open().putError("Security by Cleantalk. Error happens: "+(c.error||"Unkown")),setTimeout(function(){e.end()},1e3)):(console.log(c),void 0!==c.processed_items&&c.processed_items&&e.log__file_entry(c.processed_items),c.processed&&a.button.data("precent_completed",a.precent_completed+c.processed/a.scan_precent),void 0!==a.progressbar&&(a.progressbar.progressbar("option","value",Math.floor(a.precent_completed)),a.progressbar_text.text(spbcScaner["progressbar_"+a.status]+" - "+Math.floor(a.precent_completed)+"%")),void 0!==a.callback&&setTimeout(function(){a.callback(c,n)},1e3))}catch(n){spbcModal.open().putError("Unexpected error: "+c),setTimeout(function(){e.end()},1e3)}},error:function(n,c,a){e.end(),console.log("SPBC_AJAX_ERROR"),console.log(n),console.log(c),console.log(a),a&&spbcModal.open().putError(a)},timeout:a.timeout})},control:function(n,c,a,t){if(this.data("callback",e.control).data("precent_completed",100),void 0!==a&&a){if(null==t.status)return e.start(),void e.getHashes();if(1!=t.paused)return void e.pause(n,c);e.resume(),n=t.result,c=t.data}1!=t.paused&&setTimeout(function(){switch(t.status){case"get_hashes":e.countPlug();break;case"count_hashes_plug":e.getHashesPlug();break;case"get_hashes_plug":e.clearTable();break;case"clear_table":e.count();break;case"count":e.scan();break;case"scan":e.getHashesApproved();break;case"get_hashes_approved":if(+spbcScaner.check_signature)return void e.countModified_sign("UNKNOWN,MODIFIED,OK,INFECTED","NO,YES_HEURISTIC");if(+spbcScaner.check_heuristic)return void e.countModified_heur("UNKNOWN,MODIFIED,OK,INFECTED","NO,YES_SIGNATURE");if(+spbcScaner.auto_cure)return void e.cureBackup();if(+spbcScaner.check_links)return void e.countLinks();if(+spbcScaner.check_frontend)return void e.countFrontend();if(+spbcScaner.check_listing)return void e.checkListing();e.sendResults();break;case"count_modified_sign":n.total,t.warnings.long_scan.show(500),e.log__raw('<h3 class="spbc_log-block_header">Signature Analysis</h3>'),e.scanModified_sign("UNKNOWN,MODIFIED,OK,INFECTED");break;case"scan_modified_sign":if(+spbcScaner.check_heuristic)return void e.countModified_heur("UNKNOWN,MODIFIED,OK,INFECTED","NO,YES_SIGNATURE");if(+spbcScaner.auto_cure)return void e.cureBackup();if(+spbcScaner.check_links)return void e.countLinks();if(+spbcScaner.check_frontend)return void e.countFrontend();if(+spbcScaner.check_listing)return void e.checkListing();e.sendResults();break;case"count_modified_heur":30<n.total&&t.warnings.long_scan.show(500),e.log__raw('<h3 class="spbc_log-block_header">Heuristic Analysis</h3>'),e.scanModified_heur("UNKNOWN,MODIFIED,OK,INFECTED");break;case"scan_modified_heur":if(+spbcScaner.auto_cure)return void e.cureBackup();if(+spbcScaner.check_links)return void e.countLinks();if(+spbcScaner.check_frontend)return void e.countFrontend();if(+spbcScaner.check_listing)return void e.checkListing();e.sendResults();break;case"cure_backup":e.countCure();break;case"count_cure":e.cure();break;case"cure":if(+spbcScaner.check_links)return void e.countLinks();if(+spbcScaner.check_frontend)return void e.countFrontend();if(+spbcScaner.check_listing)return void e.checkListing();e.sendResults();break;case"count_links":e.scanLinks();break;case"scan_links":if(+spbcScaner.check_frontend)return void e.countFrontend();if(+spbcScaner.check_listing)return void e.checkListing();e.sendResults();break;case"frontend_count":e.scanFrontend();break;case"frontend_scan":if(+spbcScaner.check_listing)return void e.checkListing();e.sendResults();break;case"check_listing":e.sendResults();break;case"send_results":e.end(),t.button.data("status",null)}},300)},getHashes:function(n){console.log("GET_HASHES"),this.data("status","get_hashes"),e.ajax({action:"spbc_scanner_get_remote_hashes"})},countPlug:function(n){console.log("COUNT_PLUG"),this.data("status","count_hashes_plug").data("callback",e.countPlug_callback),e.ajax({action:"spbc_scanner_count_plug"})},countPlug_callback:function(n,c,a){console.log("PLUG_COUNTED"),this.data("scan_precent",+n.total/98),e.control()},getHashesPlug:function(n){console.log("GETTING_HASHES"),this.data("status","get_hashes_plug").data("precent_completed",0).data("callback",e.getHashesPlug_callback),e.ajax({action:"spbc_scanner_get_remote_hashes_plug",amount:2}),console.log("HASHES_RECEIVED")},getHashesPlug_callback:function(n,c,a){console.log("GETTING_HASHES_PLUG"),n.outdated&&a.warnings.outdated.show(500),n.processed>=c.amount?e.ajax(c):(console.log("HASHES_PLUG_RECEIVED"),a.progressbar.progressbar("option","value",100),a.progressbar_text.text(spbcScaner["progressbar_"+a.status]+" - 100%"),e.control())},getHashesApproved:function(n){console.log("GET_HASHES"),this.data("status","get_hashes_approved"),e.ajax({action:"spbc_scanner_get_remote_hashes_approved"})},getHashesApproved_callback:function(n,c,a){console.log("HASHES_APPROVED_RECEIVED"),this.data("scan_precent",+n.total/98),e.control()},clearTable:function(){console.log("CLEAR_TABLE"),this.data("status","clear_table"),e.ajax({action:"spbc_scanner_clear_table"})},count:function(n){console.log("COUNT_FILES"),this.data("status","count").data("callback",e.count_callback),e.ajax({action:"spbc_scanner_count_files"})},count_callback:function(n,c,a){console.log("FILES COUNTED"),this.data("total_scanned",this.data("total_scanned")+ +n.total).data("scan_precent",+n.total/98),e.control()},scan:function(n){console.log("SCAN FILES"),data={action:"spbc_scanner_scan",offset:0,amount:700},this.data("status","scan").data("precent_completed",0).data("callback",e.scan_callback),e.ajax(data)},scan_callback:function(n,c,a){if(console.log("SCANNING FILES"),n.processed>=c.amount)return c.offset+=c.amount,void e.ajax(c);console.log("SCAN COMPLETED"),a.progressbar.progressbar("option","value",100),a.progressbar_text.text(spbcScaner["progressbar_"+a.status]+" - 100%"),e.control()},countModified_heur:function(n,c,a){console.log("COUNT MODIFIED FILES"),this.data("status","count_modified_heur").data("callback",e.countModified_callback),data={action:"spbc_scanner_count_files__by_status",status:n,checked:c},e.ajax(data)},countModified_sign:function(n,c,a){console.log("COUNT MODIFIED FILES"),this.data("status","count_modified_sign").data("callback",e.countModified_callback),data={action:"spbc_scanner_count_files__by_status",status:n,checked:c},e.ajax(data)},countModified_callback:function(n,c,a){console.log("MODIFIED FILES COUNTED"),this.data("scan_precent",+n.total/98),e.control(n,c)},scanModified_sign:function(n,c){console.log("SCAN MODIFIED FILES"),this.data("status","scan_modified_sign").data("precent_completed",0).data("callback",e.scanModified_callback).data("timeout",6e4),data={action:"spbc_scanner_scan_signatures",amount:20,status:n},e.ajax(data)},scanModified_heur:function(n,c){console.log("SCAN MODIFIED FILES"),this.data("status","scan_modified_heur").data("precent_completed",0).data("callback",e.scanModified_callback).data("timeout",6e4),data={action:"spbc_scanner_scan_heuristic",amount:5,status:n},e.ajax(data)},scanModified_callback:function(n,c,a){console.log("MODIFIED FILES SCANNING"),n.processed>=c.amount?e.ajax(c):(console.log("MODIFIED FILES END"),a.progressbar.progressbar("option","value",100),a.progressbar_text.text(spbcScaner["progressbar_"+a.status]+" - 100%"),e.control())},cureBackup:function(n){console.log("CURE BACKUP"),this.data("status","cure_backup").data("callback",e.cureBackup_callback),data={action:"spbc_scanner_backup_sigantures"},e.ajax(data)},cureBackup_callback:function(n,c,a){console.log("CURE BACKUPED"),this.data("scan_precent",+n.total/98),e.control()},countCure:function(n){console.log("COUNT LINKS"),this.data("status","count_cure").data("callback",e.countCure_callback),data={action:"spbc_scanner_count_cure"},e.ajax(data)},countCure_callback:function(n,c,a){console.log("CURE COUNTED"),this.data("scan_precent",+n.total/98),e.control()},cure:function(n){console.log("CURE"),this.data("status","cure").data("precent_completed",0).data("callback",e.cure_callback).data("timeout",3e4),data={action:"spbc_scanner_cure",amount:1},e.ajax(data)},cure_callback:function(n,c,a){console.log("FILES CURED"),a.progressbar.progressbar("option","value",100),a.progressbar_text.text(spbcScaner["progressbar_"+a.status]+" - 100%"),e.control()},countLinks:function(n){console.log("COUNT LINKS"),this.data("status","count_links").data("callback",e.countLinks_callback),data={action:"spbc_scanner_count_links"},e.ajax(data)},countLinks_callback:function(n,c,a){console.log("LINKS COUNTED"),this.data("scan_precent",+n.total/98),e.control()},scanLinks:function(n){console.log("SCAN LINKS"),this.data("status","scan_links").data("precent_completed",0).data("callback",e.scanLinks_callback).data("timeout",3e4);e.ajax({action:"spbc_scanner_scan_links",amount:10})},scanLinks_callback:function(n,c,a){if(console.log("LINKS SCANNING"),+n.processed)return this.data("total_links",+a.total+ +n.found),void e.ajax(c);console.log("LINKS SCANNED"),a.progressbar.progressbar("option","value",100),a.progressbar_text.text(spbcScaner["progressbar_"+a.status]+" - 100%"),e.control()},countFrontend:function(n){console.log("COUNT FRONTEND"),this.data("status","frontend_count").data("callback",e.countFrontend_callback);e.ajax({action:"spbc_scanner_frontend__count"})},countFrontend_callback:function(n,c,a){console.log("FRONTEND COUNTED"),this.data("scan_precent",+n.total/98),e.control()},scanFrontend:function(n){console.log("SCAN FRONTEND"),this.data("status","frontend_scan").data("precent_completed",0).data("callback",e.scanFrontend_callback).data("timeout",3e4);e.ajax({action:"spbc_scanner_frontend__scan",amount:1})},scanFrontend_callback:function(n,c,a){if(console.log("FRONTEND SCANNING"),+n.processed)return this.data("total_links",+a.total+ +n.found),void e.ajax(c);console.log("FRONTEND SCANNED"),a.progressbar.progressbar("option","value",100),a.progressbar_text.text(spbcScaner["progressbar_"+a.status]+" - 100%"),e.control()},checkListing:function(n){console.log("CHECK LISTING"),this.data("status","check_listing").data("precent_completed",0);e.ajax({action:"spbc_scanner_check_listing"})},sendResults:function(){console.log("SEND RESULTS"),this.data("status","send_results").data("callback",e.sendResults_callback);var n={action:"spbc_scanner_send_results",total_scanned:this.data("total_scanned")};+spbcScaner.check_links&&(n.total_links=this.data("total_links")?this.data("total_links"):"0"),e.ajax(n)},sendResults_callback:function(n,c,a){console.log("RESULTS_SENT"),a.button.parent().prev().children(".spbc_hint__last_scan_title").html(spbcScaner.look_below_for_scan_res),a.button.parent().nextAll(".spbc_hint_warning").hide(),+spbcScaner.check_links?a.button.parent().next().html(spbcScaner.last_scan_was_just_now_links.printf(c.total_scanned,c.total_links)):a.button.parent().next().html(spbcScaner.last_scan_was_just_now.printf(c.total_scanned)),jQuery("#spbc_scanner_status_icon").attr("src",spbcSettings.img_path+"/yes.png"),e.control()}};if("function"==typeof c[n]){var a=Array.prototype.slice.call(arguments,1);return"data"!==n&&a.push(this.data()),c[n].apply(this,a)}if("object"==typeof n){a=t.extend({status:null,paused_status:null,paused:!1,total_links:0,total_scanned:0,button:null,spinner:null,progress_overall:null,progressbar:null,progressbar_text:null,callback:null,timeout:12e4},n);return c.init.apply(this,[a])}t.error('Method "'+n+'" is unset for jQuery.spbcScannerPlugin')}}(jQuery);
//# sourceMappingURL=spbc-scanner-plugin.min.js.map
