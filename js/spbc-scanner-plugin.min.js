!function(e){e.spbc={scanner:{control:function(n,a,c){return spbcObj.spbcScannerPlugin("control",n,a,c)},data:function(n,a){return spbcObj.spbcScannerPlugin("data",n,a)},ajax:function(n){return spbcObj.spbcScannerPlugin("ajax",n)},start:function(){return spbcObj.spbcScannerPlugin("start")},end:function(){return spbcObj.spbcScannerPlugin("end")},pause:function(n,a){return spbcObj.spbcScannerPlugin("pause",n,a)},resume:function(){return spbcObj.spbcScannerPlugin("resume")},clear:function(){return spbcObj.spbcScannerPlugin("clear")},clear_callback:function(){return spbcObj.spbcScannerPlugin("clear_callback")},log__raw:function(n){return spbcObj.spbcScannerPlugin("log__raw",n)},log__file:function(n){return spbcObj.spbcScannerPlugin("log__file",n)},getHashes:function(){return spbcObj.spbcScannerPlugin("getHashes")},countPlug:function(){return spbcObj.spbcScannerPlugin("countPlug")},getHashesPlug:function(){return spbcObj.spbcScannerPlugin("getHashesPlug")},getHashesApproved:function(){return spbcObj.spbcScannerPlugin("getHashesApproved")},clearTable:function(){return spbcObj.spbcScannerPlugin("clearTable")},count:function(){return spbcObj.spbcScannerPlugin("count")},scan:function(){return spbcObj.spbcScannerPlugin("scan")},countModified_sign:function(n,a){return spbcObj.spbcScannerPlugin("countModified_sign",n,a)},countModified_heur:function(n,a){return spbcObj.spbcScannerPlugin("countModified_heur",n,a)},scanModified_sign:function(n){return spbcObj.spbcScannerPlugin("scanModified_sign",n)},scanModified_heur:function(n){return spbcObj.spbcScannerPlugin("scanModified_heur",n)},cureBackup:function(){return spbcObj.spbcScannerPlugin("cureBackup")},countCure:function(){return spbcObj.spbcScannerPlugin("countCure")},cure:function(){return spbcObj.spbcScannerPlugin("cure")},countLinks:function(){return spbcObj.spbcScannerPlugin("countLinks")},scanLinks:function(){return spbcObj.spbcScannerPlugin("scanLinks")},sendResults:function(){return spbcObj.spbcScannerPlugin("sendResults")},countFrontend:function(){return spbcObj.spbcScannerPlugin("countFrontend")},scanFrontend:function(){return spbcObj.spbcScannerPlugin("scanFrontend")},getHashes_callback:function(n,a){return spbcObj.spbcScannerPlugin("getHashes_callback",n,a)},countPlug_callback:function(n,a){return spbcObj.spbcScannerPlugin("countPlug_callback",n,a)},getHashesPlug_callback:function(n,a){return spbcObj.spbcScannerPlugin("getHashesPlug_callback",n,a)},getHashesApproved_callback:function(n,a){return spbcObj.spbcScannerPlugin("getHashesApproved_callback",n,a)},count_callback:function(n,a){return spbcObj.spbcScannerPlugin("count_callback",n,a)},scan_callback:function(n,a){return spbcObj.spbcScannerPlugin("scan_callback",n,a)},countModified_callback:function(n,a){return spbcObj.spbcScannerPlugin("countModified_callback",n,a)},scanModified_callback:function(n,a){return spbcObj.spbcScannerPlugin("scanModified_callback",n,a)},cureBackup_callback:function(n,a){return spbcObj.spbcScannerPlugin("cureBackup_callback",n,a)},countCure_callback:function(n,a){return spbcObj.spbcScannerPlugin("countCure_callback",n,a)},cure_callback:function(n,a){return spbcObj.spbcScannerPlugin("cure_callback",n,a)},countLinks_callback:function(n,a){return spbcObj.spbcScannerPlugin("countLinks_callback",n,a)},scanLinks_callback:function(n,a){return spbcObj.spbcScannerPlugin("scanLinks_callback",n,a)},countFrontend_callback:function(n,a){return spbcObj.spbcScannerPlugin("countFrontend_callback",n,a)},scanFrontend_callback:function(n,a){return spbcObj.spbcScannerPlugin("scanFrontend_callback",n,a)},sendResults_callback:function(n,a){return spbcObj.spbcScannerPlugin("sendResults_callback",n,a)}}},e.fn.spbcScannerPlugin=function(n){var s=jQuery.spbc.scanner,a={init:function(n){console.log("init"),this.data(n),window.spbcObj=this},start:function(n){n.progressbar.show(500).progressbar("option","value",0),n.progress_overall.show(500),n.button.html(spbcScaner.button_scan_pause),n.spinner.css({display:"inline"})},end:function(n){n.progressbar.hide(500).progressbar("option","value",100),n.progress_overall.hide(500),n.button.html(spbcScaner.button_scan_perform),n.spinner.css({display:"none"}),this.removeData("status"),this.data("total_links",0).data("plug",!1).data("total_scanned",0)},resume:function(n){console.log("RESUME"),n.button.html(spbcScaner.button_scan_pause),n.spinner.css({display:"inline"}),n.paused=!1},pause:function(n,a,c){console.log("PAUSE"),c.button.html(spbcScaner.button_scan_resume),c.spinner.css({display:"none"}),c.result=n,c.data=a,c.paused=!0},data:function(n,a){if(void 0===a)return"all"===n?this.data():this.data(n);this.data(n,a)},clear:function(){console.log("CLEAR"),s.start(),this.data("scan_status","clear").data("callback",s.clear_callback);s.ajax({action:"spbc_scanner_clear"})},clear_callback:function(){console.log("CLEARED"),s.end()},log__raw:function(n){jQuery(".spbc_log-wrapper").removeClass("spbc---hidden"),jQuery(".spbc_log-wrapper").append(n)},log__file:function(n){for(var a in n)s.log__raw('<p class="spbc_log-line">'+n[a].path+"<b>: "+n[a].status+"</b></p>")},ajax:function(n,c){var t=this.data("notJson")||!1;console.log(c.status),c.prev_action!=n.action&&void 0!==c.progressbar&&(c.progress_overall.children("span").removeClass("spbc_bold").filter(".spbc_overall_scan_status_"+c.status).addClass("spbc_bold"),c.progressbar.progressbar("option","value",0),c.progressbar_text.text(spbcScaner["progressbar_"+c.status]+" - 0%")),this.data("prev_action",n.action),n.security=spbcSettings.ajax_nonce,n.no_cache=Math.random(),jQuery.ajax({type:"GET",url:spbcSettings.ajaxurl,data:n,success:function(a){try{t||(a=JSON.parse(a)),a.error?(console.log(a),console.log(n),console.log(c),alert("Error happens: "+(a.error||"Unkown")),setTimeout(function(){s.end()},1e3)):(console.log(a),void 0!==a.processed_items&&a.processed_items&&s.log__file(a.processed_items),a.processed&&c.button.data("precent_completed",c.precent_completed+a.processed/c.scan_precent),void 0!==c.progressbar&&(c.progressbar.progressbar("option","value",Math.floor(c.precent_completed)),c.progressbar_text.text(spbcScaner["progressbar_"+c.status]+" - "+Math.floor(c.precent_completed)+"%")),void 0!==c.callback&&setTimeout(function(){c.callback(a,n)},1e3))}catch(n){alert("Unexpected error: "+a),setTimeout(function(){s.end()},1e3)}},error:function(n,a,c){s.end(),console.log("SPBC_AJAX_ERROR"),console.log(n),console.log(a),console.log(c),c&&alert(c)},timeout:c.timeout})},control:function(n,a,c,t){if(this.data("callback",s.control).data("precent_completed",100),void 0!==c&&c){if(null==t.status)return s.start(),void s.getHashes();if(1!=t.paused)return void s.pause(n,a);s.resume(),n=t.result,a=t.data}1!=t.paused&&setTimeout(function(){switch(t.status){case"get_hashes":s.countPlug();break;case"count_hashes_plug":s.getHashesPlug();break;case"get_hashes_plug":s.clearTable();break;case"clear_table":s.count();break;case"count":s.scan();break;case"scan":s.getHashesApproved();break;case"get_hashes_approved":if(+spbcScaner.check_signature)return void s.countModified_sign("UNKNOWN,MODIFIED,OK,INFECTED","NO,YES_HEURISTIC");if(+spbcScaner.check_heuristic)return void s.countModified_heur("UNKNOWN,MODIFIED,OK,INFECTED","NO,YES_SIGNATURE");if(+spbcScaner.auto_cure)return void s.cureBackup();if(+spbcScaner.check_links)return void s.countLinks();if(+spbcScaner.check_frontend)return void s.countFrontend();s.sendResults();break;case"count_modified_sign":n.total,t.warnings.long_scan.show(500),s.log__raw('<h3 class="spbc_log-block_header">Signature Analysis</h3>'),s.scanModified_sign("UNKNOWN,MODIFIED,OK,INFECTED");break;case"scan_modified_sign":if(+spbcScaner.check_heuristic)return void s.countModified_heur("UNKNOWN,MODIFIED,OK,INFECTED","NO,YES_SIGNATURE");if(+spbcScaner.auto_cure)return void s.cureBackup();if(+spbcScaner.check_links)return void s.countLinks();if(+spbcScaner.check_frontend)return void s.countFrontend();s.sendResults();break;case"count_modified_heur":30<n.total&&t.warnings.long_scan.show(500),s.log__raw('<h3 class="spbc_log-block_header">Heuristic Analysis</h3>'),s.scanModified_heur("UNKNOWN,MODIFIED,OK,INFECTED");break;case"scan_modified_heur":if(+spbcScaner.auto_cure)return void s.cureBackup();if(+spbcScaner.check_links)return void s.countLinks();if(+spbcScaner.check_frontend)return void s.countFrontend();s.sendResults();break;case"cure_backup":s.countCure();break;case"count_cure":s.cure();break;case"cure":if(+spbcScaner.check_links)return void s.countLinks();if(+spbcScaner.check_frontend)return void s.countFrontend();s.sendResults();break;case"count_links":s.scanLinks();break;case"scan_links":if(+spbcScaner.check_frontend)return void s.countFrontend();s.sendResults();break;case"frontend_count":s.scanFrontend();break;case"frontend_scan":s.sendResults();break;case"send_results":s.end(),t.button.data("status",null),location.href=location.origin+location.pathname+"?page=spbc&spbc_tab=scanner"}},300)},getHashes:function(n){console.log("GET_HASHES"),this.data("status","get_hashes"),s.ajax({action:"spbc_scanner_get_remote_hashes"})},countPlug:function(n){console.log("COUNT_PLUG"),this.data("status","count_hashes_plug").data("callback",s.countPlug_callback),s.ajax({action:"spbc_scanner_count_plug"})},countPlug_callback:function(n,a,c){console.log("PLUG_COUNTED"),this.data("scan_precent",+n.total/98),s.control()},getHashesPlug:function(n){console.log("GETTING_HASHES"),this.data("status","get_hashes_plug").data("precent_completed",0).data("callback",s.getHashesPlug_callback),s.ajax({action:"spbc_scanner_get_remote_hashes_plug",amount:2}),console.log("HASHES_RECEIVED")},getHashesPlug_callback:function(n,a,c){console.log("GETTING_HASHES_PLUG"),n.outdated&&c.warnings.outdated.show(500),n.processed>=a.amount?s.ajax(a):(console.log("HASHES_PLUG_RECEIVED"),c.progressbar.progressbar("option","value",100),c.progressbar_text.text(spbcScaner["progressbar_"+c.status]+" - 100%"),s.control())},getHashesApproved:function(n){console.log("GET_HASHES"),this.data("status","get_hashes_approved"),s.ajax({action:"spbc_scanner_get_remote_hashes_approved"})},getHashesApproved_callback:function(n,a,c){console.log("HASHES_APPROVED_RECEIVED"),this.data("scan_precent",+n.total/98),s.control()},clearTable:function(){console.log("CLEAR_TABLE"),this.data("status","clear_table"),s.ajax({action:"spbc_scanner_clear_table"})},count:function(n){console.log("COUNT_FILES"),this.data("status","count").data("callback",s.count_callback),s.ajax({action:"spbc_scanner_count_files"})},count_callback:function(n,a,c){console.log("FILES COUNTED"),this.data("total_scanned",this.data("total_scanned")+ +n.total).data("scan_precent",+n.total/98),s.control()},scan:function(n){console.log("SCAN FILES"),data={action:"spbc_scanner_scan",offset:0,amount:700},this.data("status","scan").data("precent_completed",0).data("callback",s.scan_callback),s.ajax(data)},scan_callback:function(n,a,c){if(console.log("SCANNING FILES"),n.processed>=a.amount)return a.offset+=a.amount,void s.ajax(a);console.log("SCAN COMPLETED"),c.progressbar.progressbar("option","value",100),c.progressbar_text.text(spbcScaner["progressbar_"+c.status]+" - 100%"),s.control()},countModified_heur:function(n,a,c){console.log("COUNT MODIFIED FILES"),this.data("status","count_modified_heur").data("callback",s.countModified_callback),data={action:"spbc_scanner_count_files__by_status",status:n,checked:a},s.ajax(data)},countModified_sign:function(n,a,c){console.log("COUNT MODIFIED FILES"),this.data("status","count_modified_sign").data("callback",s.countModified_callback),data={action:"spbc_scanner_count_files__by_status",status:n,checked:a},s.ajax(data)},countModified_callback:function(n,a,c){console.log("MODIFIED FILES COUNTED"),this.data("scan_precent",+n.total/98),s.control(n,a)},scanModified_sign:function(n,a){console.log("SCAN MODIFIED FILES"),this.data("status","scan_modified_sign").data("precent_completed",0).data("callback",s.scanModified_callback).data("timeout",6e4),data={action:"spbc_scanner_scan_signatures",amount:50,status:n},s.ajax(data)},scanModified_heur:function(n,a){console.log("SCAN MODIFIED FILES"),this.data("status","scan_modified_heur").data("precent_completed",0).data("callback",s.scanModified_callback).data("timeout",6e4),data={action:"spbc_scanner_scan_heuristic",amount:5,status:n},s.ajax(data)},scanModified_callback:function(n,a,c){console.log("MODIFIED FILES SCANNING"),n.processed>=a.amount?s.ajax(a):(console.log("MODIFIED FILES END"),c.progressbar.progressbar("option","value",100),c.progressbar_text.text(spbcScaner["progressbar_"+c.status]+" - 100%"),s.control())},cureBackup:function(n){console.log("CURE BACKUP"),this.data("status","cure_backup").data("callback",s.cureBackup_callback),data={action:"spbc_scanner_backup_sigantures"},s.ajax(data)},cureBackup_callback:function(n,a,c){console.log("CURE BACKUPED"),this.data("scan_precent",+n.total/98),s.control()},countCure:function(n){console.log("COUNT LINKS"),this.data("status","count_cure").data("callback",s.countCure_callback),data={action:"spbc_scanner_count_cure"},s.ajax(data)},countCure_callback:function(n,a,c){console.log("CURE COUNTED"),this.data("scan_precent",+n.total/98),s.control()},cure:function(n){console.log("CURE"),this.data("status","cure").data("precent_completed",0).data("callback",s.cure_callback).data("timeout",3e4),data={action:"spbc_scanner_cure",amount:1},s.ajax(data)},cure_callback:function(n,a,c){console.log("FILES CURED"),c.progressbar.progressbar("option","value",100),c.progressbar_text.text(spbcScaner["progressbar_"+c.status]+" - 100%"),s.control()},countLinks:function(n){console.log("COUNT LINKS"),this.data("status","count_links").data("callback",s.countLinks_callback),data={action:"spbc_scanner_count_links"},s.ajax(data)},countLinks_callback:function(n,a,c){console.log("LINKS COUNTED"),this.data("scan_precent",+n.total/98),s.control()},scanLinks:function(n){console.log("SCAN LINKS"),this.data("status","scan_links").data("precent_completed",0).data("callback",s.scanLinks_callback).data("timeout",3e4);s.ajax({action:"spbc_scanner_scan_links",amount:10})},scanLinks_callback:function(n,a,c){if(console.log("LINKS SCANNING"),+n.processed)return this.data("total_links",+c.total+ +n.found),void s.ajax(a);console.log("LINKS SCANNED"),c.progressbar.progressbar("option","value",100),c.progressbar_text.text(spbcScaner["progressbar_"+c.status]+" - 100%"),s.control()},countFrontend:function(n){console.log("COUNT FRONTEND"),this.data("status","frontend_count").data("callback",s.countFrontend_callback);s.ajax({action:"spbc_scanner_frontend__count"})},countFrontend_callback:function(n,a,c){console.log("FRONTEND COUNTED"),this.data("scan_precent",+n.total/98),s.control()},scanFrontend:function(n){console.log("SCAN FRONTEND"),this.data("status","frontend_scan").data("precent_completed",0).data("callback",s.scanFrontend_callback).data("timeout",3e4);s.ajax({action:"spbc_scanner_frontend__scan",amount:1})},scanFrontend_callback:function(n,a,c){if(console.log("FRONTEND SCANNING"),+n.processed)return this.data("total_links",+c.total+ +n.found),void s.ajax(a);console.log("FRONTEND SCANNED"),c.progressbar.progressbar("option","value",100),c.progressbar_text.text(spbcScaner["progressbar_"+c.status]+" - 100%"),s.control()},sendResults:function(){console.log("SEND RESULTS"),this.data("status","send_results").data("callback",s.sendResults_callback);var n={action:"spbc_scanner_send_results",total_scanned:this.data("total_scanned")};+spbcScaner.check_links&&(n.total_links=this.data("total_links")),s.ajax(n)},sendResults_callback:function(n,a,c){console.log("RESULTS_SENT"),+spbcScaner.check_links?c.button.parent().next().html(spbcScaner.last_scan_was_just_now_links.printf(a.total_scanned,a.total_links)):c.button.parent().next().html(spbcScaner.last_scan_was_just_now.printf(a.total_scanned)),jQuery("#spbc_scanner_status_icon").attr("src",spbcSettings.img_path+"/yes.png"),s.control()}};if("function"==typeof a[n]){var c=Array.prototype.slice.call(arguments,1);return"data"!==n&&c.push(this.data()),a[n].apply(this,c)}if("object"==typeof n){var t=e.extend({status:null,paused_status:null,paused:!1,total_links:0,total_scanned:0,button:null,spinner:null,progress_overall:null,progressbar:null,progressbar_text:null,callback:null,timeout:6e4},n);return a.init.apply(this,[t])}e.error('Method "'+n+'" is unset for jQuery.spbcScannerPlugin')}}(jQuery);
//# sourceMappingURL=spbc-scanner-plugin.min.js.map
