{"version":3,"file":"spbc-settings_tab--scanner.min.js","sources":["spbc-settings_tab--scanner.js"],"sourcesContent":["/**\n * Show popup tip\n *\n * @param {object} showIcon\n */\nfunction spbcPopupTipShow(showIcon) { // eslint-disable-line no-unused-vars\n    let tipTitle = showIcon.attr('spbc_tip_title') || null;\n    let tipText = showIcon.attr('spbc_tip_text') || null;\n    let removeDescFunc = function(e) {\n        if (\n            typeof e === 'undefined' ||\n            (\n                jQuery(e.target).parent('.spbc_popup_tip--wrapper').length == 0 ||\n                jQuery(e.target).hasClass('spbc_popup_tip--icon---cancel')\n            )\n        ) {\n            jQuery('.spbc_popup_tip--wrapper').hide();\n            jQuery(document).off('click', removeDescFunc);\n        }\n    };\n\n    removeDescFunc();\n\n    showIcon.after('<div class=\\'spbc_popup_tip--wrapper\\'></div>');\n\n    let obj = jQuery('.spbc_popup_tip--wrapper');\n\n    obj.empty()\n        .append('<div class=\\'spbc_popup_tip--angle\\'></div>')\n        .css({\n            top: showIcon.position().top - 2,\n            left: showIcon.position().left + 25,\n        });\n    obj.append('<i class=\\'spbc_popup_tip--icon---cancel icon-cancel\\'></i>')\n        .append('<h3 class=\\'spbc_popup_tip--title\\'>' + tipTitle + '</h3>')\n        .append('<p class=\\'spbc_popup_tip--text\\'>' + tipText + '</p>');\n\n    jQuery(document).on('click', removeDescFunc);\n    showIcon.parents('tr').on('mouseout', removeDescFunc);\n}\n\n/**\n * View file in the scanner\n *\n * @param {object} obj\n */\nfunction spbcScannerButtonFileViewEvent(obj) { // eslint-disable-line no-unused-vars\n    let self = jQuery(obj);\n    let data = {\n        action: 'spbc_scanner_file_view',\n        file_id: self.parents('.row-actions').attr('uid'),\n    };\n    let params = {\n        spinner: self.parent().siblings('.tbl-preloader--tiny'),\n        callback: spbcScannerButtonViewCallback,\n        errorOutput: function(msg) {\n            spbcModal.open().putError( msg );\n        },\n    };\n    spbcSendAJAXRequest(data, params);\n}\n\n/**\n * Delete file from analysis log\n *\n * @param {object} obj\n */\nfunction spbcScannerAnalysisLogDeleteFromLog(obj) { // eslint-disable-line no-unused-vars\n    let fileIds = [];\n    const self = jQuery(obj);\n    let spinner;\n\n    if ( jQuery(obj).hasClass('tbl-row_action') ) {\n        fileIds.push(self.parents('.row-actions').attr('uid'));\n        spinner = self.parent().siblings('.tbl-preloader--tiny');\n    } else {\n        const selectedItems = self.closest('#spbc_tbl__scanner_analysis_log').find('.cb-select:checked');\n        if (selectedItems.length === 0) {\n            alert('Please, select elements.');\n            return;\n        }\n\n        selectedItems.each(function(index, element) {\n            const elementId = jQuery(element).val();\n            fileIds.push(elementId);\n        });\n        spinner = self.children('.tbl-preloader--small');\n    }\n\n    const data = {\n        action: 'spbc_scanner_analysis_log_delete_from_log',\n        file_ids: fileIds,\n    };\n\n    let params = {\n        spinner: spinner,\n        callback: function() {\n            window.location.reload();\n        },\n    };\n\n    spbcSendAJAXRequest(data, params);\n}\n\n/**\n * View page in the scanner\n *\n * @param {object} obj\n */\nfunction spbcScannerButtonPageViewEvent(obj) { // eslint-disable-line no-unused-vars\n    let self = jQuery(obj);\n    let data = {\n        action: 'spbc_scanner_page_view',\n        page_url: self.parents('.row-actions').attr('uid'),\n    };\n    let params = {\n        spinner: self.parent().siblings('.tbl-preloader--tiny'),\n        callback: spbcScannerButtonViewCallback,\n        errorOutput: function(msg) {\n            spbcModal.open().putError( msg );\n        },\n    };\n\n    let wpWrap = jQuery('#wpwrap');\n    let dialogWindow = jQuery('#spbc_dialog');\n\n    dialogWindow.dialog({\n        modal: true,\n        title: 'Loading..',\n        position: {my: 'center top', at: 'center top+100px', of: window},\n        width: +(wpWrap.width() / 100 * 90),\n        show: {effect: 'blind', duration: 500},\n        draggable: false,\n        resizable: false,\n        closeText: 'X',\n        classes: {'ui-dialog': 'spbc---top'},\n        open: function(event, ui) {\n            event.target.style.overflow = 'auto';\n            jQuery('#spbc_dialog').height((document.documentElement.clientHeight) / 100 * 25);\n        },\n        beforeClose: function(event, ui) {\n            document.body.style.overflow = 'auto';\n            jQuery('#spbc_dialog').empty();\n        },\n    });\n\n    dialogWindow.append('<img id=\"spbc_file_view_preloader\" alt=\"Wait for downloading\" ' +\n        'class=\"spbc_preloader\" ' +\n        'src=\"../../wp-content/plugins/security-malware-firewall/images/preloader2.gif\" ' +\n        'style=\"' +\n        'display: block; ' +\n        'position: absolute; ' +\n        '\">');\n\n    let spinner = jQuery('#spbc_file_view_preloader');\n    let sizeMultiplier = (wpWrap.width() * 0.0004);\n\n    spinner.height(128 * sizeMultiplier);\n    spinner.width(128 * sizeMultiplier);\n    spinner.css({left: dialogWindow.width()/2 - (128 * sizeMultiplier / 2)});\n    spinner.css({top: dialogWindow.height()/2 - (128 * sizeMultiplier / 2)});\n\n    spbcSendAJAXRequest(data, params);\n}\n\n/**\n * Callback for file view\n *\n * @param {object} result\n */\nfunction spbcScannerButtonViewCallback(result) { // eslint-disable-line no-unused-vars\n    let dialogWindow = jQuery('#spbc_dialog');\n    dialogWindow.empty();\n\n    jQuery('#spbc_file_view_preloader').css({display: 'none'});\n\n    let rowTemplate = '<div class=\"spbc_view_file_row_wrapper\"><span class=\"spbc_view_file_row_num\">%s</span>';\n    rowTemplate += '<p class=\"spbc_view_file_row\">%s</p><br /></div>';\n\n    /* eslint-disable guard-for-in */\n    for (let row in result.file) {\n        dialogWindow.append(rowTemplate.printf(row, result.file[row]));\n    }\n\n    let contentHeight = Object.keys(result.file).length * 19 < 76 ? 76 : Object.keys(result.file).length * 19;\n    let visibleHeight = (document.documentElement.clientHeight) / 100 * 75;\n    let overflow = contentHeight < visibleHeight ? 'hidden' : 'scroll';\n    let height = overflow === 'scroll' ? visibleHeight : contentHeight;\n\n    dialogWindow.css({\n        height: height,\n        overflow: overflow,\n    });\n\n    dialogWindow.dialog({\n        modal: true,\n        title: ('Loaded: ' + result.file_path),\n        position: {my: 'center top', at: 'center top+100px', of: window},\n        width: +(jQuery('#wpwrap').width() / 100 * 90),\n        show: {effect: 'blind', duration: 500},\n        draggable: true,\n        resizable: false,\n        height: height,\n        closeText: 'X',\n        classes: {'ui-dialog': 'spbc---top'},\n        open: function(event, ui) {\n            event.target.style.overflow = overflow;\n            jQuery('#spbc_dialog').height(height);\n            jQuery('.ui-widget-overlay').on('click', function() {\n                jQuery('#spbc_dialog').dialog('close');\n            });\n        },\n        beforeClose: function(event, ui) {\n            document.body.style.overflow = 'auto';\n            jQuery('#spbc_dialog').empty();\n        },\n    });\n\n    console.log('FILE_VIEWED');\n}\n\n/**\n * Event for file view bad\n *\n * @param {object} obj\n */\nfunction spbcScannerButtonFileViewBadEvent(obj) { // eslint-disable-line no-unused-vars\n    let self = jQuery(obj);\n    let data = {\n        action: 'spbc_scanner_file_view',\n        file_id: self.parents('.row-actions').attr('uid'),\n    };\n    let params = {\n        spinner: self.parent().siblings('.tbl-preloader--tiny'),\n        callback: spbcScannerButtonViewBadFileCallback,\n        errorOutput: function(msg) {\n            spbcModal.open().putError( msg );\n        },\n    };\n    spbcSendAJAXRequest(data, params);\n}\n\n/**\n * Event for page view bad\n *\n * @param {object} obj\n */\nfunction spbcScannerButtonPageViewBadEvent(obj) { // eslint-disable-line no-unused-vars\n    let self = jQuery(obj);\n    let data = {\n        action: 'spbc_scanner_page_view',\n        page_url: self.parent().attr('uid'),\n    };\n    let params = {\n        spinner: self.parent().siblings('.tbl-preloader--tiny'),\n        callback: spbcScannerButtonViewBadCallback,\n        errorOutput: function(msg) {\n            spbcModal.open().putError( msg );\n        },\n    };\n    spbcSendAJAXRequest(data, params);\n}\n\n/**\n * Callback for file view bad\n *\n * @param {object} result\n * @param {object} data\n * @param {object} params\n */\nfunction spbcScannerButtonViewBadFileCallback(result, data, params) { // eslint-disable-line no-unused-vars\n    console.log('FILE_VIEWED_BAD_CODE_FILE');\n    jQuery('#spbc_dialog').empty();\n\n    let rowTemplate = '<div class=\"spbc_view_file_row_wrapper\"><span class=\"spbc_view_file_row_num\">%s</span>';\n    rowTemplate += '<p class=\"spbc_view_file_row\">%s</p><br /></div>';\n    let rowTemplateBad = '<div class=\"spbc_view_file_row_wrapper\" style=\"background: rgba(200,40,40,0.8);\">';\n    rowTemplateBad += '<span class=\"spbc_view_file_row_num\">%s</span>';\n    rowTemplateBad += '<p class=\"spbc_view_file_row\">%s</p><br /></div>';\n    let severityParts = [];\n    let severityPartsSorted = [];\n    let severityKeysSorted = [];\n\n    result.weak_spots = JSON.parse(result.weak_spots);\n    /* eslint-disable guard-for-in */\n    for (let severity in result.weak_spots) {\n        severityParts[severity] = Object.keys(result.weak_spots[severity]);\n    }\n\n    severityKeysSorted = Object.keys(severityParts).sort();\n\n    /* eslint-disable guard-for-in */\n    for (key in severityKeysSorted) {\n        severityPartsSorted[severityKeysSorted[key]] = severityParts[severityKeysSorted[key]];\n    }\n\n    /* eslint-disable guard-for-in */\n    for (let severityPart in severityPartsSorted) {\n        let headerName = 'spbc-dialog-row-header-' + severityPart.toLowerCase();\n        let headerHtml = '<span id=\"' + headerName + '\" style=\"text-align: center\"><b>';\n        headerHtml += severityPart + ' weakspots:</b></span>';\n        const dialog = jQuery('#spbc_dialog');\n\n        dialog.append(rowTemplate.printf('', headerHtml));\n        dialog.append(rowTemplate. printf('<b>...</b>', '<b>...</b>'));\n\n        let header = dialog.find('#' + headerName);\n        header.parent().parent().css('text-align', 'center');\n        header.parent().parent().css('border', '1px dotted');\n        header.parent().parent().css('background', 'darkgrey');\n\n        /* eslint-disable guard-for-in */\n        for (let strNum in severityParts[severityPart]) {\n            // Sort bad line\n            strNum = [...new Set(strNum)].sort();\n\n            let row = +severityParts[severityPart][strNum];\n            let displayDepth = 2;\n            let temp;\n            // Display only existing lines of file\n            for (let currRow = row - displayDepth; currRow <= row + displayDepth; currRow++ ) {\n                if ( typeof result.file[currRow] !== 'undefined' ) {\n                    temp = row === currRow ? rowTemplateBad : rowTemplate;\n                    dialog.append(temp.printf(currRow, result.file[currRow]));\n                }\n            }\n\n            // Placing an empty string between results\n            dialog.append(rowTemplate. printf('<b>...</b>', '<b>...</b>'));\n        }\n    }\n\n    // Removing last empty string\n    jQuery('#spbc_dialog div').last().remove();\n\n    let contentHeight = jQuery('#spbc_dialog div').length * 19 < 76 ? 76 : jQuery('#spbc_dialog div').length * 19;\n    let visibleHeight = (document.documentElement.clientHeight) / 100 * 75;\n    let overflow = contentHeight < visibleHeight ? 'no_scroll' : 'scroll';\n    let height = overflow === 'scroll' ? visibleHeight : contentHeight;\n\n    jQuery('#spbc_dialog').dialog({\n        modal: true,\n        title: result.file_path,\n        position: {my: 'center top', at: 'center top+100px', of: window},\n        width: +(jQuery('#wpwrap').width() / 100 * 90),\n        show: {effect: 'blind', duration: 500},\n        draggable: true,\n        resizable: false,\n        closeText: 'X',\n        classes: {'ui-dialog': 'spbc---top'},\n        open: function(event, ui) {\n            event.target.style.overflow = overflow;\n            jQuery('#spbc_dialog').height(height);\n            jQuery('.ui-widget-overlay').on('click', function() {\n                jQuery('#spbc_dialog').dialog('close');\n            });\n        },\n        beforeClose: function(event, ui) {\n            document.body.style.overflow = 'auto';\n            jQuery('#spbc_dialog').empty();\n        },\n    });\n}\n\n/**\n * Callback for file view bad\n *\n * @param {object} result\n * @param {object} data\n * @param {object} params\n */\nfunction spbcScannerButtonViewBadCallback(result, data, params) { // eslint-disable-line no-unused-vars\n    console.log('FILE_VIEWED_BAD_CODE');\n\n    let afterClose = () => {};\n\n    if ( result.success == true ) {\n        console.log(result);\n        let rowTemplate = '<div class=\"spbc_view_file_row_wrapper\">' +\n            '<span class=\"spbc_view_file_row_num\">%s</span>' +\n            '<p class=\"spbc_view_file_row\" style=\"word-break: break-all\">%s</p>' +\n            '<br /></div>';\n        let rowTemplateBad = '<div class=\"spbc_view_file_row_wrapper\" style=\"background: rgb(200,120,120);\">' +\n            '<span class=\"spbc_view_file_row_num\">%s</span>' +\n            '<p class=\"spbc_view_file_row\" style=\"word-break: break-all\">%s</p>' +\n            '<br /></div>';\n        let strNums = [];\n\n        result.weak_spots = JSON.parse(result.weak_spots);\n        /* eslint-disable guard-for-in */\n        for (let severity in result.weak_spots) {\n            strNums = strNums.concat(Object.keys(result.weak_spots[severity]));\n        }\n\n        strNums = [...new Set(strNums)].sort(); // Sort bad line\n        // get a map of bad strings\n        // TODO: Probably there can get something else except CRITICAL in the future\n        let badStringsMap = new Map(Object.entries(result.weak_spots.CRITICAL));\n        /* eslint-disable guard-for-in */\n        for (let strNum in strNums) {\n            if (strNum == 0 && badStringsMap.get(strNums[strNum]).toLowerCase().includes('doctype')) {\n                continue;\n            }\n\n            let row = +strNums[strNum];\n            let displayDepth = 2;\n\n            // Display only existing lines of file\n            for (let currRow = row - displayDepth; currRow <= row + displayDepth; currRow++ ) {\n                if ( typeof result.file[currRow] !== 'undefined' ) {\n                    let isBadString = (row === currRow);\n                    let unformattedRow;\n                    let highlitedRow;\n                    if (isBadString) {\n                        unformattedRow = rowTemplateBad;\n                    } else {\n                        unformattedRow = rowTemplate;\n                    }\n                    if (isBadString && !result.file[currRow].includes('iframe')) {\n                        highlitedRow = unformattedRow.printf(currRow, badStringsMap.get(strNums[strNum]));\n                    } else {\n                        highlitedRow = unformattedRow.printf(currRow, result.file[currRow]);\n                    }\n                    jQuery('#spbc_dialog').append(highlitedRow);\n                }\n            }\n\n            // Placing an empty string between results\n            jQuery('#spbc_dialog').append(rowTemplate. printf('', ''));\n\n            // Removing last empty string\n            jQuery('#spbc_dialog div').last().remove();\n        }\n    } else {\n        let wrapperElement = '<div style=\"margin:40px;text-align:center;\">%s</div>';\n        jQuery('#spbc_dialog').append(wrapperElement.printf(result.content));\n        afterClose = () => {\n            document.location.reload();\n        };\n    }\n\n    let contentHeight = jQuery('#spbc_dialog div').length * 19 < 76 ? 76 : jQuery('#spbc_dialog div').length * 19;\n    let visibleHeight = (document.documentElement.clientHeight) / 100 * 75;\n    let height = 'auto';\n    let overflow = contentHeight < visibleHeight ? 'no_scroll' : 'scroll';\n\n    jQuery('#spbc_dialog').dialog({\n        modal: true,\n        title: result.file_path,\n        position: {my: 'center top', at: 'center top+100px', of: window},\n        width: +(jQuery('#wpwrap').width() / 100 * 90),\n        show: {effect: 'blind', duration: 500},\n        draggable: true,\n        resizable: false,\n        closeText: 'X',\n        classes: {'ui-dialog': 'spbc---top'},\n        open: function(event, ui) {\n            event.target.style.overflow = overflow;\n            jQuery('#spbc_dialog').height(height);\n            jQuery('.ui-widget-overlay').on('click', function() {\n                jQuery('#spbc_dialog').dialog('close');\n            });\n        },\n        beforeClose: function(event, ui) {\n            document.body.style.overflow = 'auto';\n            jQuery('#spbc_dialog').empty();\n        },\n        close: afterClose,\n    });\n}\n\n/**\n * File compare event\n *\n * @param {object} obj\n */\nfunction spbcScannerButtonFileCompareEvent(obj) { // eslint-disable-line no-unused-vars\n    let self = jQuery(obj);\n    let data = {\n        action: 'spbc_scanner_file_compare',\n        file_id: self.parents('.row-actions').attr('uid'),\n    };\n    let params = {\n        spinner: self.parent().siblings('.tbl-preloader--tiny'),\n        callback: spbcScannerButtonFileCompareCallback,\n        errorOutput: function(msg) {\n            spbcModal.open().putError( msg );\n        },\n    };\n    spbcSendAJAXRequest(data, params);\n}\n\n/**\n * Callback for file compare\n *\n * @param {object} result\n * @param {object} data\n * @param {object} params\n */\nfunction spbcScannerButtonFileCompareCallback(result, data, params) { // eslint-disable-line no-unused-vars\n    console.log('FILE_COMPARED');\n\n    let rowTemplate = '<div class=\"spbc_compare_file_row_wrapper\">';\n    rowTemplate += '<p class=\"spbc_compare_file_row\">%s</p><span class=\"spbc_compare_file_row_num\">%s</span>';\n    rowTemplate += '<p class=\"spbc_compare_file_row\">%s</p><br /></div>';\n    let rowTemplateBad = '<div class=\"spbc_compare_file_row_wrapper\" style=\"background: rgba(200,40,40,0.8);\">';\n    rowTemplateBad += '<p class=\"spbc_compare_file_row\">%s</p><span class=\"spbc_compare_file_row_num\">%s</span>';\n    rowTemplateBad += '<p class=\"spbc_compare_file_row\">%s</p><br /></div>';\n\n    let renderRowTemplate = rowTemplate.printf(\n        '<span class=\"spbc_compare_file_headings\">Modified</span>',\n        'Line',\n        '<span class=\"spbc_compare_file_headings\">Original</span>',\n    );\n    jQuery('#spbc_dialog').append(renderRowTemplate);\n\n    for (let row=1; typeof result.file[row] != 'undefined' || typeof result.file_original[row] != 'undefined'; row++) {\n        if (typeof result.file[row] == 'undefined') result.file[row] = '';\n        if (typeof result.file_original[row] == 'undefined') result.file_original[row] = '';\n\n        // Display only existing lines of file\n        if (result.difference.indexOf(row) != -1) {\n            for (let displayDepth = 2, currRow = row - displayDepth; currRow <= row + displayDepth; currRow++ ) {\n                if ( typeof result.file[currRow] !== 'undefined' && typeof result.file_original[row] !== 'undefined') {\n                    jQuery('#spbc_dialog').append(\n                        (row === currRow ? rowTemplateBad : rowTemplate).printf(\n                            result.file[currRow] ? result.file[currRow] : '',\n                            currRow,\n                            result.file_original[currRow] ? result.file_original[currRow] : '',\n                        ),\n                    );\n                }\n            }\n            jQuery('#spbc_dialog').append(rowTemplate. printf('', '', ''));\n        }\n    }\n\n    let contentHeight = jQuery('#spbc_dialog div').length * 19 + 19;\n    let visibleHeight = (document.documentElement.clientHeight) / 100 * 75;\n    let overflow = contentHeight < visibleHeight ? 'no_scroll' : 'scroll';\n    let height = overflow === 'scroll' ? visibleHeight : contentHeight;\n\n    jQuery('#spbc_dialog').dialog({\n        modal: true,\n        title: result.file_path,\n        position: {my: 'center top', at: 'center top+100px', of: window},\n        width: +(jQuery('#wpwrap').width() / 100 * 90),\n        height: height,\n        show: {effect: 'blind', duration: 500},\n        draggable: true,\n        resizable: true,\n        closeText: 'X',\n        classes: {'ui-dialog': 'spbc---top'},\n        open: function(event, ui) {\n            document.body.style.overflow = 'hidden';\n            event.target.style.overflow = overflow;\n            jQuery('#spbc_dialog').height(height);\n        },\n        beforeClose: function(event, ui) {\n            document.body.style.overflow = 'auto';\n            jQuery('#spbc_dialog').empty();\n        },\n    });\n}\n\n/**\n * Reloads last scan info\n */\nfunction spbcScannerReloadScanInfo() { // eslint-disable-line no-unused-vars\n    jQuery('.spbc_hint__last_scan_title').text(spbcScaner.look_below_for_scan_res);\n    const data = {\n        action: 'spbc_scanner__last_scan_info',\n    };\n    const params = {\n        callback: (result) => {\n            document.getElementById('spbc_scanner__last_scan_info').innerText = result.data;\n        },\n    };\n    spbcSendAJAXRequest(data, params);\n}\n\n/**\n * Cure file\n * @param {object} obj\n */\nfunction spbcScannerButtonCureFileAjaxHandler(obj) { // eslint-disable-line no-unused-vars\n    const self = jQuery(obj);\n    const fileFastHash = self.parents('.row-actions').attr('uid');\n\n    let data = {\n        action: 'spbc_file_cure_ajax_action',\n        file_fast_hash: fileFastHash,\n        security: spbcSettings.ajax_nonce,\n    };\n\n    jQuery.ajax({\n        type: 'POST',\n        async: true,\n        url: spbcSettings.ajaxurl,\n        data: data,\n        success: function(result) {\n            if (result.success) {\n                spbcModal.open().put(result.data);\n                document.addEventListener('spbcModalClosed', function( e ) {\n                    document.location.reload();\n                });\n            } else {\n                spbcModal.open().putError(result.data);\n            }\n        },\n    });\n}\n\n/**\n * Restore file from backup\n * @param {object} obj\n */\nfunction spbcScannerButtonRestoreFromBackupAjaxHandler(obj) { // eslint-disable-line no-unused-vars\n    const self = jQuery(obj);\n    const fileFastHash = self.parents('.row-actions').attr('uid');\n\n    let data = {\n        action: 'spbc_restore_file_from_backup_ajax_action',\n        file_fast_hash: fileFastHash,\n        security: spbcSettings.ajax_nonce,\n    };\n\n    jQuery.ajax({\n        type: 'POST',\n        async: true,\n        url: spbcSettings.ajaxurl,\n        data: data,\n        success: function(result) {\n            if (result.success) {\n                spbcModal.open().put(result.data);\n                document.addEventListener('spbcModalClosed', function( e ) {\n                    document.location.reload();\n                });\n            } else {\n                spbcModal.open().putError(result.data);\n            }\n        },\n    });\n}\n\n/**\n * Clear scan results\n * @return {void}\n */\nfunction spbcScannerButtonClearScanResults() { // eslint-disable-line no-unused-vars\n    if ( ! confirm('Do you confirm to clear the scan results?') ) {\n        return;\n    }\n\n    console.log('CLEAR');\n\n    spbcSendAJAXRequest(\n        {action: 'spbc_scanner_clear'},\n        {\n            type: 'GET',\n            successCallback: function() {\n                document.location = document.location;\n            },\n            complete: null,\n            errorOutput: null,\n            context: this,\n            timeout: 40000,\n            success: function() {\n                document.location.reload();\n            },\n        },\n    );\n}\n\njQuery(document).ready(function() {\n    // EVENT HADLING\n    spbcTblBulkActionsListen(); // Table. Row bulk handler\n    spbcTblRowActionsListen(); // Table. Row actions handler\n    spbcTblPaginationListen(); // Table. Pagination handler\n    spbcTblSortListen(); // Table. Sort handler\n\n    spbcStartShowHide();\n\n    // Preparing progressbar\n    jQuery('#spbc_scaner_progress_bar').progressbar({\n        value: 0,\n        create: function( event, ui ) {\n            event.target.style.position = 'relative';\n            event.target.style.marginBottom = '12px';\n        },\n        change: function(event, ui) {\n            jQuery('.spbc_progressbar_counter span').text(jQuery(event.target).progressbar('option', 'value') + ' %');\n        },\n    });\n\n    // Preparing accordion\n    jQuery('#spbc_scan_accordion').accordion({\n        header: 'h3',\n        heightStyle: 'content',\n        collapsible: true,\n        active: false,\n        activate: function( event, ui ) {\n            if ( ui.oldPanel.length === 0 && ui.oldHeader.length === 0 ) {\n                jQuery('#spbc_scan_accordion')\n                    .accordion('option', 'classes.ui-accordion-content', 'ui-corner-bottom spbc-overflow--visible');\n            }\n        },\n        beforeActivate: function( event, ui ) {\n            if ( ui.oldPanel.length === 1 && ui.oldHeader.length === 1 ) {\n                jQuery('#spbc_scan_accordion').accordion('option', 'classes.ui-accordion-content', 'ui-corner-bottom');\n            }\n        },\n    });\n\n    // Init scanner plugin\n    window.spbcScanner = new SpbcMalwareScanner({\n        settings: spbcScaner.settings,\n        states: spbcScaner.states,\n        button: jQuery('#spbc_perform_scan'),\n        spinner: jQuery('#spbc_perform_scan').next(),\n        callback: null,\n        progress_overall: jQuery('#spbc_scaner_progress_overall'),\n        progressbar: jQuery('#spbc_scaner_progress_bar'),\n        progressbar_text: jQuery('.spbc_progressbar_counter span'),\n        wrapper: document.getElementsByClassName('spbc_unchecked_file_list'),\n        warnings: {\n            long_scan: jQuery('.spbc_hint_warning__long_scan'),\n            outdated: jQuery('.spbc_hint_warning__outdated'),\n        },\n    });\n\n    jQuery(document).on('click', '.spbc_popup_tip--icon---show', function() {\n        spbcPopupTipShow( jQuery( this ) );\n    });\n\n    jQuery('#spbc_perform_scan').on('click', function() {\n        jQuery('#spbcscan-results-log-module').remove();\n        spbcScanner.actionControl();\n\n        if (!jQuery('.spbc_log-wrapper .panel-body').length) {\n            jQuery('.spbc_log-wrapper').append('<div class=\"panel-body\"></div>');\n        }\n\n        jQuery('.spbc_log-wrapper').resizable({\n            handles: 'n, s',\n            containment: 'document',\n        });\n    });\n\n    jQuery('#spbcscan-results-log-module').resizable({\n        handles: 'n, s',\n        containment: 'document',\n    });\n\n    // Clear scanner's tables\n    jQuery('#spbc_scanner_clear').on('click', function() {\n        if ( ! confirm('Do you confirm to clear the scan results?') ) {\n            return;\n        }\n\n        console.log('CLEAR');\n\n        spbcSendAJAXRequest(\n            {action: 'spbc_scanner_clear'},\n            {\n                type: 'GET',\n                successCallback: function() {\n                    document.location = document.location;\n                },\n                complete: null,\n                errorOutput: null,\n                context: this,\n                timeout: 40000,\n                success: function() {\n                    document.location.reload();\n                },\n            },\n        );\n    });\n\n    jQuery('#spbc_scanner_save_to_pdf').on('click', function() {\n        jQuery.ajax({\n            url: spbcSettings.ajaxurl,\n            type: 'POST',\n            data: {\n                action: 'spbc_scanner_save_to_pdf',\n                security: spbcSettings.ajax_nonce,\n                no_cache: Math.random(),\n            },\n            xhrFields: {\n                responseType: 'blob',\n            },\n            success: function(data) {\n                jQuery.ajax({\n                    url: spbcSettings.ajaxurl,\n                    type: 'POST',\n                    data: {\n                        action: 'spbc_scanner_get_pdf_file_name',\n                        security: spbcSettings.ajax_nonce,\n                        no_cache: Math.random(),\n                    },\n                    xhrFields: {\n                        responseType: 'text',\n                    },\n                    success: function(filename) {\n                        let blob=new Blob([data]);\n                        let link=document.createElement('a');\n                        link.href=window.URL.createObjectURL(blob);\n                        link.download=filename.data;\n                        link.click();\n                    },\n                },\n                );\n            },\n        });\n    });\n});\n"],"names":["spbcPopupTipShow","showIcon","let","tipTitle","attr","tipText","removeDescFunc","e","jQuery","target","parent","length","hasClass","hide","document","off","after","obj","empty","append","css","top","position","left","on","parents","spbcScannerButtonFileViewEvent","self","data","action","file_id","params","spinner","siblings","callback","spbcScannerButtonViewCallback","errorOutput","msg","spbcModal","open","putError","spbcSendAJAXRequest","spbcScannerAnalysisLogDeleteFromLog","fileIds","push","selectedItems","closest","find","alert","each","index","element","elementId","val","children","file_ids","window","location","reload","spbcScannerButtonPageViewEvent","page_url","wpWrap","dialogWindow","dialog","modal","title","my","at","of","width","show","effect","duration","draggable","resizable","closeText","classes","ui-dialog","event","ui","style","overflow","height","documentElement","beforeClose","body","sizeMultiplier","result","row","rowTemplate","display","file","printf","contentHeight","Object","keys","visibleHeight","file_path","console","log","spbcScannerButtonFileViewBadEvent","spbcScannerButtonViewBadFileCallback","spbcScannerButtonPageViewBadEvent","spbcScannerButtonViewBadCallback","severityKeysSorted","severity","severityPart","rowTemplateBad","severityParts","severityPartsSorted","weak_spots","JSON","parse","key","sort","strNum","headerName","toLowerCase","headerHtml","header","Set","temp","currRow","last","remove","afterClose","success","strNums","concat","badStringsMap","Map","entries","CRITICAL","get","includes","isBadString","unformattedRow","highlitedRow","content","close","spbcScannerButtonFileCompareEvent","spbcScannerButtonFileCompareCallback","renderRowTemplate","file_original","difference","indexOf","spbcScannerReloadScanInfo","text","spbcScaner","look_below_for_scan_res","getElementById","innerText","spbcScannerButtonCureFileAjaxHandler","file_fast_hash","security","spbcSettings","ajax_nonce","ajax","type","async","url","ajaxurl","put","addEventListener","spbcScannerButtonRestoreFromBackupAjaxHandler","spbcScannerButtonClearScanResults","confirm","successCallback","complete","context","this","timeout","ready","spbcTblBulkActionsListen","spbcTblRowActionsListen","spbcTblPaginationListen","spbcTblSortListen","spbcStartShowHide","progressbar","value","create","marginBottom","change","accordion","heightStyle","collapsible","active","activate","oldPanel","oldHeader","beforeActivate","spbcScanner","SpbcMalwareScanner","settings","states","button","next","progress_overall","progressbar_text","wrapper","getElementsByClassName","warnings","long_scan","outdated","actionControl","handles","containment","no_cache","Math","random","xhrFields","responseType","filename","blob","Blob","link","createElement","href","URL","createObjectURL","download","click"],"mappings":"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"}