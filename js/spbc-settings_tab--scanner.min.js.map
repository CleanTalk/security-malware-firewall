{"version":3,"file":"spbc-settings_tab--scanner.min.js","sources":["spbc-settings_tab--scanner.js"],"sourcesContent":["/**\r\n * Show popup tip\r\n *\r\n * @param {object} showIcon\r\n */\r\nfunction spbcPopupTipShow(showIcon) { // eslint-disable-line no-unused-vars\r\n    let tipTitle = showIcon.attr('spbc_tip_title') || null;\r\n    let tipText = showIcon.attr('spbc_tip_text') || null;\r\n    let removeDescFunc = function(e) {\r\n        if (\r\n            typeof e === 'undefined' ||\r\n            (\r\n                jQuery(e.target).parent('.spbc_popup_tip--wrapper').length == 0 ||\r\n                jQuery(e.target).hasClass('spbc_popup_tip--icon---cancel')\r\n            )\r\n        ) {\r\n            jQuery('.spbc_popup_tip--wrapper').hide();\r\n            jQuery(document).off('click', removeDescFunc);\r\n        }\r\n    };\r\n\r\n    removeDescFunc();\r\n\r\n    showIcon.after('<div class=\\'spbc_popup_tip--wrapper\\'></div>');\r\n\r\n    let obj = jQuery('.spbc_popup_tip--wrapper');\r\n\r\n    obj.empty()\r\n        .append('<div class=\\'spbc_popup_tip--angle\\'></div>')\r\n        .css({\r\n            top: showIcon.position().top - 2,\r\n            left: showIcon.position().left + 25,\r\n        });\r\n    obj.append('<i class=\\'spbc_popup_tip--icon---cancel icon-cancel\\'></i>')\r\n        .append('<h3 class=\\'spbc_popup_tip--title\\'>' + tipTitle + '</h3>')\r\n        .append('<p class=\\'spbc_popup_tip--text\\'>' + tipText + '</p>');\r\n\r\n    jQuery(document).on('click', removeDescFunc);\r\n    showIcon.parents('tr').on('mouseout', removeDescFunc);\r\n}\r\n\r\n/**\r\n * View file in the scanner\r\n *\r\n * @param {object} obj\r\n */\r\nfunction spbcScannerButtonFileViewEvent(obj) { // eslint-disable-line no-unused-vars\r\n    let self = jQuery(obj);\r\n    let data = {\r\n        action: 'spbc_scanner_file_view',\r\n        file_id: self.parents('.row-actions').attr('uid'),\r\n    };\r\n    let params = {\r\n        spinner: self.parent().siblings('.tbl-preloader--tiny'),\r\n        callback: spbcScannerButtonViewCallback,\r\n        errorOutput: function(msg) {\r\n            spbcModal.open().putError( msg );\r\n        },\r\n    };\r\n    spbcSendAJAXRequest(data, params);\r\n}\r\n\r\n/**\r\n * Delete file from analysis log\r\n *\r\n * @param {object} obj\r\n */\r\nfunction spbcScannerAnalysisLogDeleteFromLog(obj) { // eslint-disable-line no-unused-vars\r\n    let fileIds = [];\r\n    const self = jQuery(obj);\r\n    let spinner;\r\n\r\n    if ( jQuery(obj).hasClass('tbl-row_action') ) {\r\n        fileIds.push(self.parents('.row-actions').attr('uid'));\r\n        spinner = self.parent().siblings('.tbl-preloader--tiny');\r\n    } else {\r\n        const selectedItems = self.closest('#spbc_tbl__scanner_analysis_log').find('.cb-select:checked');\r\n        if (selectedItems.length === 0) {\r\n            alert('Please, select elements.');\r\n            return;\r\n        }\r\n\r\n        selectedItems.each(function(index, element) {\r\n            const elementId = jQuery(element).val();\r\n            fileIds.push(elementId);\r\n        });\r\n        spinner = self.children('.tbl-preloader--small');\r\n    }\r\n\r\n    const data = {\r\n        action: 'spbc_scanner_analysis_log_delete_from_log',\r\n        file_ids: fileIds,\r\n    };\r\n\r\n    let params = {\r\n        spinner: spinner,\r\n        callback: function() {\r\n            window.location.reload();\r\n        },\r\n    };\r\n\r\n    spbcSendAJAXRequest(data, params);\r\n}\r\n\r\n/**\r\n * View page in the scanner\r\n *\r\n * @param {object} obj\r\n */\r\nfunction spbcScannerButtonPageViewEvent(obj) { // eslint-disable-line no-unused-vars\r\n    let self = jQuery(obj);\r\n    let data = {\r\n        action: 'spbc_scanner_page_view',\r\n        page_url: self.parents('.row-actions').attr('uid'),\r\n    };\r\n    let params = {\r\n        spinner: self.parent().siblings('.tbl-preloader--tiny'),\r\n        callback: spbcScannerButtonViewCallback,\r\n        errorOutput: function(msg) {\r\n            spbcModal.open().putError( msg );\r\n        },\r\n    };\r\n\r\n    let wpWrap = jQuery('#wpwrap');\r\n    let dialogWindow = jQuery('#spbc_dialog');\r\n\r\n    dialogWindow.dialog({\r\n        modal: true,\r\n        title: 'Loading..',\r\n        position: {my: 'center top', at: 'center top+100px', of: window},\r\n        width: +(wpWrap.width() / 100 * 90),\r\n        show: {effect: 'blind', duration: 500},\r\n        draggable: false,\r\n        resizable: false,\r\n        closeText: 'X',\r\n        classes: {'ui-dialog': 'spbc---top'},\r\n        open: function(event, ui) {\r\n            event.target.style.overflow = 'auto';\r\n            jQuery('#spbc_dialog').height((document.documentElement.clientHeight) / 100 * 25);\r\n        },\r\n        beforeClose: function(event, ui) {\r\n            document.body.style.overflow = 'auto';\r\n            jQuery('#spbc_dialog').empty();\r\n        },\r\n    });\r\n\r\n    dialogWindow.append('<img id=\"spbc_file_view_preloader\" alt=\"Wait for downloading\" ' +\r\n        'class=\"spbc_preloader\" ' +\r\n        'src=\"../../wp-content/plugins/security-malware-firewall/images/preloader2.gif\" ' +\r\n        'style=\"' +\r\n        'display: block; ' +\r\n        'position: absolute; ' +\r\n        '\">');\r\n\r\n    let spinner = jQuery('#spbc_file_view_preloader');\r\n    let sizeMultiplier = (wpWrap.width() * 0.0004);\r\n\r\n    spinner.height(128 * sizeMultiplier);\r\n    spinner.width(128 * sizeMultiplier);\r\n    spinner.css({left: dialogWindow.width()/2 - (128 * sizeMultiplier / 2)});\r\n    spinner.css({top: dialogWindow.height()/2 - (128 * sizeMultiplier / 2)});\r\n\r\n    spbcSendAJAXRequest(data, params);\r\n}\r\n\r\n/**\r\n * Callback for file view\r\n *\r\n * @param {object} result\r\n */\r\nfunction spbcScannerButtonViewCallback(result) { // eslint-disable-line no-unused-vars\r\n    let dialogWindow = jQuery('#spbc_dialog');\r\n    dialogWindow.empty();\r\n\r\n    jQuery('#spbc_file_view_preloader').css({display: 'none'});\r\n\r\n    let rowTemplate = '<div class=\"spbc_view_file_row_wrapper\"><span class=\"spbc_view_file_row_num\">%s</span>';\r\n    rowTemplate += '<p class=\"spbc_view_file_row\">%s</p><br /></div>';\r\n\r\n    /* eslint-disable guard-for-in */\r\n    for (let row in result.file) {\r\n        dialogWindow.append(rowTemplate.printf(row, result.file[row]));\r\n    }\r\n\r\n    let contentHeight = Object.keys(result.file).length * 19 < 76 ? 76 : Object.keys(result.file).length * 19;\r\n    let visibleHeight = (document.documentElement.clientHeight) / 100 * 75;\r\n    let overflow = contentHeight < visibleHeight ? 'hidden' : 'scroll';\r\n    let height = overflow === 'scroll' ? visibleHeight : contentHeight;\r\n\r\n    dialogWindow.css({\r\n        height: height,\r\n        overflow: overflow,\r\n    });\r\n\r\n    dialogWindow.dialog({\r\n        modal: true,\r\n        title: ('Loaded: ' + result.file_path),\r\n        position: {my: 'center top', at: 'center top+100px', of: window},\r\n        width: +(jQuery('#wpwrap').width() / 100 * 90),\r\n        show: {effect: 'blind', duration: 500},\r\n        draggable: true,\r\n        resizable: false,\r\n        height: height,\r\n        closeText: 'X',\r\n        classes: {'ui-dialog': 'spbc---top'},\r\n        open: function(event, ui) {\r\n            event.target.style.overflow = overflow;\r\n            jQuery('#spbc_dialog').height(height);\r\n            jQuery('.ui-widget-overlay').on('click', function() {\r\n                jQuery('#spbc_dialog').dialog('close');\r\n            });\r\n        },\r\n        beforeClose: function(event, ui) {\r\n            document.body.style.overflow = 'auto';\r\n            jQuery('#spbc_dialog').empty();\r\n        },\r\n    });\r\n\r\n    console.log('FILE_VIEWED');\r\n}\r\n\r\n/**\r\n * Event for file view bad\r\n *\r\n * @param {object} obj\r\n */\r\nfunction spbcScannerButtonFileViewBadEvent(obj) { // eslint-disable-line no-unused-vars\r\n    let self = jQuery(obj);\r\n    let data = {\r\n        action: 'spbc_scanner_file_view',\r\n        file_id: self.parents('.row-actions').attr('uid'),\r\n    };\r\n    let params = {\r\n        spinner: self.parent().siblings('.tbl-preloader--tiny'),\r\n        callback: spbcScannerButtonViewBadFileCallback,\r\n        errorOutput: function(msg) {\r\n            spbcModal.open().putError( msg );\r\n        },\r\n    };\r\n    spbcSendAJAXRequest(data, params);\r\n}\r\n\r\n/**\r\n * Event for page view bad\r\n *\r\n * @param {object} obj\r\n */\r\nfunction spbcScannerButtonPageViewBadEvent(obj) { // eslint-disable-line no-unused-vars\r\n    let self = jQuery(obj);\r\n    let data = {\r\n        action: 'spbc_scanner_page_view',\r\n        page_url: self.parent().attr('uid'),\r\n    };\r\n    let params = {\r\n        spinner: self.parent().siblings('.tbl-preloader--tiny'),\r\n        callback: spbcScannerButtonViewBadCallback,\r\n        errorOutput: function(msg) {\r\n            spbcModal.open().putError( msg );\r\n        },\r\n    };\r\n    spbcSendAJAXRequest(data, params);\r\n}\r\n\r\n/**\r\n * Callback for file view bad\r\n *\r\n * @param {object} result\r\n * @param {object} data\r\n * @param {object} params\r\n */\r\nfunction spbcScannerButtonViewBadFileCallback(result, data, params) { // eslint-disable-line no-unused-vars\r\n    console.log('FILE_VIEWED_BAD_CODE_FILE');\r\n    jQuery('#spbc_dialog').empty();\r\n\r\n    let rowTemplate = '<div class=\"spbc_view_file_row_wrapper\"><span class=\"spbc_view_file_row_num\">%s</span>';\r\n    rowTemplate += '<p class=\"spbc_view_file_row\">%s</p><br /></div>';\r\n    let rowTemplateBad = '<div class=\"spbc_view_file_row_wrapper\" style=\"background: rgba(200,40,40,0.8);\">';\r\n    rowTemplateBad += '<span class=\"spbc_view_file_row_num\">%s</span>';\r\n    rowTemplateBad += '<p class=\"spbc_view_file_row\">%s</p><br /></div>';\r\n    let severityParts = [];\r\n    let severityPartsSorted = [];\r\n    let severityKeysSorted = [];\r\n\r\n    result.weak_spots = JSON.parse(result.weak_spots);\r\n    /* eslint-disable guard-for-in */\r\n    for (let severity in result.weak_spots) {\r\n        severityParts[severity] = Object.keys(result.weak_spots[severity]);\r\n    }\r\n\r\n    severityKeysSorted = Object.keys(severityParts).sort();\r\n\r\n    /* eslint-disable guard-for-in */\r\n    for (key in severityKeysSorted) {\r\n        severityPartsSorted[severityKeysSorted[key]] = severityParts[severityKeysSorted[key]];\r\n    }\r\n\r\n    /* eslint-disable guard-for-in */\r\n    for (let severityPart in severityPartsSorted) {\r\n        let headerName = 'spbc-dialog-row-header-' + severityPart.toLowerCase();\r\n        let headerHtml = '<span id=\"' + headerName + '\" style=\"text-align: center\"><b>';\r\n        headerHtml += severityPart + ' weakspots:</b></span>';\r\n        const dialog = jQuery('#spbc_dialog');\r\n\r\n        dialog.append(rowTemplate.printf('', headerHtml));\r\n        dialog.append(rowTemplate. printf('<b>...</b>', '<b>...</b>'));\r\n\r\n        let header = dialog.find('#' + headerName);\r\n        header.parent().parent().css('text-align', 'center');\r\n        header.parent().parent().css('border', '1px dotted');\r\n        header.parent().parent().css('background', 'darkgrey');\r\n\r\n        /* eslint-disable guard-for-in */\r\n        for (let strNum in severityParts[severityPart]) {\r\n            // Sort bad line\r\n            strNum = [...new Set(strNum)].sort();\r\n\r\n            let row = +severityParts[severityPart][strNum];\r\n            let displayDepth = 2;\r\n            let temp;\r\n            // Display only existing lines of file\r\n            for (let currRow = row - displayDepth; currRow <= row + displayDepth; currRow++ ) {\r\n                if ( typeof result.file[currRow] !== 'undefined' ) {\r\n                    temp = row === currRow ? rowTemplateBad : rowTemplate;\r\n                    dialog.append(temp.printf(currRow, result.file[currRow]));\r\n                }\r\n            }\r\n\r\n            // Placing an empty string between results\r\n            dialog.append(rowTemplate. printf('<b>...</b>', '<b>...</b>'));\r\n        }\r\n    }\r\n\r\n    // Removing last empty string\r\n    jQuery('#spbc_dialog div').last().remove();\r\n\r\n    let contentHeight = jQuery('#spbc_dialog div').length * 19 < 76 ? 76 : jQuery('#spbc_dialog div').length * 19;\r\n    let visibleHeight = (document.documentElement.clientHeight) / 100 * 75;\r\n    let overflow = contentHeight < visibleHeight ? 'no_scroll' : 'scroll';\r\n    let height = overflow === 'scroll' ? visibleHeight : contentHeight;\r\n\r\n    jQuery('#spbc_dialog').dialog({\r\n        modal: true,\r\n        title: result.file_path,\r\n        position: {my: 'center top', at: 'center top+100px', of: window},\r\n        width: +(jQuery('#wpwrap').width() / 100 * 90),\r\n        show: {effect: 'blind', duration: 500},\r\n        draggable: true,\r\n        resizable: false,\r\n        closeText: 'X',\r\n        classes: {'ui-dialog': 'spbc---top'},\r\n        open: function(event, ui) {\r\n            event.target.style.overflow = overflow;\r\n            jQuery('#spbc_dialog').height(height);\r\n            jQuery('.ui-widget-overlay').on('click', function() {\r\n                jQuery('#spbc_dialog').dialog('close');\r\n            });\r\n        },\r\n        beforeClose: function(event, ui) {\r\n            document.body.style.overflow = 'auto';\r\n            jQuery('#spbc_dialog').empty();\r\n        },\r\n    });\r\n}\r\n\r\n/**\r\n * Callback for file view bad\r\n *\r\n * @param {object} result\r\n * @param {object} data\r\n * @param {object} params\r\n */\r\nfunction spbcScannerButtonViewBadCallback(result, data, params) { // eslint-disable-line no-unused-vars\r\n    console.log('FILE_VIEWED_BAD_CODE');\r\n\r\n    let afterClose = () => {};\r\n\r\n    if ( result.success == true ) {\r\n        console.log(result);\r\n        let rowTemplate = '<div class=\"spbc_view_file_row_wrapper\">' +\r\n            '<span class=\"spbc_view_file_row_num\">%s</span>' +\r\n            '<p class=\"spbc_view_file_row\" style=\"word-break: break-all\">%s</p>' +\r\n            '<br /></div>';\r\n        let rowTemplateBad = '<div class=\"spbc_view_file_row_wrapper\" style=\"background: rgb(200,120,120);\">' +\r\n            '<span class=\"spbc_view_file_row_num\">%s</span>' +\r\n            '<p class=\"spbc_view_file_row\" style=\"word-break: break-all\">%s</p>' +\r\n            '<br /></div>';\r\n        let strNums = [];\r\n\r\n        result.weak_spots = JSON.parse(result.weak_spots);\r\n        /* eslint-disable guard-for-in */\r\n        for (let severity in result.weak_spots) {\r\n            strNums = strNums.concat(Object.keys(result.weak_spots[severity]));\r\n        }\r\n\r\n        strNums = [...new Set(strNums)].sort(); // Sort bad line\r\n        // get a map of bad strings\r\n        // TODO: Probably there can get something else except CRITICAL in the future\r\n        let badStringsMap = new Map(Object.entries(result.weak_spots.CRITICAL));\r\n        /* eslint-disable guard-for-in */\r\n        for (let strNum in strNums) {\r\n            if (strNum == 0 && badStringsMap.get(strNums[strNum]).toLowerCase().includes('doctype')) {\r\n                continue;\r\n            }\r\n\r\n            let row = +strNums[strNum];\r\n            let displayDepth = 2;\r\n\r\n            // Display only existing lines of file\r\n            for (let currRow = row - displayDepth; currRow <= row + displayDepth; currRow++ ) {\r\n                if ( typeof result.file[currRow] !== 'undefined' ) {\r\n                    let isBadString = (row === currRow);\r\n                    let unformattedRow;\r\n                    let highlitedRow;\r\n                    if (isBadString) {\r\n                        unformattedRow = rowTemplateBad;\r\n                    } else {\r\n                        unformattedRow = rowTemplate;\r\n                    }\r\n                    if (isBadString && !result.file[currRow].includes('iframe')) {\r\n                        highlitedRow = unformattedRow.printf(currRow, badStringsMap.get(strNums[strNum]));\r\n                    } else {\r\n                        highlitedRow = unformattedRow.printf(currRow, result.file[currRow]);\r\n                    }\r\n                    jQuery('#spbc_dialog').append(highlitedRow);\r\n                }\r\n            }\r\n\r\n            // Placing an empty string between results\r\n            jQuery('#spbc_dialog').append(rowTemplate. printf('', ''));\r\n\r\n            // Removing last empty string\r\n            jQuery('#spbc_dialog div').last().remove();\r\n        }\r\n    } else {\r\n        let wrapperElement = '<div style=\"margin:40px;text-align:center;\">%s</div>';\r\n        jQuery('#spbc_dialog').append(wrapperElement.printf(result.content));\r\n        afterClose = () => {\r\n            document.location.reload();\r\n        };\r\n    }\r\n\r\n    let contentHeight = jQuery('#spbc_dialog div').length * 19 < 76 ? 76 : jQuery('#spbc_dialog div').length * 19;\r\n    let visibleHeight = (document.documentElement.clientHeight) / 100 * 75;\r\n    let height = 'auto';\r\n    let overflow = contentHeight < visibleHeight ? 'no_scroll' : 'scroll';\r\n\r\n    jQuery('#spbc_dialog').dialog({\r\n        modal: true,\r\n        title: result.file_path,\r\n        position: {my: 'center top', at: 'center top+100px', of: window},\r\n        width: +(jQuery('#wpwrap').width() / 100 * 90),\r\n        show: {effect: 'blind', duration: 500},\r\n        draggable: true,\r\n        resizable: false,\r\n        closeText: 'X',\r\n        classes: {'ui-dialog': 'spbc---top'},\r\n        open: function(event, ui) {\r\n            event.target.style.overflow = overflow;\r\n            jQuery('#spbc_dialog').height(height);\r\n            jQuery('.ui-widget-overlay').on('click', function() {\r\n                jQuery('#spbc_dialog').dialog('close');\r\n            });\r\n        },\r\n        beforeClose: function(event, ui) {\r\n            document.body.style.overflow = 'auto';\r\n            jQuery('#spbc_dialog').empty();\r\n        },\r\n        close: afterClose,\r\n    });\r\n}\r\n\r\n/**\r\n * File compare event\r\n *\r\n * @param {object} obj\r\n */\r\nfunction spbcScannerButtonFileCompareEvent(obj) { // eslint-disable-line no-unused-vars\r\n    let self = jQuery(obj);\r\n    let data = {\r\n        action: 'spbc_scanner_file_compare',\r\n        file_id: self.parents('.row-actions').attr('uid'),\r\n    };\r\n    let params = {\r\n        spinner: self.parent().siblings('.tbl-preloader--tiny'),\r\n        callback: spbcScannerButtonFileCompareCallback,\r\n        errorOutput: function(msg) {\r\n            spbcModal.open().putError( msg );\r\n        },\r\n    };\r\n    spbcSendAJAXRequest(data, params);\r\n}\r\n\r\n/**\r\n * Callback for file compare\r\n *\r\n * @param {object} result\r\n * @param {object} data\r\n * @param {object} params\r\n */\r\nfunction spbcScannerButtonFileCompareCallback(result, data, params) { // eslint-disable-line no-unused-vars\r\n    console.log('FILE_COMPARED');\r\n\r\n    let rowTemplate = '<div class=\"spbc_compare_file_row_wrapper\">';\r\n    rowTemplate += '<p class=\"spbc_compare_file_row\">%s</p><span class=\"spbc_compare_file_row_num\">%s</span>';\r\n    rowTemplate += '<p class=\"spbc_compare_file_row\">%s</p><br /></div>';\r\n    let rowTemplateBad = '<div class=\"spbc_compare_file_row_wrapper\" style=\"background: rgba(200,40,40,0.8);\">';\r\n    rowTemplateBad += '<p class=\"spbc_compare_file_row\">%s</p><span class=\"spbc_compare_file_row_num\">%s</span>';\r\n    rowTemplateBad += '<p class=\"spbc_compare_file_row\">%s</p><br /></div>';\r\n\r\n    let renderRowTemplate = rowTemplate.printf(\r\n        '<span class=\"spbc_compare_file_headings\">Modified</span>',\r\n        'Line',\r\n        '<span class=\"spbc_compare_file_headings\">Original</span>',\r\n    );\r\n    jQuery('#spbc_dialog').append(renderRowTemplate);\r\n\r\n    for (let row=1; typeof result.file[row] != 'undefined' || typeof result.file_original[row] != 'undefined'; row++) {\r\n        if (typeof result.file[row] == 'undefined') result.file[row] = '';\r\n        if (typeof result.file_original[row] == 'undefined') result.file_original[row] = '';\r\n\r\n        // Display only existing lines of file\r\n        if (result.difference.indexOf(row) != -1) {\r\n            for (let displayDepth = 2, currRow = row - displayDepth; currRow <= row + displayDepth; currRow++ ) {\r\n                if ( typeof result.file[currRow] !== 'undefined' && typeof result.file_original[row] !== 'undefined') {\r\n                    jQuery('#spbc_dialog').append(\r\n                        (row === currRow ? rowTemplateBad : rowTemplate).printf(\r\n                            result.file[currRow] ? result.file[currRow] : '',\r\n                            currRow,\r\n                            result.file_original[currRow] ? result.file_original[currRow] : '',\r\n                        ),\r\n                    );\r\n                }\r\n            }\r\n            jQuery('#spbc_dialog').append(rowTemplate. printf('', '', ''));\r\n        }\r\n    }\r\n\r\n    let contentHeight = jQuery('#spbc_dialog div').length * 19 + 19;\r\n    let visibleHeight = (document.documentElement.clientHeight) / 100 * 75;\r\n    let overflow = contentHeight < visibleHeight ? 'no_scroll' : 'scroll';\r\n    let height = overflow === 'scroll' ? visibleHeight : contentHeight;\r\n\r\n    jQuery('#spbc_dialog').dialog({\r\n        modal: true,\r\n        title: result.file_path,\r\n        position: {my: 'center top', at: 'center top+100px', of: window},\r\n        width: +(jQuery('#wpwrap').width() / 100 * 90),\r\n        height: height,\r\n        show: {effect: 'blind', duration: 500},\r\n        draggable: true,\r\n        resizable: true,\r\n        closeText: 'X',\r\n        classes: {'ui-dialog': 'spbc---top'},\r\n        open: function(event, ui) {\r\n            document.body.style.overflow = 'hidden';\r\n            event.target.style.overflow = overflow;\r\n            jQuery('#spbc_dialog').height(height);\r\n        },\r\n        beforeClose: function(event, ui) {\r\n            document.body.style.overflow = 'auto';\r\n            jQuery('#spbc_dialog').empty();\r\n        },\r\n    });\r\n}\r\n\r\n/**\r\n * Reloads last scan info\r\n */\r\nfunction spbcScannerReloadScanInfo() { // eslint-disable-line no-unused-vars\r\n    jQuery('.spbc_hint__last_scan_title').text(spbcScaner.look_below_for_scan_res);\r\n    const data = {\r\n        action: 'spbc_scanner__last_scan_info',\r\n    };\r\n    const params = {\r\n        callback: (result) => {\r\n            document.getElementById('spbc_scanner__last_scan_info').innerText = result.data;\r\n        },\r\n    };\r\n    spbcSendAJAXRequest(data, params);\r\n}\r\n\r\n/**\r\n * Cure file\r\n * @param {object} obj\r\n */\r\nfunction spbcScannerButtonCureFileAjaxHandler(obj) { // eslint-disable-line no-unused-vars\r\n    const self = jQuery(obj);\r\n    const fileFastHash = self.parents('.row-actions').attr('uid');\r\n\r\n    let data = {\r\n        action: 'spbc_file_cure_ajax_action',\r\n        file_fast_hash: fileFastHash,\r\n        security: spbcSettings.ajax_nonce,\r\n    };\r\n\r\n    jQuery.ajax({\r\n        type: 'POST',\r\n        async: true,\r\n        url: spbcSettings.ajaxurl,\r\n        data: data,\r\n        success: function(result) {\r\n            if (result.success) {\r\n                spbcModal.open().put(result.data);\r\n                document.addEventListener('spbcModalClosed', function( e ) {\r\n                    document.location.reload();\r\n                });\r\n            } else {\r\n                spbcModal.open().putError(result.data);\r\n            }\r\n        },\r\n    });\r\n}\r\n\r\n/**\r\n * Restore file from backup\r\n * @param {object} obj\r\n */\r\nfunction spbcScannerButtonRestoreFromBackupAjaxHandler(obj) { // eslint-disable-line no-unused-vars\r\n    const self = jQuery(obj);\r\n    const fileFastHash = self.parents('.row-actions').attr('uid');\r\n\r\n    let data = {\r\n        action: 'spbc_restore_file_from_backup_ajax_action',\r\n        file_fast_hash: fileFastHash,\r\n        security: spbcSettings.ajax_nonce,\r\n    };\r\n\r\n    jQuery.ajax({\r\n        type: 'POST',\r\n        async: true,\r\n        url: spbcSettings.ajaxurl,\r\n        data: data,\r\n        success: function(result) {\r\n            if (result.success) {\r\n                spbcModal.open().put(result.data);\r\n                document.addEventListener('spbcModalClosed', function( e ) {\r\n                    document.location.reload();\r\n                });\r\n            } else {\r\n                spbcModal.open().putError(result.data);\r\n            }\r\n        },\r\n    });\r\n}\r\n\r\n/**\r\n * Clear scan results\r\n * @return {void}\r\n */\r\nfunction spbcScannerButtonClearScanResults() { // eslint-disable-line no-unused-vars\r\n    if ( ! confirm('Do you confirm to clear the scan results?') ) {\r\n        return;\r\n    }\r\n\r\n    console.log('CLEAR');\r\n\r\n    spbcSendAJAXRequest(\r\n        {action: 'spbc_scanner_clear'},\r\n        {\r\n            type: 'GET',\r\n            successCallback: function() {\r\n                document.location = document.location;\r\n            },\r\n            complete: null,\r\n            errorOutput: null,\r\n            context: this,\r\n            timeout: 40000,\r\n            success: function() {\r\n                document.location.reload();\r\n            },\r\n        },\r\n    );\r\n}\r\n\r\njQuery(document).ready(function() {\r\n    // EVENT HADLING\r\n    spbcTblBulkActionsListen(); // Table. Row bulk handler\r\n    spbcTblRowActionsListen(); // Table. Row actions handler\r\n    spbcTblPaginationListen(); // Table. Pagination handler\r\n    spbcTblSortListen(); // Table. Sort handler\r\n\r\n    spbcStartShowHide();\r\n\r\n    // Preparing progressbar\r\n    jQuery('#spbc_scaner_progress_bar').progressbar({\r\n        value: 0,\r\n        create: function( event, ui ) {\r\n            event.target.style.position = 'relative';\r\n            event.target.style.marginBottom = '12px';\r\n        },\r\n        change: function(event, ui) {\r\n            jQuery('.spbc_progressbar_counter span').text(jQuery(event.target).progressbar('option', 'value') + ' %');\r\n        },\r\n    });\r\n\r\n    // Preparing accordion\r\n    jQuery('#spbc_scan_accordion').accordion({\r\n        header: 'h3',\r\n        heightStyle: 'content',\r\n        collapsible: true,\r\n        active: false,\r\n        activate: function( event, ui ) {\r\n            if ( ui.oldPanel.length === 0 && ui.oldHeader.length === 0 ) {\r\n                jQuery('#spbc_scan_accordion')\r\n                    .accordion('option', 'classes.ui-accordion-content', 'ui-corner-bottom spbc-overflow--visible');\r\n            }\r\n        },\r\n        beforeActivate: function( event, ui ) {\r\n            if ( ui.oldPanel.length === 1 && ui.oldHeader.length === 1 ) {\r\n                jQuery('#spbc_scan_accordion').accordion('option', 'classes.ui-accordion-content', 'ui-corner-bottom');\r\n            }\r\n        },\r\n    });\r\n\r\n    // Init scanner plugin\r\n    window.spbcScanner = new SpbcMalwareScanner({\r\n        settings: spbcScaner.settings,\r\n        states: spbcScaner.states,\r\n        button: jQuery('#spbc_perform_scan'),\r\n        spinner: jQuery('#spbc_perform_scan').next(),\r\n        callback: null,\r\n        progress_overall: jQuery('#spbc_scaner_progress_overall'),\r\n        progressbar: jQuery('#spbc_scaner_progress_bar'),\r\n        progressbar_text: jQuery('.spbc_progressbar_counter span'),\r\n        wrapper: document.getElementsByClassName('spbc_unchecked_file_list'),\r\n        warnings: {\r\n            long_scan: jQuery('.spbc_hint_warning__long_scan'),\r\n            outdated: jQuery('.spbc_hint_warning__outdated'),\r\n        },\r\n    });\r\n\r\n    jQuery(document).on('click', '.spbc_popup_tip--icon---show', function() {\r\n        spbcPopupTipShow( jQuery( this ) );\r\n    });\r\n\r\n    jQuery('#spbc_perform_scan').on('click', function() {\r\n        jQuery('#spbcscan-results-log-module').remove();\r\n        spbcScanner.actionControl();\r\n\r\n        if (!jQuery('.spbc_log-wrapper .panel-body').length) {\r\n            jQuery('.spbc_log-wrapper').append('<div class=\"panel-body\"></div>');\r\n        }\r\n\r\n        jQuery('.spbc_log-wrapper').resizable({\r\n            handles: 'n, s',\r\n            containment: 'document',\r\n        });\r\n    });\r\n\r\n    jQuery('#spbcscan-results-log-module').resizable({\r\n        handles: 'n, s',\r\n        containment: 'document',\r\n    });\r\n\r\n    // Clear scanner's tables\r\n    jQuery('#spbc_scanner_clear').on('click', function() {\r\n        if ( ! confirm('Do you confirm to clear the scan results?') ) {\r\n            return;\r\n        }\r\n\r\n        console.log('CLEAR');\r\n\r\n        spbcSendAJAXRequest(\r\n            {action: 'spbc_scanner_clear'},\r\n            {\r\n                type: 'GET',\r\n                successCallback: function() {\r\n                    document.location = document.location;\r\n                },\r\n                complete: null,\r\n                errorOutput: null,\r\n                context: this,\r\n                timeout: 40000,\r\n                success: function() {\r\n                    document.location.reload();\r\n                },\r\n            },\r\n        );\r\n    });\r\n\r\n    jQuery('#spbc_scanner_save_to_pdf').on('click', function() {\r\n        jQuery.ajax({\r\n            url: spbcSettings.ajaxurl,\r\n            type: 'POST',\r\n            data: {\r\n                action: 'spbc_scanner_save_to_pdf',\r\n                security: spbcSettings.ajax_nonce,\r\n                no_cache: Math.random(),\r\n            },\r\n            xhrFields: {\r\n                responseType: 'blob',\r\n            },\r\n            success: function(data) {\r\n                jQuery.ajax({\r\n                    url: spbcSettings.ajaxurl,\r\n                    type: 'POST',\r\n                    data: {\r\n                        action: 'spbc_scanner_get_pdf_file_name',\r\n                        security: spbcSettings.ajax_nonce,\r\n                        no_cache: Math.random(),\r\n                    },\r\n                    xhrFields: {\r\n                        responseType: 'text',\r\n                    },\r\n                    success: function(filename) {\r\n                        let blob=new Blob([data]);\r\n                        let link=document.createElement('a');\r\n                        link.href=window.URL.createObjectURL(blob);\r\n                        link.download=filename.data;\r\n                        link.click();\r\n                    },\r\n                },\r\n                );\r\n            },\r\n        });\r\n    });\r\n});\r\n"],"names":["spbcPopupTipShow","showIcon","let","tipTitle","attr","tipText","removeDescFunc","e","jQuery","target","parent","length","hasClass","hide","document","off","after","obj","empty","append","css","top","position","left","on","parents","spbcScannerButtonFileViewEvent","self","data","action","file_id","params","spinner","siblings","callback","spbcScannerButtonViewCallback","errorOutput","msg","spbcModal","open","putError","spbcSendAJAXRequest","spbcScannerAnalysisLogDeleteFromLog","fileIds","push","selectedItems","closest","find","alert","each","index","element","elementId","val","children","file_ids","window","location","reload","spbcScannerButtonPageViewEvent","page_url","wpWrap","dialogWindow","dialog","modal","title","my","at","of","width","show","effect","duration","draggable","resizable","closeText","classes","ui-dialog","event","ui","style","overflow","height","documentElement","beforeClose","body","sizeMultiplier","result","row","rowTemplate","display","file","printf","contentHeight","Object","keys","visibleHeight","file_path","console","log","spbcScannerButtonFileViewBadEvent","spbcScannerButtonViewBadFileCallback","spbcScannerButtonPageViewBadEvent","spbcScannerButtonViewBadCallback","severityKeysSorted","severity","severityPart","rowTemplateBad","severityParts","severityPartsSorted","weak_spots","JSON","parse","key","sort","strNum","headerName","toLowerCase","headerHtml","header","Set","temp","currRow","last","remove","afterClose","success","strNums","concat","badStringsMap","Map","entries","CRITICAL","get","includes","isBadString","unformattedRow","highlitedRow","content","close","spbcScannerButtonFileCompareEvent","spbcScannerButtonFileCompareCallback","renderRowTemplate","file_original","difference","indexOf","spbcScannerReloadScanInfo","text","spbcScaner","look_below_for_scan_res","getElementById","innerText","spbcScannerButtonCureFileAjaxHandler","file_fast_hash","security","spbcSettings","ajax_nonce","ajax","type","async","url","ajaxurl","put","addEventListener","spbcScannerButtonRestoreFromBackupAjaxHandler","spbcScannerButtonClearScanResults","confirm","successCallback","complete","context","this","timeout","ready","spbcTblBulkActionsListen","spbcTblRowActionsListen","spbcTblPaginationListen","spbcTblSortListen","spbcStartShowHide","progressbar","value","create","marginBottom","change","accordion","heightStyle","collapsible","active","activate","oldPanel","oldHeader","beforeActivate","spbcScanner","SpbcMalwareScanner","settings","states","button","next","progress_overall","progressbar_text","wrapper","getElementsByClassName","warnings","long_scan","outdated","actionControl","handles","containment","no_cache","Math","random","xhrFields","responseType","filename","blob","Blob","link","createElement","href","URL","createObjectURL","download","click"],"mappings":"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"}