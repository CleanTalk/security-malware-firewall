{"version":3,"file":"spbc-settings_tab--scanner.min.js","sources":["spbc-settings_tab--scanner.js"],"sourcesContent":["function spbc_popup_tip___show(show_icon) {\n    let tip_title = show_icon.attr('spbc_tip_title') || null;\n    let\ttip_text = show_icon.attr('spbc_tip_text') || null;\n    let remove_desc_func = function(e) {\n        if (\n            typeof e === 'undefined' ||\n\t\t\t(\n\t\t\t    (jQuery(e.target).parent('.spbc_popup_tip--wrapper').length == 0 || jQuery(e.target).hasClass('spbc_popup_tip--icon---cancel')) &&\n\t\t\t\t!jQuery(e.target).hasClass('spbc_popup_tip--icon---show')\n\t\t\t)\n        ) {\n            jQuery('.spbc_popup_tip--wrapper').hide();\n            jQuery(document).off('click', remove_desc_func);\n        }\n    };\n\n    remove_desc_func();\n\n    show_icon.after('<div class=\\'spbc_popup_tip--wrapper\\'></div>');\n\n    let obj = jQuery('.spbc_popup_tip--wrapper');\n\n    obj.empty()\n        .append('<div class=\\'spbc_popup_tip--angle\\'></div>')\n        .css({\n            top: show_icon.position().top - 2,\n            left: show_icon.position().left + 25,\n        });\n    obj.append('<i class=\\'spbc_popup_tip--icon---cancel icon-cancel\\'></i>')\n        .append('<h3 class=\\'spbc_popup_tip--title\\'>' + tip_title + '</h3>')\n        .append('<p class=\\'spbc_popup_tip--text\\'>' + tip_text + '</p>');\n\n    jQuery(document).on('click', remove_desc_func);\n    show_icon.parents('tr').on('mouseout', remove_desc_func);\n}\n\nfunction spbc_scanner_button_file_view_event(obj) {\n    let self = jQuery(obj);\n    let data = {\n        action: 'spbc_scanner_file_view',\n        file_id: self.parents('.row-actions').attr('uid'),\n    };\n    let params = {\n        spinner: self.parent().siblings('.tbl-preloader--tiny'),\n        callback: spbc_scannerButtonView_callback,\n        errorOutput: function(msg) {\n            spbcModal.open().putError( msg );\n        },\n    };\n    spbcSendAJAXRequest(data, params);\n}\n\n/**\n * Delete file from analysis log\n */\nfunction spbc_scanner_analysis_log_delete_from_log(obj) {\n    let fileIds = [];\n    const self = jQuery(obj);\n    let spinner;\n\n    if ( jQuery(obj).hasClass('tbl-row_action') ) {\n        fileIds.push(self.parents('.row-actions').attr('uid'));\n        spinner = self.parent().siblings('.tbl-preloader--tiny');\n    } else {\n        const selectedItems = self.closest('#spbc_tbl__scanner_analysis_log').find('.cb-select:checked');\n        if (selectedItems.length === 0) {\n            alert('Please, select elements.');\n            return;\n        }\n\n        selectedItems.each(function(index, element) {\n            const elementId = jQuery(element).val();\n            fileIds.push(elementId);\n        });\n        spinner = self.children('.tbl-preloader--small');\n    }\n\n    const data = {\n        action: 'spbc_scanner_analysis_log_delete_from_log',\n        file_ids: fileIds,\n    };\n\n    let params = {\n        spinner: spinner,\n        callback: function() {\n            window.location.reload();\n        },\n    };\n\n    spbcSendAJAXRequest(data, params);\n}\n\nfunction spbc_scanner_button_page_view_event(obj) {\n    let self = jQuery(obj);\n    let data = {\n        action: 'spbc_scanner_page_view',\n        page_url: self.parents('.row-actions').attr('uid'),\n    };\n    let params = {\n        spinner: self.parent().siblings('.tbl-preloader--tiny'),\n        callback: spbc_scannerButtonView_callback,\n        errorOutput: function(msg) {\n            spbcModal.open().putError( msg );\n        },\n    };\n\n    let wp_wrap = jQuery('#wpwrap');\n    let dialog_window = jQuery('#spbc_dialog');\n\n    dialog_window.dialog({\n        modal: true,\n        title: 'Loading..',\n        position: {my: 'center top', at: 'center top+100px', of: window},\n        width: +(wp_wrap.width() / 100 * 90),\n        show: {effect: 'blind', duration: 500},\n        draggable: false,\n        resizable: false,\n        closeText: 'X',\n        classes: {'ui-dialog': 'spbc---top'},\n        open: function(event, ui) {\n            event.target.style.overflow = 'auto';\n            jQuery('#spbc_dialog').height((document.documentElement.clientHeight) / 100 * 25);\n        },\n        beforeClose: function(event, ui) {\n            document.body.style.overflow = 'auto';\n            jQuery('#spbc_dialog').empty();\n        },\n    });\n\n    dialog_window.append('<img id=\"spbc_file_view_preloader\" alt=\"Wait for downloading\" ' +\n\t\t'class=\"spbc_preloader\" ' +\n\t\t'src=\"../../wp-content/plugins/security-malware-firewall/images/preloader2.gif\" ' +\n\t\t'style=\"' +\n\t\t'display: block; ' +\n\t\t'position: absolute; ' +\n\t\t'\">');\n\n    let spinner = jQuery('#spbc_file_view_preloader');\n    let size_multiplier = (wp_wrap.width() * 0.0004);\n\n    spinner.height(128 * size_multiplier);\n    spinner.width(128 * size_multiplier);\n    spinner.css({left: dialog_window.width()/2 - (128 * size_multiplier / 2)});\n    spinner.css({top: dialog_window.height()/2 - (128 * size_multiplier / 2)});\n\n    spbcSendAJAXRequest(data, params);\n}\n\nfunction spbc_scannerButtonView_callback(result) {\n    let dialog_window = jQuery('#spbc_dialog');\n    dialog_window.empty();\n\n    jQuery('#spbc_file_view_preloader').css({display: 'none'});\n\n    let row_template = '<div class=\"spbc_view_file_row_wrapper\"><span class=\"spbc_view_file_row_num\">%s</span><p class=\"spbc_view_file_row\">%s</p><br /></div>';\n\n    for (let row in result.file) {\n        dialog_window.append(row_template.printf(row, result.file[row]));\n    }\n\n    let content_height = Object.keys(result.file).length * 19 < 76 ? 76 : Object.keys(result.file).length * 19;\n    let visible_height = (document.documentElement.clientHeight) / 100 * 75;\n    let overflow = content_height < visible_height ? 'hidden' : 'scroll';\n    let height = overflow === 'scroll' ? visible_height : content_height;\n\n    dialog_window.css({\n        height: height,\n        overflow: overflow,\n    });\n\n    dialog_window.dialog({\n        modal: true,\n        title: ('Loaded: ' + result.file_path),\n        position: {my: 'center top', at: 'center top+100px', of: window},\n        width: +(jQuery('#wpwrap').width() / 100 * 90),\n        show: {effect: 'blind', duration: 500},\n        draggable: true,\n        resizable: false,\n        height: height,\n        closeText: 'X',\n        classes: {'ui-dialog': 'spbc---top'},\n        open: function(event, ui) {\n            event.target.style.overflow = overflow;\n            jQuery('#spbc_dialog').height(height);\n            jQuery('.ui-widget-overlay').on('click', function() {\n                jQuery('#spbc_dialog').dialog('close');\n            });\n        },\n        beforeClose: function(event, ui) {\n            document.body.style.overflow = 'auto';\n            jQuery('#spbc_dialog').empty();\n        },\n    });\n\n    console.log('FILE_VIEWED');\n}\n\nfunction spbc_scanner_button_file_view_bad_event(obj) {\n    let self = jQuery(obj);\n    let data = {\n        action: 'spbc_scanner_file_view',\n        file_id: self.parents('.row-actions').attr('uid'),\n    };\n    let params = {\n        spinner: self.parent().siblings('.tbl-preloader--tiny'),\n        callback: spbc_scannerButtonViewBadFile_callback,\n        errorOutput: function(msg) {\n            spbcModal.open().putError( msg );\n        },\n    };\n    spbcSendAJAXRequest(data, params);\n}\n\nfunction spbc_scanner_button_page_view_bad_event(obj) {\n    let self = jQuery(obj);\n    let data = {\n        action: 'spbc_scanner_page_view',\n        page_url: self.parent().attr('uid'),\n    };\n    let params = {\n        spinner: self.parent().siblings('.tbl-preloader--tiny'),\n        callback: spbc_scannerButtonViewBad_callback,\n        errorOutput: function(msg) {\n            spbcModal.open().putError( msg );\n        },\n    };\n    spbcSendAJAXRequest(data, params);\n}\n\nfunction spbc_scannerButtonViewBadFile_callback(result, data, params) {\n    console.log('FILE_VIEWED_BAD_CODE_FILE');\n    console.log(arguments);\n    jQuery('#spbc_dialog').empty();\n\n    let row_template = '<div class=\"spbc_view_file_row_wrapper\"><span class=\"spbc_view_file_row_num\">%s</span><p class=\"spbc_view_file_row\">%s</p><br /></div>';\n    let row_template_bad = '<div class=\"spbc_view_file_row_wrapper\" style=\"background: rgba(200,40,40,0.8);\"><span class=\"spbc_view_file_row_num\">%s</span><p class=\"spbc_view_file_row\">%s</p><br /></div>';\n    let severity_parts = [];\n    let severity_parts_sorted = [];\n    let severity_keys_sorted = [];\n\n    result.weak_spots = JSON.parse(result.weak_spots);\n    for (let severity in result.weak_spots) {\n        severity_parts[severity] = Object.keys(result.weak_spots[severity]);\n    }\n\n    severity_keys_sorted = Object.keys(severity_parts).sort();\n\n    for (key in severity_keys_sorted) {\n        severity_parts_sorted[severity_keys_sorted[key]] = severity_parts[severity_keys_sorted[key]];\n    }\n\n    for (let severity_part in severity_parts_sorted) {\n        let header_name = 'spbc-dialog-row-header-' + severity_part.toLowerCase();\n        let header_html = '<span id=\"' + header_name + '\" style=\"text-align: center\"><b>' + severity_part + ' weakspots:</b></span>';\n        const dialog = jQuery('#spbc_dialog');\n\n        dialog.append(row_template.printf('', header_html));\n        dialog.append(row_template. printf('<b>...</b>', '<b>...</b>'));\n\n        let header = dialog.find('#' + header_name);\n        header.parent().parent().css('text-align', 'center');\n        header.parent().parent().css('border', '1px dotted');\n        header.parent().parent().css('background', 'darkgrey');\n\n        for (let str_num in severity_parts[severity_part]) {\n            // Sort bad line\n            str_num = [...new Set(str_num)].sort();\n\n            let row = +severity_parts[severity_part][str_num];\n            let display_depth = 2;\n\n            // Display only existing lines of file\n            for (let curr_row = row - display_depth; curr_row <= row + display_depth; curr_row++ ) {\n                if ( typeof result.file[curr_row] !== 'undefined' ) {\n                    dialog.append((row === curr_row ? row_template_bad : row_template).printf(curr_row, result.file[curr_row]));\n                }\n            }\n\n            // Placing an empty string between results\n            dialog.append(row_template. printf('<b>...</b>', '<b>...</b>'));\n        }\n    }\n\n    // Removing last empty string\n    jQuery('#spbc_dialog div').last().remove();\n\n    let content_height = jQuery('#spbc_dialog div').length * 19 < 76 ? 76 : jQuery('#spbc_dialog div').length * 19;\n    let visible_height = (document.documentElement.clientHeight) / 100 * 75;\n    let overflow = content_height < visible_height ? 'no_scroll' : 'scroll';\n    let height = overflow === 'scroll' ? visible_height : content_height;\n\n    jQuery('#spbc_dialog').dialog({\n        modal: true,\n        title: result.file_path,\n        position: {my: 'center top', at: 'center top+100px', of: window},\n        width: +(jQuery('#wpwrap').width() / 100 * 90),\n        show: {effect: 'blind', duration: 500},\n        draggable: true,\n        resizable: false,\n        closeText: 'X',\n        classes: {'ui-dialog': 'spbc---top'},\n        open: function(event, ui) {\n            event.target.style.overflow = overflow;\n            jQuery('#spbc_dialog').height(height);\n            jQuery('.ui-widget-overlay').on('click', function() {\n                jQuery('#spbc_dialog').dialog('close');\n            });\n        },\n        beforeClose: function(event, ui) {\n            document.body.style.overflow = 'auto';\n            jQuery('#spbc_dialog').empty();\n        },\n    });\n}\n\nfunction spbc_scannerButtonViewBad_callback(result, data, params) {\n    console.log('FILE_VIEWED_BAD_CODE');\n\n    console.log(arguments);\n\n    let afterClose = () => {};\n\n    if ( result.success == true ) {\n        console.log(result);\n        let row_template = '<div class=\"spbc_view_file_row_wrapper\">' +\n\t\t\t\t'<span class=\"spbc_view_file_row_num\">%s</span>' +\n\t\t\t\t'<p class=\"spbc_view_file_row\" style=\"word-break: break-all\">%s</p>' +\n\t\t\t\t'<br /></div>';\n        let row_template_bad = '<div class=\"spbc_view_file_row_wrapper\" style=\"background: rgb(200,120,120);\">' +\n\t\t\t\t'<span class=\"spbc_view_file_row_num\">%s</span>' +\n\t\t\t\t'<p class=\"spbc_view_file_row\" style=\"word-break: break-all\">%s</p>' +\n\t\t\t\t'<br /></div>';\n        let str_nums = [];\n\n        result.weak_spots = JSON.parse(result.weak_spots);\n        for (let severity in result.weak_spots) {\n            str_nums = str_nums.concat(Object.keys(result.weak_spots[severity]));\n        }\n\n        str_nums = [...new Set(str_nums)].sort(); // Sort bad line\n        // get a map of bad strings\n        let bad_strings_map = new Map(Object.entries(result.weak_spots.CRITICAL)); // TODO: Probably there can get something else except CRITICAL in the future\n        for (let str_num in str_nums) {\n            if (str_num == 0 && bad_strings_map.get(str_nums[str_num]).toLowerCase().includes('doctype')) {\n                continue;\n            }\n\n            let row = +str_nums[str_num];\n            let display_depth = 2;\n\n            // Display only existing lines of file\n            for (let curr_row = row - display_depth; curr_row <= row + display_depth; curr_row++ ) {\n                if ( typeof result.file[curr_row] !== 'undefined' ) {\n                    let is_bad_string = (row === curr_row);\n                    let unformatted_row;\n                    let highlited_row;\n                    if (is_bad_string) {\n                        unformatted_row = row_template_bad;\n                    } else {\n                        unformatted_row = row_template;\n                    }\n                    if (is_bad_string && !result.file[curr_row].includes('iframe')) {\n                        highlited_row = unformatted_row.printf(curr_row, bad_strings_map.get(str_nums[str_num]));\n                    } else {\n                        highlited_row = unformatted_row.printf(curr_row, result.file[curr_row]);\n                    }\n                    jQuery('#spbc_dialog').append(highlited_row);\n                }\n            }\n\n            // Placing an empty string between results\n            jQuery('#spbc_dialog').append(row_template. printf('', ''));\n\n            // Removing last empty string\n            jQuery('#spbc_dialog div').last().remove();\n        }\n    } else {\n        let wrapperElement = '<div style=\"margin:40px;text-align:center;\">%s</div>';\n        jQuery('#spbc_dialog').append(wrapperElement.printf(result.content));\n        afterClose = () => {\n            document.location.reload();\n        };\n    }\n\n    let content_height = jQuery('#spbc_dialog div').length * 19 < 76 ? 76 : jQuery('#spbc_dialog div').length * 19;\n    let visible_height = (document.documentElement.clientHeight) / 100 * 75;\n    let height = 'auto';\n    let overflow = content_height < visible_height ? 'no_scroll' : 'scroll';\n\n    jQuery('#spbc_dialog').dialog({\n        modal: true,\n        title: result.file_path,\n        position: {my: 'center top', at: 'center top+100px', of: window},\n        width: +(jQuery('#wpwrap').width() / 100 * 90),\n        show: {effect: 'blind', duration: 500},\n        draggable: true,\n        resizable: false,\n        closeText: 'X',\n        classes: {'ui-dialog': 'spbc---top'},\n        open: function(event, ui) {\n            event.target.style.overflow = overflow;\n            jQuery('#spbc_dialog').height(height);\n            jQuery('.ui-widget-overlay').on('click', function() {\n                jQuery('#spbc_dialog').dialog('close');\n            });\n        },\n        beforeClose: function(event, ui) {\n            document.body.style.overflow = 'auto';\n            jQuery('#spbc_dialog').empty();\n        },\n        close: afterClose,\n    });\n}\n\nfunction spbc_scanner_button_file_compare_event(obj) {\n    let self = jQuery(obj);\n    let data = {\n        action: 'spbc_scanner_file_compare',\n        file_id: self.parents('.row-actions').attr('uid'),\n    };\n    let params = {\n        spinner: self.parent().siblings('.tbl-preloader--tiny'),\n        callback: spbc_scannerButtonFileCompare_callback,\n        errorOutput: function(msg) {\n            spbcModal.open().putError( msg );\n        },\n    };\n    spbcSendAJAXRequest(data, params);\n}\n\nfunction spbc_scannerButtonFileCompare_callback(result, data, params) {\n    console.log('FILE_COMPARED');\n\n    let row_template = '<div class=\"spbc_compare_file_row_wrapper\"><p class=\"spbc_compare_file_row\">%s</p><span class=\"spbc_compare_file_row_num\">%s</span><p class=\"spbc_compare_file_row\">%s</p><br /></div>';\n    let row_template_bad = '<div class=\"spbc_compare_file_row_wrapper\" style=\"background: rgba(200,40,40,0.8);\"><p class=\"spbc_compare_file_row\">%s</p><span class=\"spbc_compare_file_row_num\">%s</span><p class=\"spbc_compare_file_row\">%s</p><br /></div>';\n\n    jQuery('#spbc_dialog').append(row_template.printf('<span class=\"spbc_compare_file_headings\">Modified</span>', 'Line', '<span class=\"spbc_compare_file_headings\">Original</span>'));\n\n    for (let row=1, prev = false, next = false; typeof result.file[row] != 'undefined' || typeof result.file_original[row] != 'undefined'; row++) {\n        if (typeof result.file[row] == 'undefined') result.file[row] = '';\n        if (typeof result.file_original[row] == 'undefined') result.file_original[row] = '';\n\n        // Display only existing lines of file\n        if (result.difference.indexOf(row) != -1) {\n            for (let display_depth = 2, curr_row = row - display_depth; curr_row <= row + display_depth; curr_row++ ) {\n                if ( typeof result.file[curr_row] !== 'undefined' && typeof result.file_original[row] !== 'undefined') {\n                    jQuery('#spbc_dialog').append(\n                        (row === curr_row ? row_template_bad : row_template).printf(\n                            result.file[curr_row] ? result.file[curr_row] : '',\n                            curr_row,\n                            result.file_original[curr_row] ? result.file_original[curr_row] : '',\n                        ),\n                    );\n                }\n            }\n            jQuery('#spbc_dialog').append(row_template. printf('', '', ''));\n        }\n    }\n\n    let content_height = jQuery('#spbc_dialog div').length * 19 + 19;\n    let visible_height = (document.documentElement.clientHeight) / 100 * 75;\n    let overflow = content_height < visible_height ? 'no_scroll' : 'scroll';\n    let height = overflow === 'scroll' ? visible_height : content_height;\n\n    jQuery('#spbc_dialog').dialog({\n        modal: true,\n        title: result.file_path,\n        position: {my: 'center top', at: 'center top+100px', of: window},\n        width: +(jQuery('#wpwrap').width() / 100 * 90),\n        height: height,\n        show: {effect: 'blind', duration: 500},\n        draggable: true,\n        resizable: true,\n        closeText: 'X',\n        classes: {'ui-dialog': 'spbc---top'},\n        open: function(event, ui) {\n            document.body.style.overflow = 'hidden';\n            event.target.style.overflow = overflow;\n            jQuery('#spbc_dialog').height(height);\n        },\n        beforeClose: function(event, ui) {\n            document.body.style.overflow = 'auto';\n            jQuery('#spbc_dialog').empty();\n        },\n    });\n}\n\nfunction spbc_scanner__reload_scan_info() {\n    jQuery('.spbc_hint__last_scan_title').text(spbcScaner.look_below_for_scan_res);\n    const data = {\n        action: 'spbc_scanner__last_scan_info',\n    };\n    const params = {\n        callback: (result) => {\n            document.getElementById('spbc_scanner__last_scan_info').innerText = result.data;\n        },\n    };\n    spbcSendAJAXRequest(data, params);\n}\n\n/**\n * Show snapshots of file\n * @param obj\n */\nfunction spbc_scanner_file_monitoring_show_current_snapshot(obj) {\n    const self = jQuery(obj);\n    const fileId = self.parents('.row-actions').attr('uid');\n    const file_name = self.closest('.column-path').find('.title').text();\n\n    // Init and open remodal\n    const remodal = jQuery('[data-remodal-id=spbc-file-monitoring-modal]');\n    const remodalObject = remodal.remodal();\n    remodalObject.open();\n\n    // Ajax request to get data for slider\n    let data = {\n        action: 'spbc_file_monitoring_show_snapshots',\n        file_id: fileId,\n        security: spbcSettings.ajax_nonce,\n    };\n\n    jQuery.ajax({\n        type: 'POST',\n        async: true,\n        url: spbcSettings.ajaxurl,\n        data: data,\n        success: function(result) {\n            if (result.success) {\n                remodal.find('#spbc-fm-snapshot-list ul').remove();\n                remodal.find('#spbc-fm-snapshot-file-name').text(file_name);\n                drawSnapshotList(result.data, remodal);\n                drawCurrentSnapshot(result.data[0].id, remodal);\n            } else {\n                // TODO: show errors\n            }\n        },\n    });\n}\n\n/**\n *\n * @param data\n * @param remodal\n */\nfunction drawSnapshotList(data, remodal) {\n    let list = '';\n\n    for (let item of data) {\n        list += `<li data-spanshot-id=\"${item.id}\">${item.created_at}</li>`;\n    }\n\n    let html =\n\t\t`<ul>\n            ${list}\n        </ul>`;\n\n    remodal.find('#spbc-fm-snapshot-list').append(html);\n}\n\nfunction drawCurrentSnapshot(snapshot_id, remodal) {\n    // Ajax request to get data for slider\n    let data = {\n        action: 'spbc_file_monitoring_show_current_snapshot',\n        snapshot_id,\n        security: spbcSettings.ajax_nonce,\n    };\n\n    jQuery.ajax({\n        type: 'POST',\n        async: true,\n        url: spbcSettings.ajaxurl,\n        data: data,\n        beforeSend: function() {\n            jQuery('#spbc-file-monitoring-modal-preloader').show();\n        },\n        success: function(result) {\n            if (result.success) {\n                remodal.find('#spbc-fm-snapshot-view .wrap').remove();\n                remodal.find('[data-spanshot-id').removeClass('active');\n                remodal.find('[data-spanshot-id=' + snapshot_id + ']').addClass('active');\n\n                let html =\n\t\t\t\t\t`<div class=\"wrap\">\n                        <pre>\n                            <code>\n                                ${result.data.content}\n                            </code>\n                        </pre>\n                    </div>`;\n\n                jQuery('#spbc-file-monitoring-modal-preloader').hide();\n                remodal.find('#spbc-fm-snapshot-view').append(html);\n                document.querySelectorAll('pre code').forEach((el) => {\n                    hljs.highlightElement(el);\n                });\n            } else {\n                // TODO: show errors\n            }\n        },\n    });\n}\n\n/**\n * Cure file\n * @param obj\n */\nfunction spbc_scanner_button_cure_file_ajax_handler(obj) {\n    const self = jQuery(obj);\n    const fileFastHash = self.parents('.row-actions').attr('uid');\n\n    let data = {\n        action: 'spbc_file_cure_ajax_action',\n        file_fast_hash: fileFastHash,\n        security: spbcSettings.ajax_nonce,\n    };\n\n    jQuery.ajax({\n        type: 'POST',\n        async: true,\n        url: spbcSettings.ajaxurl,\n        data: data,\n        success: function(result) {\n            if (result.success) {\n                spbcModal.open().put(result.data);\n                document.addEventListener('spbcModalClosed', function( e ) {\n                    document.location.reload();\n                });\n            } else {\n                spbcModal.open().putError(result.data);\n            }\n        },\n    });\n}\n\n/**\n * Restore file from backup\n * @param obj\n */\nfunction spbc_scanner_button_restore_from_backup_ajax_handler(obj) {\n    const self = jQuery(obj);\n    const fileFastHash = self.parents('.row-actions').attr('uid');\n\n    let data = {\n        action: 'spbc_restore_file_from_backup_ajax_action',\n        file_fast_hash: fileFastHash,\n        security: spbcSettings.ajax_nonce,\n    };\n\n    jQuery.ajax({\n        type: 'POST',\n        async: true,\n        url: spbcSettings.ajaxurl,\n        data: data,\n        success: function(result) {\n            if (result.success) {\n                spbcModal.open().put(result.data);\n                document.addEventListener('spbcModalClosed', function( e ) {\n                    document.location.reload();\n                });\n            } else {\n                spbcModal.open().putError(result.data);\n            }\n        },\n    });\n}\n\n/**\n * Clear scan results\n */\nfunction spbc_scanner_button_clear_scan_results() {\n    if ( ! confirm('Do you confirm to clear the scan results?') ) {\n        return;\n    }\n\n    console.log('CLEAR');\n\n    spbcSendAJAXRequest(\n        {action: 'spbc_scanner_clear'},\n        {\n            type: 'GET',\n            successCallback: function() {\n                document.location = document.location;\n            },\n            complete: null,\n            errorOutput: null,\n            context: this,\n            timeout: 40000,\n            success: function() {\n                document.location.reload();\n            },\n        },\n    );\n}\n\njQuery(document).ready(function() {\n    // EVENT HADLING\n    spbcTblBulkActionsListen(); // Table. Row bulk handler\n    spbcTblRowActionsListen(); // Table. Row actions handler\n    spbcTblPaginationListen(); // Table. Pagination handler\n    spbcTblSortListen(); // Table. Sort handler\n\n    spbcStartShowHide();\n\n    // Preparing progressbar\n    jQuery('#spbc_scaner_progress_bar').progressbar({\n        value: 0,\n        create: function( event, ui ) {\n            event.target.style.position = 'relative';\n            event.target.style.marginBottom = '12px';\n        },\n        change: function(event, ui) {\n            jQuery('.spbc_progressbar_counter span').text(jQuery(event.target).progressbar('option', 'value') + ' %');\n        },\n    });\n\n    // Preparing accordion\n    jQuery('#spbc_scan_accordion').accordion({\n        header: 'h3',\n        heightStyle: 'content',\n        collapsible: true,\n        active: false,\n        activate: function( event, ui ) {\n            if ( ui.oldPanel.length === 0 && ui.oldHeader.length === 0 ) {\n                jQuery('#spbc_scan_accordion').accordion('option', 'classes.ui-accordion-content', 'ui-corner-bottom spbc-overflow--visible');\n            }\n        },\n        beforeActivate: function( event, ui ) {\n            if ( ui.oldPanel.length === 1 && ui.oldHeader.length === 1 ) {\n                jQuery('#spbc_scan_accordion').accordion('option', 'classes.ui-accordion-content', 'ui-corner-bottom');\n            }\n        },\n    });\n\n    // Init scanner plugin\n    window.spbcScanner = new spbcMalwareScanner({\n        settings: spbcScaner.settings,\n        states: spbcScaner.states,\n        button: jQuery('#spbc_perform_scan'),\n        spinner: jQuery('#spbc_perform_scan').next(),\n        callback: null,\n        progress_overall: jQuery('#spbc_scaner_progress_overall'),\n        progressbar: jQuery('#spbc_scaner_progress_bar'),\n        progressbar_text: jQuery('.spbc_progressbar_counter span'),\n        wrapper: document.getElementsByClassName('spbc_unchecked_file_list'),\n        warnings: {\n            long_scan: jQuery('.spbc_hint_warning__long_scan'),\n            outdated: jQuery('.spbc_hint_warning__outdated'),\n        },\n    });\n\n    jQuery(document).on('click', '.spbc_popup_tip--icon---show', function() {\n        spbc_popup_tip___show( jQuery( this ) );\n    });\n\n    jQuery('#spbc_perform_scan').on('click', function() {\n        jQuery('#spbcscan-results-log-module').remove();\n        spbcScanner.actionControl();\n\n        if (!jQuery('.spbc_log-wrapper .panel-body').length) {\n            jQuery('.spbc_log-wrapper').append('<div class=\"panel-body\"></div>');\n        }\n\n        jQuery('.spbc_log-wrapper').resizable({\n            handles: 'n, s',\n            containment: 'document',\n        });\n    });\n\n    jQuery('#spbcscan-results-log-module').resizable({\n        handles: 'n, s',\n        containment: 'document',\n    });\n\n    // Clear scanner's tables\n    jQuery('#spbc_scanner_clear').on('click', function() {\n        if ( ! confirm('Do you confirm to clear the scan results?') ) {\n            return;\n        }\n\n        console.log('CLEAR');\n\n        spbcSendAJAXRequest(\n            {action: 'spbc_scanner_clear'},\n            {\n                type: 'GET',\n                successCallback: function() {\n                    document.location = document.location;\n                },\n                complete: null,\n                errorOutput: null,\n                context: this,\n                timeout: 40000,\n                success: function() {\n                    document.location.reload();\n                },\n            },\n        );\n    });\n\n    jQuery('#spbc_scanner_save_to_pdf').on('click', function() {\n        jQuery.ajax({\n            url: spbcSettings.ajaxurl,\n            type: 'POST',\n            data: {\n                action: 'spbc_scanner_save_to_pdf',\n                security: spbcSettings.ajax_nonce,\n                no_cache: Math.random(),\n            },\n            xhrFields: {\n                responseType: 'blob',\n            },\n            success: function(data) {\n                jQuery.ajax({\n                    url: spbcSettings.ajaxurl,\n                    type: 'POST',\n                    data: {\n                        action: 'spbc_scanner_get_pdf_file_name',\n                        security: spbcSettings.ajax_nonce,\n                        no_cache: Math.random(),\n                    },\n                    xhrFields: {\n                        responseType: 'text',\n                    },\n                    success: function(filename) {\n                        let blob=new Blob([data]);\n                        let link=document.createElement('a');\n                        link.href=window.URL.createObjectURL(blob);\n                        link.download=filename.data;\n                        link.click();\n                    },\n                },\n                );\n            },\n        });\n    });\n\n    // Select snapshot\n    jQuery(document).on('click', '.spbc-fm-snapshot-list [data-spanshot-id]', function() {\n        const currentSnapshotId = jQuery(this).data('spanshot-id');\n        const activeSnapshotId = jQuery('.spbc-fm-snapshot-list [data-spanshot-id].active').data('spanshot-id');\n\n        if (currentSnapshotId === activeSnapshotId) {\n            return;\n        }\n\n        const remodal = jQuery('[data-remodal-id=spbc-file-monitoring-modal]');\n        drawCurrentSnapshot(currentSnapshotId, remodal);\n    });\n});\n"],"names":["spbc_popup_tip___show","show_icon","let","tip_title","attr","tip_text","remove_desc_func","e","jQuery","target","parent","length","hasClass","hide","document","off","after","obj","empty","append","css","top","position","left","on","parents","spbc_scanner_button_file_view_event","self","data","action","file_id","params","spinner","siblings","callback","spbc_scannerButtonView_callback","errorOutput","msg","spbcModal","open","putError","spbcSendAJAXRequest","spbc_scanner_analysis_log_delete_from_log","fileIds","push","selectedItems","closest","find","alert","each","index","element","elementId","val","children","file_ids","window","location","reload","spbc_scanner_button_page_view_event","page_url","wp_wrap","dialog_window","dialog","modal","title","my","at","of","width","show","effect","duration","draggable","resizable","closeText","classes","ui-dialog","event","ui","style","overflow","height","documentElement","beforeClose","body","size_multiplier","result","row","display","file","printf","content_height","Object","keys","visible_height","file_path","console","log","spbc_scanner_button_file_view_bad_event","spbc_scannerButtonViewBadFile_callback","spbc_scanner_button_page_view_bad_event","spbc_scannerButtonViewBad_callback","arguments","severity_keys_sorted","severity","severity_part","row_template","severity_parts","severity_parts_sorted","weak_spots","JSON","parse","key","sort","str_num","header_name","toLowerCase","header_html","header","Set","curr_row","last","remove","afterClose","success","str_nums","concat","bad_strings_map","Map","entries","CRITICAL","get","includes","is_bad_string","unformatted_row","highlited_row","content","close","spbc_scanner_button_file_compare_event","spbc_scannerButtonFileCompare_callback","file_original","difference","indexOf","spbc_scanner__reload_scan_info","text","spbcScaner","look_below_for_scan_res","getElementById","innerText","spbc_scanner_file_monitoring_show_current_snapshot","fileId","file_name","remodal","security","spbcSettings","ajax_nonce","ajax","type","async","url","ajaxurl","drawSnapshotList","drawCurrentSnapshot","id","list","item","created_at","html","snapshot_id","beforeSend","removeClass","addClass","querySelectorAll","forEach","hljs","highlightElement","el","spbc_scanner_button_cure_file_ajax_handler","file_fast_hash","put","addEventListener","spbc_scanner_button_restore_from_backup_ajax_handler","spbc_scanner_button_clear_scan_results","confirm","successCallback","complete","context","this","timeout","ready","spbcTblBulkActionsListen","spbcTblRowActionsListen","spbcTblPaginationListen","spbcTblSortListen","spbcStartShowHide","progressbar","value","create","marginBottom","change","accordion","heightStyle","collapsible","active","activate","oldPanel","oldHeader","beforeActivate","spbcScanner","spbcMalwareScanner","settings","states","button","next","progress_overall","progressbar_text","wrapper","getElementsByClassName","warnings","long_scan","outdated","actionControl","handles","containment","no_cache","Math","random","xhrFields","responseType","filename","blob","Blob","link","createElement","href","URL","createObjectURL","download","click","currentSnapshotId"],"mappings":"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"}