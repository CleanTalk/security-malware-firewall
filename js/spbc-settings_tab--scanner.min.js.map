{"version":3,"file":"spbc-settings_tab--scanner.min.js","sources":["spbc-settings_tab--scanner.js"],"sourcesContent":["function spbc_popup_tip___show(show_icon){\r\n\r\n\tvar tip_title = show_icon.attr('spbc_tip_title') || null;\r\n\tvar\ttip_text  = show_icon.attr('spbc_tip_text')  || null;\r\n\tvar remove_desc_func = function(e){\r\n\r\n\t\tif(\r\n\t\t\ttypeof e === 'undefined' ||\r\n\t\t\t(\r\n\t\t\t\t(jQuery(e.target).parent('.spbc_popup_tip--wrapper').length == 0 || jQuery(e.target).hasClass('spbc_popup_tip--icon---cancel')) &&\r\n\t\t\t\t!jQuery(e.target).hasClass('spbc_popup_tip--icon---show')\r\n\t\t\t)\r\n\t\t){\r\n\t\t\tjQuery('.spbc_popup_tip--wrapper').hide();\r\n\t\t\tjQuery(document).off('click', remove_desc_func);\r\n\t\t}\r\n\t};\r\n\r\n\tremove_desc_func();\r\n\r\n\tshow_icon.after(\"<div class='spbc_popup_tip--wrapper'></div>\");\r\n\r\n\tvar obj = jQuery('.spbc_popup_tip--wrapper');\r\n\r\n\tobj.empty()\r\n\t\t.append(\"<div class='spbc_popup_tip--angle'></div>\")\r\n\t\t.css({\r\n\t\t\ttop: show_icon.position().top - 2,\r\n\t\t\tleft: show_icon.position().left + 25\r\n\t\t});\r\n\tobj.append(\"<i class='spbc_popup_tip--icon---cancel icon-cancel'></i>\")\r\n\t\t.append(\"<h3 class='spbc_popup_tip--title'>\" + tip_title + \"</h3>\")\r\n\t\t.append(\"<p class='spbc_popup_tip--text'>\" + tip_text + \"</p>\");\r\n\r\n\tjQuery(document).on('click', remove_desc_func);\r\n\tshow_icon.parents('tr').on('mouseout', remove_desc_func);\r\n}\r\n\r\nfunction spbc_scanner_button_file_view_event(obj){\r\n\tvar self = jQuery(obj);\r\n\tvar data = {\r\n\t\taction: 'spbc_scanner_file_view',\r\n\t\tfile_id: self.parents('.row-actions').attr('uid'),\r\n\t};\r\n\tvar params = {\r\n\t\tspinner: self.parent().siblings('.tbl-preloader--tiny'),\r\n\t\tcallback: spbc_scannerButtonView_callback,\r\n\t\terrorOutput: function(msg){ spbcModal.open().putError( msg ); },\r\n\t};\r\n\tspbc_sendAJAXRequest(data, params);\r\n}\r\n\r\nfunction spbc_scanner_button_page_view_event(obj){\r\n\tvar self = jQuery(obj);\r\n\tvar data = {\r\n\t\taction: 'spbc_scanner_page_view',\r\n\t\tpage_url: self.parents('.row-actions').attr('uid'),\r\n\t};\r\n\tvar params = {\r\n\t\tspinner: self.parent().siblings('.tbl-preloader--tiny'),\r\n\t\tcallback: spbc_scannerButtonView_callback,\r\n\t\terrorOutput: function(msg){ spbcModal.open().putError( msg ); },\r\n\t};\r\n\r\n\tlet wp_wrap = jQuery('#wpwrap')\r\n\tlet dialog_window = jQuery('#spbc_dialog')\r\n\r\n\tdialog_window.dialog({\r\n\t\tmodal:true,\r\n\t\ttitle: 'Loading..',\r\n\t\tposition: { my: \"center top\", at: \"center top+100px\" , of: window },\r\n\t\twidth: +(wp_wrap.width() / 100 * 90),\r\n\t\tshow: { effect: \"blind\", duration: 500 },\r\n\t\tdraggable: false,\r\n\t\tresizable: false,\r\n\t\tcloseText: \"X\",\r\n\t\tclasses: {\"ui-dialog\": 'spbc---top'},\r\n\t\topen: function(event, ui) {\r\n\t\t\tevent.target.style.overflow = 'auto';\r\n\t\t\tjQuery('#spbc_dialog').height((document.documentElement.clientHeight) / 100 * 25);\r\n\t\t},\r\n\t\tbeforeClose: function(event, ui) {\r\n\t\t\tdocument.body.style.overflow = 'auto';\r\n\t\t\tjQuery('#spbc_dialog').empty();\r\n\t\t},\r\n\t})\r\n\r\n\tdialog_window.append('<img id=\"spbc_file_view_preloader\" alt=\"Wait for downloading\" ' +\r\n\t\t'class=\"spbc_preloader\" ' +\r\n\t\t'src=\"../../wp-content/plugins/security-malware-firewall/images/preloader2.gif\" ' +\r\n\t\t'style=\"' +\r\n\t\t\t'display: block; ' +\r\n\t\t\t'position: absolute; ' +\r\n\t\t'\">')\r\n\r\n\tlet spinner = jQuery('#spbc_file_view_preloader')\r\n\tlet size_multiplier = (wp_wrap.width() * 0.0004)\r\n\r\n\tspinner.height(128 * size_multiplier)\r\n\tspinner.width(128 * size_multiplier)\r\n\tspinner.css({left: dialog_window.width()/2 - (128 * size_multiplier / 2)})\r\n\tspinner.css({top: dialog_window.height()/2 - (128 * size_multiplier / 2)})\r\n\r\n\tspbc_sendAJAXRequest(data, params);\r\n}\r\n\r\nfunction spbc_scannerButtonView_callback(result){\r\n\r\n\tlet dialog_window = jQuery('#spbc_dialog')\r\n\r\n\tjQuery('#spbc_file_view_preloader').css({display:'none'})\r\n\r\n\tdialog_window.dialog({title: ('Loaded: ' + result.file_path)})\r\n\r\n\tlet row_template = '<div class=\"spbc_view_file_row_wrapper\"><span class=\"spbc_view_file_row_num\">%s</span><p class=\"spbc_view_file_row\">%s</p><br /></div>';\r\n\r\n\tfor(let row in result.file){\r\n\t\tdialog_window.append(row_template.printf(row, result.file[row]));\r\n\t}\r\n\r\n\tlet content_height = Object.keys(result.file).length * 19 < 76 ? 76 : Object.keys(result.file).length * 19,\r\n\t\tvisible_height = (document.documentElement.clientHeight) / 100 * 75,\r\n\t\toverflow       = content_height < visible_height ? 'hidden' : 'scroll',\r\n\t\theight         = overflow === 'scroll' ? visible_height : content_height;\r\n\r\n\tdialog_window.css({\r\n\t\theight: height,\r\n\t\toverflow: overflow\r\n\t})\r\n\r\n\tconsole.log('FILE_VIEWED');\r\n}\r\n\r\nfunction spbc_scanner_button_file_view_bad_event(obj){\r\n\tvar self = jQuery(obj);\r\n\tvar data = {\r\n\t\taction: 'spbc_scanner_file_view',\r\n\t\tfile_id: self.parents('.row-actions').attr('uid'),\r\n\t};\r\n\tvar params = {\r\n\t\tspinner: self.parent().siblings('.tbl-preloader--tiny'),\r\n\t\tcallback: spbc_scannerButtonViewBadFile_callback,\r\n\t\terrorOutput: function(msg){ spbcModal.open().putError( msg ); },\r\n\t};\r\n\tspbc_sendAJAXRequest(data, params);\r\n}\r\n\r\nfunction spbc_scanner_button_page_view_bad_event(obj){\r\n\tvar self = jQuery(obj);\r\n\tvar data = {\r\n\t\taction: 'spbc_scanner_page_view',\r\n\t\tpage_url: self.parent().attr('uid'),\r\n\t};\r\n\tvar params = {\r\n\t\tspinner: self.parent().siblings('.tbl-preloader--tiny'),\r\n\t\tcallback: spbc_scannerButtonViewBad_callback,\r\n\t\terrorOutput: function(msg){ spbcModal.open().putError( msg ); },\r\n\t};\r\n\tspbc_sendAJAXRequest(data, params);\r\n}\r\n\r\nfunction spbc_scannerButtonViewBadFile_callback(result, data, params){\r\n\r\n\tconsole.log('FILE_VIEWED_BAD_CODE_FILE');\r\n\tconsole.log(arguments);\r\n\r\n\tvar row_template     = '<div class=\"spbc_view_file_row_wrapper\"><span class=\"spbc_view_file_row_num\">%s</span><p class=\"spbc_view_file_row\">%s</p><br /></div>',\r\n\t\trow_template_bad = '<div class=\"spbc_view_file_row_wrapper\" style=\"background: rgba(200,40,40,0.8);\"><span class=\"spbc_view_file_row_num\">%s</span><p class=\"spbc_view_file_row\">%s</p><br /></div>',\r\n\t\tstr_nums = [];\r\n\r\n\tresult.weak_spots = JSON.parse(result.weak_spots);\r\n\tfor(let severity in result.weak_spots){\r\n\t\tstr_nums = str_nums.concat(Object.keys(result.weak_spots[severity]));\r\n\t}\r\n\tstr_nums = [...new Set(str_nums)].sort(); // Sort bad line\r\n\r\n\tfor(let str_num in str_nums){\r\n\r\n\t\tlet row = +str_nums[str_num],\r\n\t\t\tdisplay_depth = 2;\r\n\r\n\t\t// Display only existing lines of file\r\n\t\tfor(let curr_row = row - display_depth; curr_row <= row + display_depth; curr_row++ ){\r\n\t\t\tif( typeof result.file[curr_row] !== 'undefined' ){\r\n\t\t\t\tjQuery('#spbc_dialog').append((row === curr_row ? row_template_bad : row_template).printf(curr_row, result.file[curr_row]));\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Placing an empty string between results\r\n\t\tjQuery('#spbc_dialog').append(row_template.    printf('', ''));\r\n\t}\r\n\r\n\t // Removing last empty string\r\n\tjQuery('#spbc_dialog div').last().remove();\r\n\r\n\tlet content_height = jQuery('#spbc_dialog div').length * 19 < 76 ? 76 : jQuery('#spbc_dialog div').length * 19,\r\n\t\tvisible_height = (document.documentElement.clientHeight) / 100 * 75,\r\n\t\toverflow       = content_height < visible_height ? 'no_scroll' : 'scroll',\r\n\t\theight         = overflow === 'scroll' ? visible_height : content_height;\r\n\r\n\tjQuery('#spbc_dialog').dialog({\r\n\t\tmodal:true,\r\n\t\ttitle: result.file_path,\r\n\t\tposition: { my: \"center top\", at: \"center top+100px\" , of: window },\r\n\t\twidth: +(jQuery('#wpwrap').width() / 100 * 90),\r\n\t\tshow: { effect: \"blind\", duration: 500 },\r\n\t\tdraggable: true,\r\n\t\tresizable: false,\r\n\t\tcloseText: \"X\",\r\n\t\tclasses: {\"ui-dialog\": 'spbc---top'},\r\n\t\topen: function(event, ui) {\r\n\t\t\tevent.target.style.overflow = overflow;\r\n\t\t\tjQuery('#spbc_dialog').height(height);\r\n\t\t},\r\n\t\tbeforeClose: function(event, ui) {\r\n\t\t\tdocument.body.style.overflow = 'auto';\r\n\t\t\tjQuery('#spbc_dialog').empty();\r\n\t\t},\r\n\t});\r\n}\r\n\r\nfunction spbc_scannerButtonViewBad_callback(result, data, params){\r\n\r\n\tconsole.log('FILE_VIEWED_BAD_CODE');\r\n\r\n\tconsole.log(arguments);\r\n\r\n\tvar row_template     = '<div class=\"spbc_view_file_row_wrapper\">' +\r\n\t\t'<span class=\"spbc_view_file_row_num\">%s</span>' +\r\n\t\t'<p class=\"spbc_view_file_row\" style=\"word-break: break-all\">%s</p>' +\r\n\t\t'<br /></div>',\r\n\t\trow_template_bad = '<div class=\"spbc_view_file_row_wrapper\" style=\"background: rgb(200,120,120);\">' +\r\n\t\t\t'<span class=\"spbc_view_file_row_num\">%s</span>' +\r\n\t\t\t'<p class=\"spbc_view_file_row\" style=\"word-break: break-all\">%s</p>' +\r\n\t\t\t'<br /></div>',\r\n\t\tstr_nums = [];\r\n\r\n\tresult.weak_spots = JSON.parse(result.weak_spots);\r\n\tfor(let severity in result.weak_spots){\r\n\t\tstr_nums = str_nums.concat(Object.keys(result.weak_spots[severity]));\r\n\t}\r\n\r\n\tstr_nums = [...new Set(str_nums)].sort(); // Sort bad line\r\n\t//get a map of bad strings\r\n\tlet bad_strings_map = new Map(Object.entries(result.weak_spots.CRITICAL)) //TODO: Probably there can get something else except CRITICAL in the future\r\n\tfor(let str_num in str_nums){\r\n\r\n\t\tlet row = +str_nums[str_num],\r\n\t\t\tdisplay_depth = 2;\r\n\r\n\t\t// Display only existing lines of file\r\n\t\tfor(let curr_row = row - display_depth; curr_row <= row + display_depth; curr_row++ ){\r\n\t\t\tif( typeof result.file[curr_row] !== 'undefined' ){\r\n\t\t\t\tlet is_bad_string = (row === curr_row)\r\n\t\t\t\tlet unformatted_row\r\n\t\t\t\tlet highlited_row\r\n\t\t\t\tif (is_bad_string){\r\n\t\t\t\t\tunformatted_row = row_template_bad\r\n\t\t\t\t} else {\r\n\t\t\t\t\tunformatted_row = row_template\r\n\t\t\t\t}\r\n\t\t\t\tif (is_bad_string){\r\n\t\t\t\t\thighlited_row = unformatted_row.printf(curr_row, bad_strings_map.get(str_nums[str_num]));\r\n\t\t\t\t} else {\r\n\t\t\t\t\thighlited_row = unformatted_row.printf(curr_row, result.file[curr_row]);\r\n\t\t\t\t}\r\n\t\t\t\tjQuery('#spbc_dialog').append(highlited_row);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Placing an empty string between results\r\n\t\tjQuery('#spbc_dialog').append(row_template.    printf('', ''));\r\n\t}\r\n\r\n\t // Removing last empty string\r\n\tjQuery('#spbc_dialog div').last().remove();\r\n\r\n\tlet content_height = jQuery('#spbc_dialog div').length * 19 < 76 ? 76 : jQuery('#spbc_dialog div').length * 19,\r\n\t\tvisible_height = (document.documentElement.clientHeight) / 100 * 75,\r\n\t\theight         = 'auto',\r\n   \t\toverflow       = content_height < visible_height ? 'no_scroll' : 'scroll';\r\n\r\n\tjQuery('#spbc_dialog').dialog({\r\n\t\tmodal:true, \r\n\t\ttitle: result.file_path,\r\n\t\tposition: { my: \"center top\", at: \"center top+100px\" , of: window },\r\n\t\twidth: +(jQuery('#wpwrap').width() / 100 * 90),\r\n\t\tshow: { effect: \"blind\", duration: 500 },\r\n\t\tdraggable: true,\r\n\t\tresizable: false,\r\n\t\tcloseText: \"X\",\r\n\t\tclasses: {\"ui-dialog\": 'spbc---top'},\r\n\t\topen: function(event, ui) {\r\n\t\t\tevent.target.style.overflow = overflow;\r\n\t\t\tjQuery('#spbc_dialog').height(height);\r\n\t\t},\r\n\t\tbeforeClose: function(event, ui) {\r\n\t\t\tdocument.body.style.overflow = 'auto';\r\n\t\t\tjQuery('#spbc_dialog').empty();\r\n\t\t},\r\n\t});\r\n}\r\n\r\nfunction spbc_scanner_button_file_compare_event(obj){\r\n\tvar self = jQuery(obj);\r\n\tvar data = {\r\n\t\taction: 'spbc_scanner_file_compare',\r\n\t\tfile_id: self.parents('.row-actions').attr('uid'),\r\n\t};\r\n\tvar params = {\r\n\t\tspinner: self.parent().siblings('.tbl-preloader--tiny'),\r\n\t\tcallback: spbc_scannerButtonFileCompare_callback,\r\n\t\terrorOutput: function(msg){ spbcModal.open().putError( msg ); },\r\n\t};\r\n\tspbc_sendAJAXRequest(data, params);\r\n}\r\n\r\nfunction spbc_scannerButtonFileCompare_callback(result, data, params){\r\n\r\n\tconsole.log('FILE_COMPARED');\r\n\r\n\tlet row_template = '<div class=\"spbc_compare_file_row_wrapper\"><p class=\"spbc_compare_file_row\">%s</p><span class=\"spbc_compare_file_row_num\">%s</span><p class=\"spbc_compare_file_row\">%s</p><br /></div>';\r\n\tlet row_template_bad = '<div class=\"spbc_compare_file_row_wrapper\" style=\"background: rgba(200,40,40,0.8);\"><p class=\"spbc_compare_file_row\">%s</p><span class=\"spbc_compare_file_row_num\">%s</span><p class=\"spbc_compare_file_row\">%s</p><br /></div>';\r\n\r\n\tjQuery('#spbc_dialog').append(row_template.printf('<span class=\"spbc_compare_file_headings\">Modified</span>', 'Line', '<span class=\"spbc_compare_file_headings\">Original</span>'));\r\n\r\n\tfor(var row=1, prev = false, next = false; typeof result.file[row] != 'undefined' || typeof result.file_original[row] != 'undefined'; row++){\r\n\r\n\t\tif(typeof result.file[row] == 'undefined')          result.file[row] = '';\r\n\t\tif(typeof result.file_original[row] == 'undefined') result.file_original[row] = '';\r\n\r\n\t\t// Display only existing lines of file\r\n\t\tif(result.difference.indexOf(row) != -1){\r\n\t\t\tfor(let display_depth = 2, curr_row = row - display_depth; curr_row <= row + display_depth; curr_row++ ){\r\n\t\t\t\tif( typeof result.file[curr_row] !== 'undefined' && typeof result.file_original[row] !== 'undefined') {\r\n\t\t\t\t\tjQuery('#spbc_dialog').append(\r\n\t\t\t\t\t\t(row === curr_row ? row_template_bad : row_template).printf(\r\n\t\t\t\t\t\t\tresult.file[curr_row] ? result.file[curr_row] : '',\r\n\t\t\t\t\t\t\tcurr_row,\r\n\t\t\t\t\t\t\tresult.file_original[curr_row] ? result.file_original[curr_row] : ''\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tjQuery('#spbc_dialog').append(row_template.    printf('', '', ''));\r\n\t\t}\r\n\t}\r\n\t\r\n\tvar content_height = jQuery('#spbc_dialog div').length * 19 + 19,\r\n\t\tvisible_height = (document.documentElement.clientHeight) / 100 * 75,\r\n\t\toverflow = content_height < visible_height ? 'no_scroll' : 'scroll',\r\n\t\theight = overflow === 'scroll' ? visible_height : content_height;\r\n\r\n\tjQuery('#spbc_dialog').dialog({\r\n\t\tmodal:true, \r\n\t\ttitle: result.file_path,\r\n\t\tposition: { my: \"center top\", at: \"center top+100px\" , of: window },\r\n\t\twidth: +(jQuery('#wpwrap').width() / 100 * 90),\r\n\t\theight: height,\r\n\t\tshow: { effect: \"blind\", duration: 500 },\r\n\t\tdraggable: true,\r\n\t\tresizable: true,\r\n\t\tcloseText: \"X\",\r\n\t\tclasses: {\"ui-dialog\": 'spbc---top'},\r\n\t\topen: function(event, ui) {\r\n\t\t\tdocument.body.style.overflow = 'hidden';\r\n\t\t\tevent.target.style.overflow = overflow;\r\n\t\t\tjQuery('#spbc_dialog').height(height);\r\n\t\t},\r\n\t\tbeforeClose: function(event, ui) {\r\n\t\t\tdocument.body.style.overflow = 'auto';\r\n\t\t\tjQuery('#spbc_dialog').empty();\r\n\t\t}\r\n\t});\r\n}\r\n\r\njQuery(document).ready(function(){\r\n\r\n\t// EVENT HADLING\r\n\tspbc_tbl__bulk_actions__listen(); // Table. Row bulk handler\r\n\tspbc_tbl__row_actions__listen();  // Table. Row actions handler\r\n\tspbc_tbl__pagination__listen();   // Table. Pagination handler\r\n\tspbc_tbl__sort__listen();         // Table. Sort handler\r\n\t\r\n\tspbcStartShowHide();\r\n\r\n\t// Preparing progressbar\r\n\tjQuery('#spbc_scaner_progress_bar').progressbar({\r\n\t\tvalue: 0,\r\n\t\tcreate: function( event, ui ) {\r\n\t\t\tevent.target.style.position = 'relative';\r\n\t\t\tevent.target.style.marginBottom = '12px';\r\n\t\t},\r\n\t\tchange: function(event, ui){\r\n\t\t\tjQuery('.spbc_progressbar_counter span').text(jQuery(event.target).progressbar('option', 'value') + ' %');\r\n\t\t},\r\n\t});\r\n\t\r\n\t// Preparing accordion\r\n\tjQuery('#spbc_scan_accordion').accordion({\r\n\t\theader: \"h3\",\r\n\t\theightStyle: 'content',\r\n\t\tcollapsible: true,\r\n\t\tactive: false,\r\n\t\tactivate: function( event, ui ) {\r\n\t\t\tif( ui.oldPanel.length === 0 && ui.oldHeader.length === 0 )\r\n\t\t\t\tjQuery(\"#spbc_scan_accordion\").accordion(\"option\", \"classes.ui-accordion-content\", \"ui-corner-bottom spbc-overflow--visible\");\r\n\t\t},\r\n\t\tbeforeActivate: function( event, ui ) {\r\n\t\t\tif( ui.oldPanel.length === 1 && ui.oldHeader.length === 1 )\r\n\t\t\t\tjQuery(\"#spbc_scan_accordion\").accordion(\"option\", \"classes.ui-accordion-content\", \"ui-corner-bottom\");\r\n\t\t}\r\n\t});\r\n\r\n\t// Init scanner plugin\r\n\twindow.spbc_scanner = new spbcMalwareScanner({\r\n\t\tsettings: spbcScaner.settings,\r\n\t\tstates: spbcScaner.states,\r\n\t\tbutton: jQuery('#spbc_perform_scan'),\r\n\t\tspinner: jQuery('#spbc_perform_scan').next(),\r\n\t\tcallback: null,\r\n\t\tprogress_overall: jQuery('#spbc_scaner_progress_overall'),\r\n\t\tprogressbar: jQuery('#spbc_scaner_progress_bar'),\r\n\t\tprogressbar_text: jQuery('.spbc_progressbar_counter span'),\r\n\t\twrapper: document.getElementsByClassName('spbc_unchecked_file_list'),\r\n\t\twarnings: {\r\n\t\t    long_scan: jQuery('.spbc_hint_warning__long_scan'),\r\n            outdated:  jQuery('.spbc_hint_warning__outdated')\r\n        }\r\n\t});\r\n\r\n\tjQuery(document).on('click', '.spbc_popup_tip--icon---show', function(){\r\n\t\tspbc_popup_tip___show( jQuery( this ) );\r\n\t});\r\n\r\n\tjQuery('#spbc_perform_scan').on('click', function(){\r\n\t\tspbc_scanner.actionControl();\r\n\t});\r\n\r\n\t//DEBUG\r\n\t// Clear table\r\n\tjQuery('#spbc_scanner_clear').on('click', function(){\r\n\r\n\t\tif( ! confirm('Do you wanna clear the table with file scan results?') )\r\n\t\t\treturn;\r\n\r\n\t\tconsole.log('CLEAR');\r\n\r\n\t\tspbc_sendAJAXRequest(\r\n\t\t\t{ action: 'spbc_scanner_clear', },\r\n\t\t\t{\r\n\t\t\t\ttype: 'GET',\r\n\t\t\t\tsuccessCallback: function(){ document.location = document.location },\r\n\t\t\t\tcomplete: null,\r\n\t\t\t\terrorOutput: null,\r\n\t\t\t\tcontext: this,\r\n\t\t\t\ttimeout: 40000\r\n\t\t\t},\r\n\t\t);\r\n\t});\r\n\r\n});"],"names":["spbc_popup_tip___show","show_icon","tip_title","attr","tip_text","remove_desc_func","e","jQuery","target","parent","length","hasClass","hide","document","off","after","obj","empty","append","css","top","position","left","on","parents","spbc_scanner_button_file_view_event","self","data","action","file_id","params","spinner","siblings","callback","spbc_scannerButtonView_callback","errorOutput","msg","spbcModal","open","putError","spbc_sendAJAXRequest","spbc_scanner_button_page_view_event","page_url","wp_wrap","dialog_window","dialog","modal","title","my","at","of","window","width","show","effect","duration","draggable","resizable","closeText","classes","ui-dialog","event","ui","style","overflow","height","documentElement","beforeClose","body","size_multiplier","result","display","file_path","row","file","printf","content_height","Object","keys","visible_height","console","log","spbc_scanner_button_file_view_bad_event","spbc_scannerButtonViewBadFile_callback","spbc_scanner_button_page_view_bad_event","spbc_scannerButtonViewBad_callback","arguments","severity","str_num","row_template","str_nums","weak_spots","JSON","parse","concat","Set","sort","curr_row","last","remove","bad_strings_map","Map","entries","CRITICAL","is_bad_string","unformatted_row","highlited_row","get","spbc_scanner_button_file_compare_event","spbc_scannerButtonFileCompare_callback","file_original","difference","indexOf","ready","spbc_tbl__bulk_actions__listen","spbc_tbl__row_actions__listen","spbc_tbl__pagination__listen","spbc_tbl__sort__listen","spbcStartShowHide","progressbar","value","create","marginBottom","change","text","accordion","header","heightStyle","collapsible","active","activate","oldPanel","oldHeader","beforeActivate","spbc_scanner","spbcMalwareScanner","settings","spbcScaner","states","button","next","progress_overall","progressbar_text","wrapper","getElementsByClassName","warnings","long_scan","outdated","this","actionControl","confirm","type","successCallback","location","complete","context","timeout"],"mappings":"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"}