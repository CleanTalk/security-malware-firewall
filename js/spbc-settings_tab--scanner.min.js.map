{"version":3,"file":"spbc-settings_tab--scanner.min.js","sources":["spbc-settings_tab--scanner.js"],"sourcesContent":["function spbc_popup_tip___show(show_icon){\n\n\tvar tip_title = show_icon.attr('spbc_tip_title') || null;\n\tvar\ttip_text  = show_icon.attr('spbc_tip_text')  || null;\n\tvar remove_desc_func = function(e){\n\n\t\tif(\n\t\t\ttypeof e === 'undefined' ||\n\t\t\t(\n\t\t\t\t(jQuery(e.target).parent('.spbc_popup_tip--wrapper').length == 0 || jQuery(e.target).hasClass('spbc_popup_tip--icon---cancel')) &&\n\t\t\t\t!jQuery(e.target).hasClass('spbc_popup_tip--icon---show')\n\t\t\t)\n\t\t){\n\t\t\tjQuery('.spbc_popup_tip--wrapper').hide();\n\t\t\tjQuery(document).off('click', remove_desc_func);\n\t\t}\n\t};\n\n\tremove_desc_func();\n\n\tshow_icon.after(\"<div class='spbc_popup_tip--wrapper'></div>\");\n\n\tvar obj = jQuery('.spbc_popup_tip--wrapper');\n\n\tobj.empty()\n\t\t.append(\"<div class='spbc_popup_tip--angle'></div>\")\n\t\t.css({\n\t\t\ttop: show_icon.position().top - 2,\n\t\t\tleft: show_icon.position().left + 25\n\t\t});\n\tobj.append(\"<i class='spbc_popup_tip--icon---cancel icon-cancel'></i>\")\n\t\t.append(\"<h3 class='spbc_popup_tip--title'>\" + tip_title + \"</h3>\")\n\t\t.append(\"<p class='spbc_popup_tip--text'>\" + tip_text + \"</p>\");\n\n\tjQuery(document).on('click', remove_desc_func);\n\tshow_icon.parents('tr').on('mouseout', remove_desc_func);\n}\n\nfunction spbc_scanner_button_file_view_event(obj){\n\tvar self = jQuery(obj);\n\tvar data = {\n\t\taction: 'spbc_scanner_file_view',\n\t\tfile_id: self.parents('.row-actions').attr('uid'),\n\t};\n\tvar params = {\n\t\tspinner: self.parent().siblings('.tbl-preloader--tiny'),\n\t\tcallback: spbc_scannerButtonView_callback,\n\t\terrorOutput: function(msg){ spbcModal.open().putError( msg ); },\n\t};\n\tspbc_sendAJAXRequest(data, params);\n}\n\n/**\n * Delete file from analysis log\n */\nfunction spbc_scanner_analysis_log_delete_from_log(obj) {\n\tconst self = jQuery(obj);\n\tconst data = {\n\t\taction: 'spbc_scanner_analysis_log_delete_from_log',\n\t\tfile_id: self.parents('.row-actions').attr('uid'),\n\t};\n\tvar params = {\n\t\tspinner: self.parent().siblings('.tbl-preloader--tiny'),\n\t\tcallback: window.location.reload(),\n\t\terrorOutput: function(msg){ spbcModal.open().putError( msg ); },\n\t};\n\tspbc_sendAJAXRequest(data, params);\n}\n\nfunction spbc_scanner_button_page_view_event(obj){\n\tvar self = jQuery(obj);\n\tvar data = {\n\t\taction: 'spbc_scanner_page_view',\n\t\tpage_url: self.parents('.row-actions').attr('uid'),\n\t};\n\tvar params = {\n\t\tspinner: self.parent().siblings('.tbl-preloader--tiny'),\n\t\tcallback: spbc_scannerButtonView_callback,\n\t\terrorOutput: function(msg){ spbcModal.open().putError( msg ); },\n\t};\n\n\tlet wp_wrap = jQuery('#wpwrap')\n\tlet dialog_window = jQuery('#spbc_dialog')\n\n\tdialog_window.dialog({\n\t\tmodal:true,\n\t\ttitle: 'Loading..',\n\t\tposition: { my: \"center top\", at: \"center top+100px\" , of: window },\n\t\twidth: +(wp_wrap.width() / 100 * 90),\n\t\tshow: { effect: \"blind\", duration: 500 },\n\t\tdraggable: false,\n\t\tresizable: false,\n\t\tcloseText: \"X\",\n\t\tclasses: {\"ui-dialog\": 'spbc---top'},\n\t\topen: function(event, ui) {\n\t\t\tevent.target.style.overflow = 'auto';\n\t\t\tjQuery('#spbc_dialog').height((document.documentElement.clientHeight) / 100 * 25);\n\t\t},\n\t\tbeforeClose: function(event, ui) {\n\t\t\tdocument.body.style.overflow = 'auto';\n\t\t\tjQuery('#spbc_dialog').empty();\n\t\t},\n\t})\n\n\tdialog_window.append('<img id=\"spbc_file_view_preloader\" alt=\"Wait for downloading\" ' +\n\t\t'class=\"spbc_preloader\" ' +\n\t\t'src=\"../../wp-content/plugins/security-malware-firewall/images/preloader2.gif\" ' +\n\t\t'style=\"' +\n\t\t'display: block; ' +\n\t\t'position: absolute; ' +\n\t\t'\">')\n\n\tlet spinner = jQuery('#spbc_file_view_preloader')\n\tlet size_multiplier = (wp_wrap.width() * 0.0004)\n\n\tspinner.height(128 * size_multiplier)\n\tspinner.width(128 * size_multiplier)\n\tspinner.css({left: dialog_window.width()/2 - (128 * size_multiplier / 2)})\n\tspinner.css({top: dialog_window.height()/2 - (128 * size_multiplier / 2)})\n\n\tspbc_sendAJAXRequest(data, params);\n}\n\nfunction spbc_scannerButtonView_callback(result){\n\n\tlet dialog_window = jQuery('#spbc_dialog')\n\tdialog_window.empty();\n\n\tjQuery('#spbc_file_view_preloader').css({display:'none'})\n\n\tlet row_template = '<div class=\"spbc_view_file_row_wrapper\"><span class=\"spbc_view_file_row_num\">%s</span><p class=\"spbc_view_file_row\">%s</p><br /></div>';\n\n\tfor(let row in result.file){\n\t\tdialog_window.append(row_template.printf(row, result.file[row]));\n\t}\n\n\tlet content_height = Object.keys(result.file).length * 19 < 76 ? 76 : Object.keys(result.file).length * 19,\n\t\tvisible_height = (document.documentElement.clientHeight) / 100 * 75,\n\t\toverflow       = content_height < visible_height ? 'hidden' : 'scroll',\n\t\theight         = overflow === 'scroll' ? visible_height : content_height;\n\n\tdialog_window.css({\n\t\theight: height,\n\t\toverflow: overflow\n\t})\n\n\tdialog_window.dialog({\n\t\tmodal:true,\n\t\ttitle: ('Loaded: ' + result.file_path),\n\t\tposition: { my: \"center top\", at: \"center top+100px\" , of: window },\n\t\twidth: +(jQuery('#wpwrap').width() / 100 * 90),\n\t\tshow: { effect: \"blind\", duration: 500 },\n\t\tdraggable: true,\n\t\tresizable: false,\n\t\tcloseText: \"X\",\n\t\tclasses: {\"ui-dialog\": 'spbc---top'},\n\t\topen: function(event, ui) {\n\t\t\tevent.target.style.overflow = overflow;\n\t\t\tjQuery('#spbc_dialog').height(height);\n\t\t\tjQuery('.ui-widget-overlay').on('click', function() {\n\t\t\t\tjQuery(\"#spbc_dialog\").dialog('close');\n\t\t\t});\n\t\t},\n\t\tbeforeClose: function(event, ui) {\n\t\t\tdocument.body.style.overflow = 'auto';\n\t\t\tjQuery('#spbc_dialog').empty();\n\t\t},\n\t});\n\n\tconsole.log('FILE_VIEWED');\n\n}\n\nfunction spbc_scanner_button_file_view_bad_event(obj){\n\tvar self = jQuery(obj);\n\tvar data = {\n\t\taction: 'spbc_scanner_file_view',\n\t\tfile_id: self.parents('.row-actions').attr('uid'),\n\t};\n\tvar params = {\n\t\tspinner: self.parent().siblings('.tbl-preloader--tiny'),\n\t\tcallback: spbc_scannerButtonViewBadFile_callback,\n\t\terrorOutput: function(msg){ spbcModal.open().putError( msg ); },\n\t};\n\tspbc_sendAJAXRequest(data, params);\n}\n\nfunction spbc_scanner_button_page_view_bad_event(obj){\n\tvar self = jQuery(obj);\n\tvar data = {\n\t\taction: 'spbc_scanner_page_view',\n\t\tpage_url: self.parent().attr('uid'),\n\t};\n\tvar params = {\n\t\tspinner: self.parent().siblings('.tbl-preloader--tiny'),\n\t\tcallback: spbc_scannerButtonViewBad_callback,\n\t\terrorOutput: function(msg){ spbcModal.open().putError( msg ); },\n\t};\n\tspbc_sendAJAXRequest(data, params);\n}\n\nfunction spbc_scannerButtonViewBadFile_callback(result, data, params){\n\n\tconsole.log('FILE_VIEWED_BAD_CODE_FILE');\n\tconsole.log(arguments);\n\tjQuery('#spbc_dialog').empty();\n\n\tvar row_template     = '<div class=\"spbc_view_file_row_wrapper\"><span class=\"spbc_view_file_row_num\">%s</span><p class=\"spbc_view_file_row\">%s</p><br /></div>',\n\t\trow_template_bad = '<div class=\"spbc_view_file_row_wrapper\" style=\"background: rgba(200,40,40,0.8);\"><span class=\"spbc_view_file_row_num\">%s</span><p class=\"spbc_view_file_row\">%s</p><br /></div>',\n\t\tstr_nums = [];\n\n\tresult.weak_spots = JSON.parse(result.weak_spots);\n\tfor(let severity in result.weak_spots){\n\t\tstr_nums = str_nums.concat(Object.keys(result.weak_spots[severity]));\n\t}\n\tstr_nums = [...new Set(str_nums)].sort(); // Sort bad line\n\n\tfor(let str_num in str_nums){\n\n\t\tlet row = +str_nums[str_num],\n\t\t\tdisplay_depth = 2;\n\n\t\t// Display only existing lines of file\n\t\tfor(let curr_row = row - display_depth; curr_row <= row + display_depth; curr_row++ ){\n\t\t\tif( typeof result.file[curr_row] !== 'undefined' ){\n\t\t\t\tjQuery('#spbc_dialog').append((row === curr_row ? row_template_bad : row_template).printf(curr_row, result.file[curr_row]));\n\t\t\t}\n\t\t}\n\n\t\t// Placing an empty string between results\n\t\tjQuery('#spbc_dialog').append(row_template.    printf('', ''));\n\n\t}\n\n\t// Removing last empty string\n\tjQuery('#spbc_dialog div').last().remove();\n\n\tlet content_height = jQuery('#spbc_dialog div').length * 19 < 76 ? 76 : jQuery('#spbc_dialog div').length * 19,\n\t\tvisible_height = (document.documentElement.clientHeight) / 100 * 75,\n\t\toverflow       = content_height < visible_height ? 'no_scroll' : 'scroll',\n\t\theight         = overflow === 'scroll' ? visible_height : content_height;\n\n\tjQuery('#spbc_dialog').dialog({\n\t\tmodal:true,\n\t\ttitle: result.file_path,\n\t\tposition: { my: \"center top\", at: \"center top+100px\" , of: window },\n\t\twidth: +(jQuery('#wpwrap').width() / 100 * 90),\n\t\tshow: { effect: \"blind\", duration: 500 },\n\t\tdraggable: true,\n\t\tresizable: false,\n\t\tcloseText: \"X\",\n\t\tclasses: {\"ui-dialog\": 'spbc---top'},\n\t\topen: function(event, ui) {\n\t\t\tevent.target.style.overflow = overflow;\n\t\t\tjQuery('#spbc_dialog').height(height);\n\t\t\tjQuery('.ui-widget-overlay').on('click', function() {\n\t\t\t\tjQuery(\"#spbc_dialog\").dialog('close');\n\t\t\t});\n\t\t},\n\t\tbeforeClose: function(event, ui) {\n\t\t\tdocument.body.style.overflow = 'auto';\n\t\t\tjQuery('#spbc_dialog').empty();\n\t\t},\n\t});\n}\n\nfunction spbc_scannerButtonViewBad_callback(result, data, params){\n\n\tconsole.log('FILE_VIEWED_BAD_CODE');\n\n\tconsole.log(arguments);\n\n\tlet afterClose = () => {};\n\n\tif ( result.success == true ) {\n\t\tconsole.log(result);\n\t\tvar row_template     = '<div class=\"spbc_view_file_row_wrapper\">' +\n\t\t\t\t'<span class=\"spbc_view_file_row_num\">%s</span>' +\n\t\t\t\t'<p class=\"spbc_view_file_row\" style=\"word-break: break-all\">%s</p>' +\n\t\t\t\t'<br /></div>',\n\t\t\trow_template_bad = '<div class=\"spbc_view_file_row_wrapper\" style=\"background: rgb(200,120,120);\">' +\n\t\t\t\t'<span class=\"spbc_view_file_row_num\">%s</span>' +\n\t\t\t\t'<p class=\"spbc_view_file_row\" style=\"word-break: break-all\">%s</p>' +\n\t\t\t\t'<br /></div>',\n\t\t\tstr_nums = [];\n\n\t\tresult.weak_spots = JSON.parse(result.weak_spots);\n\t\tfor(let severity in result.weak_spots){\n\t\t\tstr_nums = str_nums.concat(Object.keys(result.weak_spots[severity]));\n\t\t}\n\n\t\tstr_nums = [...new Set(str_nums)].sort(); // Sort bad line\n\t\t//get a map of bad strings\n\t\tlet bad_strings_map = new Map(Object.entries(result.weak_spots.CRITICAL)) //TODO: Probably there can get something else except CRITICAL in the future\n\t\tfor(let str_num in str_nums){\n\n\t\t\tlet row = +str_nums[str_num],\n\t\t\t\tdisplay_depth = 2;\n\n\t\t\t// Display only existing lines of file\n\t\t\tfor(let curr_row = row - display_depth; curr_row <= row + display_depth; curr_row++ ){\n\t\t\t\tif( typeof result.file[curr_row] !== 'undefined' ){\n\t\t\t\t\tlet is_bad_string = (row === curr_row)\n\t\t\t\t\tlet unformatted_row\n\t\t\t\t\tlet highlited_row\n\t\t\t\t\tif (is_bad_string){\n\t\t\t\t\t\tunformatted_row = row_template_bad\n\t\t\t\t\t} else {\n\t\t\t\t\t\tunformatted_row = row_template\n\t\t\t\t\t}\n\t\t\t\t\tif (is_bad_string){\n\t\t\t\t\t\thighlited_row = unformatted_row.printf(curr_row, bad_strings_map.get(str_nums[str_num]));\n\t\t\t\t\t} else {\n\t\t\t\t\t\thighlited_row = unformatted_row.printf(curr_row, result.file[curr_row]);\n\t\t\t\t\t}\n\t\t\t\t\tjQuery('#spbc_dialog').append(highlited_row);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Placing an empty string between results\n\t\t\tjQuery('#spbc_dialog').append(row_template.    printf('', ''));\n\n\t\t\t// Removing last empty string\n\t\t\tjQuery('#spbc_dialog div').last().remove();\n\t\t}\n\t} else {\n\t\tlet wrapperElement = '<div style=\"margin:40px;text-align:center;\">%s</div>'\n\t\tjQuery('#spbc_dialog').append(wrapperElement.printf(result.content));\n\t\tafterClose = () => {document.location.reload();};\n\t}\n\n\tlet content_height = jQuery('#spbc_dialog div').length * 19 < 76 ? 76 : jQuery('#spbc_dialog div').length * 19,\n\t\tvisible_height = (document.documentElement.clientHeight) / 100 * 75,\n\t\theight         = 'auto',\n\t\toverflow       = content_height < visible_height ? 'no_scroll' : 'scroll';\n\n\tjQuery('#spbc_dialog').dialog({\n\t\tmodal:true,\n\t\ttitle: result.file_path,\n\t\tposition: { my: \"center top\", at: \"center top+100px\" , of: window },\n\t\twidth: +(jQuery('#wpwrap').width() / 100 * 90),\n\t\tshow: { effect: \"blind\", duration: 500 },\n\t\tdraggable: true,\n\t\tresizable: false,\n\t\tcloseText: \"X\",\n\t\tclasses: {\"ui-dialog\": 'spbc---top'},\n\t\topen: function(event, ui) {\n\t\t\tevent.target.style.overflow = overflow;\n\t\t\tjQuery('#spbc_dialog').height(height);\n\t\t\tjQuery('.ui-widget-overlay').on('click', function() {\n\t\t\t\tjQuery(\"#spbc_dialog\").dialog('close');\n\t\t\t});\n\t\t},\n\t\tbeforeClose: function(event, ui) {\n\t\t\tdocument.body.style.overflow = 'auto';\n\t\t\tjQuery('#spbc_dialog').empty();\n\t\t},\n\t\tclose: afterClose,\n\t});\n}\n\nfunction spbc_scanner_button_file_compare_event(obj){\n\tvar self = jQuery(obj);\n\tvar data = {\n\t\taction: 'spbc_scanner_file_compare',\n\t\tfile_id: self.parents('.row-actions').attr('uid'),\n\t};\n\tvar params = {\n\t\tspinner: self.parent().siblings('.tbl-preloader--tiny'),\n\t\tcallback: spbc_scannerButtonFileCompare_callback,\n\t\terrorOutput: function(msg){ spbcModal.open().putError( msg ); },\n\t};\n\tspbc_sendAJAXRequest(data, params);\n}\n\nfunction spbc_scannerButtonFileCompare_callback(result, data, params){\n\n\tconsole.log('FILE_COMPARED');\n\n\tlet row_template = '<div class=\"spbc_compare_file_row_wrapper\"><p class=\"spbc_compare_file_row\">%s</p><span class=\"spbc_compare_file_row_num\">%s</span><p class=\"spbc_compare_file_row\">%s</p><br /></div>';\n\tlet row_template_bad = '<div class=\"spbc_compare_file_row_wrapper\" style=\"background: rgba(200,40,40,0.8);\"><p class=\"spbc_compare_file_row\">%s</p><span class=\"spbc_compare_file_row_num\">%s</span><p class=\"spbc_compare_file_row\">%s</p><br /></div>';\n\n\tjQuery('#spbc_dialog').append(row_template.printf('<span class=\"spbc_compare_file_headings\">Modified</span>', 'Line', '<span class=\"spbc_compare_file_headings\">Original</span>'));\n\n\tfor(var row=1, prev = false, next = false; typeof result.file[row] != 'undefined' || typeof result.file_original[row] != 'undefined'; row++){\n\n\t\tif(typeof result.file[row] == 'undefined')          result.file[row] = '';\n\t\tif(typeof result.file_original[row] == 'undefined') result.file_original[row] = '';\n\n\t\t// Display only existing lines of file\n\t\tif(result.difference.indexOf(row) != -1){\n\t\t\tfor(let display_depth = 2, curr_row = row - display_depth; curr_row <= row + display_depth; curr_row++ ){\n\t\t\t\tif( typeof result.file[curr_row] !== 'undefined' && typeof result.file_original[row] !== 'undefined') {\n\t\t\t\t\tjQuery('#spbc_dialog').append(\n\t\t\t\t\t\t(row === curr_row ? row_template_bad : row_template).printf(\n\t\t\t\t\t\t\tresult.file[curr_row] ? result.file[curr_row] : '',\n\t\t\t\t\t\t\tcurr_row,\n\t\t\t\t\t\t\tresult.file_original[curr_row] ? result.file_original[curr_row] : ''\n\t\t\t\t\t\t)\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t\tjQuery('#spbc_dialog').append(row_template.    printf('', '', ''));\n\t\t}\n\t}\n\n\tvar content_height = jQuery('#spbc_dialog div').length * 19 + 19,\n\t\tvisible_height = (document.documentElement.clientHeight) / 100 * 75,\n\t\toverflow = content_height < visible_height ? 'no_scroll' : 'scroll',\n\t\theight = overflow === 'scroll' ? visible_height : content_height;\n\n\tjQuery('#spbc_dialog').dialog({\n\t\tmodal:true,\n\t\ttitle: result.file_path,\n\t\tposition: { my: \"center top\", at: \"center top+100px\" , of: window },\n\t\twidth: +(jQuery('#wpwrap').width() / 100 * 90),\n\t\theight: height,\n\t\tshow: { effect: \"blind\", duration: 500 },\n\t\tdraggable: true,\n\t\tresizable: true,\n\t\tcloseText: \"X\",\n\t\tclasses: {\"ui-dialog\": 'spbc---top'},\n\t\topen: function(event, ui) {\n\t\t\tdocument.body.style.overflow = 'hidden';\n\t\t\tevent.target.style.overflow = overflow;\n\t\t\tjQuery('#spbc_dialog').height(height);\n\t\t},\n\t\tbeforeClose: function(event, ui) {\n\t\t\tdocument.body.style.overflow = 'auto';\n\t\t\tjQuery('#spbc_dialog').empty();\n\t\t}\n\t});\n}\n\nfunction spbc_scanner__reload_scan_info() {\n\tjQuery('.spbc_hint__last_scan_title').text(spbcScaner.look_below_for_scan_res);\n\tconst data = {\n\t\taction: 'spbc_scanner__last_scan_info'\n\t};\n\tconst params = {\n\t\tcallback: (result) => {\n\t\t\tdocument.getElementById('spbc_scanner__last_scan_info').innerText = result.data;\n\t\t}\n\t};\n\tspbc_sendAJAXRequest(data, params);\n}\n\n/**\n * Show snapshots of file\n * @param obj\n */\nfunction spbc_scanner_file_monitoring_show_current_snapshot(obj)\n{\n\tconst self = jQuery(obj);\n\tconst fileId = self.parents('.row-actions').attr('uid');\n\tconst file_name = self.closest('.column-path').find('.title').text();\n\n\t// Init and open remodal\n\tconst remodal = jQuery('[data-remodal-id=spbc-file-monitoring-modal]');\n\tconst remodalObject = remodal.remodal();\n\tremodalObject.open();\n\n\t// Ajax request to get data for slider\n\tlet data = {\n\t\taction: 'spbc_file_monitoring_show_snapshots',\n\t\tfile_id: fileId,\n\t\tsecurity: spbcSettings.ajax_nonce\n\t};\n\n\tjQuery.ajax({\n\t\ttype: \"POST\",\n\t\tasync: true,\n\t\turl: spbcSettings.ajaxurl,\n\t\tdata: data,\n\t\tsuccess: function(result) {\n\t\t\tif (result.success) {\n\t\t\t\tremodal.find('#spbc-fm-snapshot-list ul').remove();\n\t\t\t\tremodal.find('#spbc-fm-snapshot-file-name').text(file_name);\n\t\t\t\tdrawSnapshotList(result.data, remodal);\n\t\t\t\tdrawCurrentSnapshot(result.data[0].id, remodal);\n\t\t\t} else {\n\t\t\t\t// TODO: show errors\n\t\t\t}\n\t\t},\n\t});\n}\n\n/**\n *\n * @param data\n * @param remodal\n */\nfunction drawSnapshotList(data, remodal)\n{\n\tlet list = '';\n\n\tfor (let item of data) {\n\t\tlist += `<li data-spanshot-id=\"${item.id}\">${item.created_at}</li>`;\n\t}\n\n\tlet html =\n\t\t`<ul>\n            ${list}\n        </ul>`;\n\n\tremodal.find('#spbc-fm-snapshot-list').append(html);\n}\n\nfunction drawCurrentSnapshot(snapshot_id, remodal)\n{\n\t// Ajax request to get data for slider\n\tlet data = {\n\t\taction: 'spbc_file_monitoring_show_current_snapshot',\n\t\tsnapshot_id,\n\t\tsecurity: spbcSettings.ajax_nonce\n\t};\n\n\tjQuery.ajax({\n\t\ttype: \"POST\",\n\t\tasync: true,\n\t\turl: spbcSettings.ajaxurl,\n\t\tdata: data,\n\t\tbeforeSend: function() {\n\t\t\tjQuery('#spbc-file-monitoring-modal-preloader').show();\n\t\t},\n\t\tsuccess: function(result) {\n\t\t\tif (result.success) {\n\t\t\t\tremodal.find('#spbc-fm-snapshot-view .wrap').remove();\n\t\t\t\tremodal.find('[data-spanshot-id').removeClass('active');\n\t\t\t\tremodal.find('[data-spanshot-id=' + snapshot_id + ']').addClass('active');\n\n\t\t\t\tlet html =\n\t\t\t\t\t`<div class=\"wrap\">\n                        <pre>\n                            <code>\n                                ${result.data.content}\n                            </code>\n                        </pre>\n                    </div>`;\n\n\t\t\t\tjQuery('#spbc-file-monitoring-modal-preloader').hide();\n\t\t\t\tremodal.find('#spbc-fm-snapshot-view').append(html);\n\t\t\t\tdocument.querySelectorAll('pre code').forEach((el) => {\n\t\t\t\t\thljs.highlightElement(el);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\t// TODO: show errors\n\t\t\t}\n\t\t},\n\t});\n}\n\n/**\n * Cure file\n * @param obj\n */\nfunction spbc_scanner_button_cure_file_ajax_handler(obj)\n{\n\tconst self = jQuery(obj);\n\tconst fileFastHash = self.parents('.row-actions').attr('uid');\n\n\tlet data = {\n\t\taction: 'spbc_file_cure_ajax_action',\n\t\tfile_fast_hash: fileFastHash,\n\t\tsecurity: spbcSettings.ajax_nonce\n\t};\n\n\tjQuery.ajax({\n\t\ttype: \"POST\",\n\t\tasync: true,\n\t\turl: spbcSettings.ajaxurl,\n\t\tdata: data,\n\t\tsuccess: function(result) {\n\t\t\tif (result.success) {\n\t\t\t\tspbcModal.open().put(result.data);\n\t\t\t\tdocument.addEventListener(\"spbcModalClosed\", function( e ) {\n\t\t\t\t\tdocument.location.reload();\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tspbcModal.open().putError(result.data);\n\t\t\t}\n\t\t},\n\t});\n}\n\n/**\n * Restore file from backup\n * @param obj\n */\nfunction spbc_scanner_button_restore_from_backup_ajax_handler(obj)\n{\n\tconst self = jQuery(obj);\n\tconst fileFastHash = self.parents('.row-actions').attr('uid');\n\n\tlet data = {\n\t\taction: 'spbc_restore_file_from_backup_ajax_action',\n\t\tfile_fast_hash: fileFastHash,\n\t\tsecurity: spbcSettings.ajax_nonce\n\t};\n\n\tjQuery.ajax({\n\t\ttype: \"POST\",\n\t\tasync: true,\n\t\turl: spbcSettings.ajaxurl,\n\t\tdata: data,\n\t\tsuccess: function(result) {\n\t\t\tif (result.success) {\n\t\t\t\tspbcModal.open().put(result.data);\n\t\t\t\tdocument.addEventListener(\"spbcModalClosed\", function( e ) {\n\t\t\t\t\tdocument.location.reload();\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tspbcModal.open().putError(result.data);\n\t\t\t}\n\t\t},\n\t});\n}\n\n/**\n * Manual frontend malware sending handler\n *\n * @param url\n */\nfunction spbc_scanner__frontend_malware_send_button(url)\n{\n\tjQuery('#spbc_scanner__frontend_malware_send_button').prop('disabled', true);\n\tconst data = {\n\t\taction: 'spbc_scanner_page_send',\n\t\tid: url.href\n\t};\n\n\tconst params = {\n\t\tcallback: (result) => {\n\t\t\tjQuery('#spbc_scanner__frontend_malware_send_url').val('')\n\t\t\tspbc_scanner__frontend_malware_send_error(result.data);\n\t\t\tjQuery('#spbc_scanner__frontend_malware_send_button').prop('disabled', false);\n\t\t}\n\t};\n\n\tspbc_sendAJAXRequest(data, params);\n}\n\nfunction spbc_scanner__frontend_malware_send_error(text)\n{\n\tjQuery('#spbc_scanner__frontend_malware_send_result').text(text);\n\tsetTimeout(function () {\n\t\tjQuery('#spbc_scanner__frontend_malware_send_result').text('');\n\t}, 3000);\n}\n\njQuery(document).ready(function(){\n\n\t// EVENT HADLING\n\tspbc_tbl__bulk_actions__listen(); // Table. Row bulk handler\n\tspbc_tbl__row_actions__listen();  // Table. Row actions handler\n\tspbc_tbl__pagination__listen();   // Table. Pagination handler\n\tspbc_tbl__sort__listen();         // Table. Sort handler\n\n\tspbcStartShowHide();\n\n\t// Preparing progressbar\n\tjQuery('#spbc_scaner_progress_bar').progressbar({\n\t\tvalue: 0,\n\t\tcreate: function( event, ui ) {\n\t\t\tevent.target.style.position = 'relative';\n\t\t\tevent.target.style.marginBottom = '12px';\n\t\t},\n\t\tchange: function(event, ui){\n\t\t\tjQuery('.spbc_progressbar_counter span').text(jQuery(event.target).progressbar('option', 'value') + ' %');\n\t\t},\n\t});\n\n\t// Preparing accordion\n\tjQuery('#spbc_scan_accordion').accordion({\n\t\theader: \"h3\",\n\t\theightStyle: 'content',\n\t\tcollapsible: true,\n\t\tactive: false,\n\t\tactivate: function( event, ui ) {\n\t\t\tif( ui.oldPanel.length === 0 && ui.oldHeader.length === 0 )\n\t\t\t\tjQuery(\"#spbc_scan_accordion\").accordion(\"option\", \"classes.ui-accordion-content\", \"ui-corner-bottom spbc-overflow--visible\");\n\t\t},\n\t\tbeforeActivate: function( event, ui ) {\n\t\t\tif( ui.oldPanel.length === 1 && ui.oldHeader.length === 1 )\n\t\t\t\tjQuery(\"#spbc_scan_accordion\").accordion(\"option\", \"classes.ui-accordion-content\", \"ui-corner-bottom\");\n\t\t}\n\t});\n\n\t// Init scanner plugin\n\twindow.spbc_scanner = new spbcMalwareScanner({\n\t\tsettings: spbcScaner.settings,\n\t\tstates: spbcScaner.states,\n\t\tbutton: jQuery('#spbc_perform_scan'),\n\t\tspinner: jQuery('#spbc_perform_scan').next(),\n\t\tcallback: null,\n\t\tprogress_overall: jQuery('#spbc_scaner_progress_overall'),\n\t\tprogressbar: jQuery('#spbc_scaner_progress_bar'),\n\t\tprogressbar_text: jQuery('.spbc_progressbar_counter span'),\n\t\twrapper: document.getElementsByClassName('spbc_unchecked_file_list'),\n\t\twarnings: {\n\t\t\tlong_scan: jQuery('.spbc_hint_warning__long_scan'),\n\t\t\toutdated:  jQuery('.spbc_hint_warning__outdated')\n\t\t}\n\t});\n\n\tjQuery(document).on('click', '.spbc_popup_tip--icon---show', function(){\n\t\tspbc_popup_tip___show( jQuery( this ) );\n\t});\n\n\tjQuery('#spbc_perform_scan').on('click', function(){\n\t\tjQuery('#spbcscan-results-log-module').remove();\n\t\tspbc_scanner.actionControl();\n\n\t\tif (!jQuery(\".spbc_log-wrapper .panel-body\").length) {\n\t\t\tjQuery(\".spbc_log-wrapper\").append('<div class=\"panel-body\"></div>');\n\t\t}\n\n\t\tjQuery(\".spbc_log-wrapper\").resizable({\n\t\t\thandles: 'n, s',\n\t\t\tcontainment: 'document',\n\t\t});\n\t});\n\n\tjQuery(\"#spbcscan-results-log-module\").resizable({\n\t\thandles: 'n, s',\n\t\tcontainment: 'document',\n\t});\n\n\t//DEBUG\n\t// Clear table\n\tjQuery('#spbc_scanner_clear').on('click', function(){\n\n\t\tif( ! confirm('Do you wanna clear the table with file scan results?') )\n\t\t\treturn;\n\n\t\tconsole.log('CLEAR');\n\n\t\tspbc_sendAJAXRequest(\n\t\t\t{ action: 'spbc_scanner_clear', },\n\t\t\t{\n\t\t\t\ttype: 'GET',\n\t\t\t\tsuccessCallback: function(){ document.location = document.location },\n\t\t\t\tcomplete: null,\n\t\t\t\terrorOutput: null,\n\t\t\t\tcontext: this,\n\t\t\t\ttimeout: 40000\n\t\t\t},\n\t\t);\n\t});\n\n\tjQuery('#spbc_scanner_save_to_pdf').on('click', function(){\n\t\tjQuery.ajax({\n\t\t\turl: spbcSettings.ajaxurl,\n\t\t\ttype: 'POST',\n\t\t\tdata: {\n\t\t\t\taction: 'spbc_scanner_save_to_pdf',\n\t\t\t\tsecurity: spbcSettings.ajax_nonce,\n\t\t\t\tno_cache: Math.random()\n\t\t\t},\n\t\t\txhrFields: {\n\t\t\t\tresponseType: 'blob'\n\t\t\t},\n\t\t\tsuccess: function(data) {\n\t\t\t\tjQuery.ajax({\n\t\t\t\t\t\turl: spbcSettings.ajaxurl,\n\t\t\t\t\t\ttype: 'POST',\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\taction: 'spbc_scanner_get_pdf_file_name',\n\t\t\t\t\t\t\tsecurity: spbcSettings.ajax_nonce,\n\t\t\t\t\t\t\tno_cache: Math.random()\n\t\t\t\t\t\t},\n\t\t\t\t\t\txhrFields: {\n\t\t\t\t\t\t\tresponseType: 'text'\n\t\t\t\t\t\t},\n\t\t\t\t\t\tsuccess: function(filename) {\n\t\t\t\t\t\t\tlet blob=new Blob([data]);\n\t\t\t\t\t\t\tlet link=document.createElement('a');\n\t\t\t\t\t\t\tlink.href=window.URL.createObjectURL(blob);\n\t\t\t\t\t\t\tlink.download=filename.data;\n\t\t\t\t\t\t\tlink.click();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t}\n\t\t});\n\t});\n\n\t// Select snapshot\n\tjQuery(document).on('click', '.spbc-fm-snapshot-list [data-spanshot-id]', function() {\n\t\tconst currentSnapshotId = jQuery(this).data('spanshot-id');\n\t\tconst activeSnapshotId = jQuery('.spbc-fm-snapshot-list [data-spanshot-id].active').data('spanshot-id');\n\n\t\tif (currentSnapshotId === activeSnapshotId) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst remodal = jQuery('[data-remodal-id=spbc-file-monitoring-modal]');\n\t\tdrawCurrentSnapshot(currentSnapshotId, remodal)\n\t});\n\n\t/**\n\t * Sending frontend malware for analyzing handler\n\t */\n\tjQuery('#spbc_scanner__frontend_malware_send_button').on('click', function(e){\n\t\te.preventDefault();\n\t\tconst maybeUrl = jQuery('#spbc_scanner__frontend_malware_send_url').val();\n\t\ttry {\n\t\t\tconst url = new URL(maybeUrl);\n\t\t\treturn spbc_scanner__frontend_malware_send_button(url);\n\t\t} catch (err) {\n\t\t\tconst error = 'Provided URL is invalid';\n\t\t\treturn spbc_scanner__frontend_malware_send_error(error);\n\t\t}\n\t});\n});"],"names":["spbc_popup_tip___show","show_icon","remove_desc_func","e","jQuery","target","parent","length","hasClass","hide","document","off","tip_title","attr","tip_text","obj","after","empty","append","css","top","position","left","on","parents","spbc_scanner_button_file_view_event","self","data","action","file_id","params","spinner","siblings","callback","spbc_scannerButtonView_callback","errorOutput","msg","spbcModal","open","putError","spbc_sendAJAXRequest","spbc_scanner_analysis_log_delete_from_log","window","location","reload","spbc_scanner_button_page_view_event","page_url","wp_wrap","dialog_window","dialog","modal","title","my","at","of","width","show","effect","duration","draggable","resizable","closeText","classes","ui-dialog","event","ui","style","overflow","height","documentElement","beforeClose","body","size_multiplier","result","let","row","display","file","printf","content_height","Object","keys","visible_height","file_path","console","log","spbc_scanner_button_file_view_bad_event","spbc_scannerButtonViewBadFile_callback","spbc_scanner_button_page_view_bad_event","spbc_scannerButtonViewBad_callback","arguments","severity","str_num","row_template","str_nums","weak_spots","JSON","parse","concat","Set","sort","curr_row","last","remove","afterClose","success","bad_strings_map","Map","entries","CRITICAL","is_bad_string","unformatted_row","highlited_row","get","content","close","spbc_scanner_button_file_compare_event","spbc_scannerButtonFileCompare_callback","file_original","difference","indexOf","spbc_scanner__reload_scan_info","text","spbcScaner","look_below_for_scan_res","getElementById","innerText","spbc_scanner_file_monitoring_show_current_snapshot","fileId","file_name","closest","find","remodal","security","spbcSettings","ajax_nonce","ajax","type","async","url","ajaxurl","drawSnapshotList","drawCurrentSnapshot","id","list","item","created_at","html","snapshot_id","beforeSend","removeClass","addClass","querySelectorAll","forEach","hljs","highlightElement","el","spbc_scanner_button_cure_file_ajax_handler","file_fast_hash","put","addEventListener","spbc_scanner_button_restore_from_backup_ajax_handler","spbc_scanner__frontend_malware_send_button","prop","href","val","spbc_scanner__frontend_malware_send_error","setTimeout","ready","spbc_tbl__bulk_actions__listen","spbc_tbl__row_actions__listen","spbc_tbl__pagination__listen","spbc_tbl__sort__listen","spbcStartShowHide","progressbar","value","create","marginBottom","change","accordion","header","heightStyle","collapsible","active","activate","oldPanel","oldHeader","beforeActivate","spbc_scanner","spbcMalwareScanner","settings","states","button","next","progress_overall","progressbar_text","wrapper","getElementsByClassName","warnings","long_scan","outdated","this","actionControl","handles","containment","confirm","successCallback","complete","context","timeout","no_cache","Math","random","xhrFields","responseType","filename","blob","Blob","link","createElement","URL","createObjectURL","download","click","currentSnapshotId","preventDefault","maybeUrl","err"],"mappings":"AAAA,SAASA,sBAAsBC,GAIP,SAAnBC,EAA4BC,GAGjB,KAAA,IAANA,IAEyD,GAA9DC,OAAOD,EAAEE,MAAM,EAAEC,OAAO,0BAA0B,EAAEC,QAAeH,CAAAA,OAAOD,EAAEE,MAAM,EAAEG,SAAS,+BAA+B,GAC5HJ,OAAOD,EAAEE,MAAM,EAAEG,SAAS,6BAA6B,KAGzDJ,OAAO,0BAA0B,EAAEK,KAAK,EACxCL,OAAOM,QAAQ,EAAEC,IAAI,QAAST,CAAgB,EAEhD,CAdA,IAAIU,EAAYX,EAAUY,KAAK,gBAAgB,GAAK,KAChDC,EAAYb,EAAUY,KAAK,eAAe,GAAM,KAmBhDE,GAJJb,EAAiB,EAEjBD,EAAUe,MAAM,6CAA6C,EAEnDZ,OAAO,0BAA0B,GAE3CW,EAAIE,MAAM,EACRC,OAAO,2CAA2C,EAClDC,IAAI,CACJC,IAAKnB,EAAUoB,SAAS,EAAED,IAAM,EAChCE,KAAMrB,EAAUoB,SAAS,EAAEC,KAAO,EACnC,CAAC,EACFP,EAAIG,OAAO,2DAA2D,EACpEA,OAAO,qCAAuCN,EAAY,OAAO,EACjEM,OAAO,mCAAqCJ,EAAW,MAAM,EAE/DV,OAAOM,QAAQ,EAAEa,GAAG,QAASrB,CAAgB,EAC7CD,EAAUuB,QAAQ,IAAI,EAAED,GAAG,WAAYrB,CAAgB,CACxD,CAEA,SAASuB,oCAAoCV,GAC5C,IAAIW,EAAOtB,OAAOW,CAAG,EACjBY,EAAO,CACVC,OAAQ,yBACRC,QAASH,EAAKF,QAAQ,cAAc,EAAEX,KAAK,KAAK,CACjD,EACIiB,EAAS,CACZC,QAASL,EAAKpB,OAAO,EAAE0B,SAAS,sBAAsB,EACtDC,SAAUC,gCACVC,YAAa,SAASC,GAAMC,UAAUC,KAAK,EAAEC,SAAUH,CAAI,CAAG,CAC/D,EACAI,qBAAqBb,EAAMG,CAAM,CAClC,CAKA,SAASW,0CAA0C1B,GAClD,IAAMW,EAAOtB,OAAOW,CAAG,EACjBY,EAAO,CACZC,OAAQ,4CACRC,QAASH,EAAKF,QAAQ,cAAc,EAAEX,KAAK,KAAK,CACjD,EACIiB,EAAS,CACZC,QAASL,EAAKpB,OAAO,EAAE0B,SAAS,sBAAsB,EACtDC,SAAUS,OAAOC,SAASC,OAAO,EACjCT,YAAa,SAASC,GAAMC,UAAUC,KAAK,EAAEC,SAAUH,CAAI,CAAG,CAC/D,EACAI,qBAAqBb,EAAMG,CAAM,CAClC,CAEA,SAASe,oCAAoC9B,GAC5C,IAAIW,EAAOtB,OAAOW,CAAG,EACjBY,EAAO,CACVC,OAAQ,yBACRkB,SAAUpB,EAAKF,QAAQ,cAAc,EAAEX,KAAK,KAAK,CAClD,EACIiB,EAAS,CACZC,QAASL,EAAKpB,OAAO,EAAE0B,SAAS,sBAAsB,EACtDC,SAAUC,gCACVC,YAAa,SAASC,GAAMC,UAAUC,KAAK,EAAEC,SAAUH,CAAI,CAAG,CAC/D,EAEIW,EAAU3C,OAAO,SAAS,EAC1B4C,EAAgB5C,OAAO,cAAc,EA8BrC2B,GA5BJiB,EAAcC,OAAO,CACpBC,MAAM,CAAA,EACNC,MAAO,YACP9B,SAAU,CAAE+B,GAAI,aAAcC,GAAI,mBAAqBC,GAAIZ,MAAO,EAClEa,MAASR,EAAQQ,MAAM,EAAI,IAAM,GACjCC,KAAM,CAAEC,OAAQ,QAASC,SAAU,GAAI,EACvCC,UAAW,CAAA,EACXC,UAAW,CAAA,EACXC,UAAW,IACXC,QAAS,CAACC,YAAa,YAAY,EACnCzB,KAAM,SAAS0B,EAAOC,GACrBD,EAAM3D,OAAO6D,MAAMC,SAAW,OAC9B/D,OAAO,cAAc,EAAEgE,OAAQ1D,SAAS2D,gBAA4B,aAAI,IAAM,EAAE,CACjF,EACAC,YAAa,SAASN,EAAOC,GAC5BvD,SAAS6D,KAAKL,MAAMC,SAAW,OAC/B/D,OAAO,cAAc,EAAEa,MAAM,CAC9B,CACD,CAAC,EAED+B,EAAc9B,OAAO,mNAMhB,EAESd,OAAO,2BAA2B,GAC5CoE,EAAqC,KAAlBzB,EAAQQ,MAAM,EAErCxB,EAAQqC,OAAO,IAAMI,CAAe,EACpCzC,EAAQwB,MAAM,IAAMiB,CAAe,EACnCzC,EAAQZ,IAAI,CAACG,KAAM0B,EAAcO,MAAM,EAAE,EAAK,IAAMiB,EAAkB,CAAE,CAAC,EACzEzC,EAAQZ,IAAI,CAACC,IAAK4B,EAAcoB,OAAO,EAAE,EAAK,IAAMI,EAAkB,CAAE,CAAC,EAEzEhC,qBAAqBb,EAAMG,CAAM,CAClC,CAEA,SAASI,gCAAgCuC,GAExCC,IAOQC,EAPJ3B,EAAgB5C,OAAO,cAAc,EACzC4C,EAAc/B,MAAM,EAEpBb,OAAO,2BAA2B,EAAEe,IAAI,CAACyD,QAAQ,MAAM,CAAC,EAIxD,IAAQD,KAAOF,EAAOI,KACrB7B,EAAc9B,OAHI,yIAGgB4D,OAAOH,EAAKF,EAAOI,KAAKF,EAAI,CAAC,EAGhED,IAAIK,EAAmD,GAAlCC,OAAOC,KAAKR,EAAOI,IAAI,EAAEtE,OAAc,GAAK,GAAuC,GAAlCyE,OAAOC,KAAKR,EAAOI,IAAI,EAAEtE,OAC9F2E,EAAkBxE,SAAS2D,gBAA4B,aAAI,IAAM,GACjEF,EAAiBY,EAAiBG,EAAiB,SAAW,SAC9Dd,EAA8B,UAAbD,EAAwBe,EAAiBH,EAE3D/B,EAAc7B,IAAI,CACjBiD,OAAQA,EACRD,SAAUA,CACX,CAAC,EAEDnB,EAAcC,OAAO,CACpBC,MAAM,CAAA,EACNC,MAAQ,WAAasB,EAAOU,UAC5B9D,SAAU,CAAE+B,GAAI,aAAcC,GAAI,mBAAqBC,GAAIZ,MAAO,EAClEa,MAASnD,OAAO,SAAS,EAAEmD,MAAM,EAAI,IAAM,GAC3CC,KAAM,CAAEC,OAAQ,QAASC,SAAU,GAAI,EACvCC,UAAW,CAAA,EACXC,UAAW,CAAA,EACXC,UAAW,IACXC,QAAS,CAACC,YAAa,YAAY,EACnCzB,KAAM,SAAS0B,EAAOC,GACrBD,EAAM3D,OAAO6D,MAAMC,SAAWA,EAC9B/D,OAAO,cAAc,EAAEgE,OAAOA,CAAM,EACpChE,OAAO,oBAAoB,EAAEmB,GAAG,QAAS,WACxCnB,OAAO,cAAc,EAAE6C,OAAO,OAAO,CACtC,CAAC,CACF,EACAqB,YAAa,SAASN,EAAOC,GAC5BvD,SAAS6D,KAAKL,MAAMC,SAAW,OAC/B/D,OAAO,cAAc,EAAEa,MAAM,CAC9B,CACD,CAAC,EAEDmE,QAAQC,IAAI,aAAa,CAE1B,CAEA,SAASC,wCAAwCvE,GAChD,IAAIW,EAAOtB,OAAOW,CAAG,EACjBY,EAAO,CACVC,OAAQ,yBACRC,QAASH,EAAKF,QAAQ,cAAc,EAAEX,KAAK,KAAK,CACjD,EACIiB,EAAS,CACZC,QAASL,EAAKpB,OAAO,EAAE0B,SAAS,sBAAsB,EACtDC,SAAUsD,uCACVpD,YAAa,SAASC,GAAMC,UAAUC,KAAK,EAAEC,SAAUH,CAAI,CAAG,CAC/D,EACAI,qBAAqBb,EAAMG,CAAM,CAClC,CAEA,SAAS0D,wCAAwCzE,GAChD,IAAIW,EAAOtB,OAAOW,CAAG,EACjBY,EAAO,CACVC,OAAQ,yBACRkB,SAAUpB,EAAKpB,OAAO,EAAEO,KAAK,KAAK,CACnC,EACIiB,EAAS,CACZC,QAASL,EAAKpB,OAAO,EAAE0B,SAAS,sBAAsB,EACtDC,SAAUwD,mCACVtD,YAAa,SAASC,GAAMC,UAAUC,KAAK,EAAEC,SAAUH,CAAI,CAAG,CAC/D,EACAI,qBAAqBb,EAAMG,CAAM,CAClC,CAEA,SAASyD,uCAAuCd,EAAQ9C,EAAMG,GAE7DsD,QAAQC,IAAI,2BAA2B,EACvCD,QAAQC,IAAIK,SAAS,EACrBtF,OAAO,cAAc,EAAEa,MAAM,EAE7B,IAKQ0E,EAKAC,EAVJC,EAAmB,yIAEtBC,EAAW,GAGZ,IAAQH,KADRlB,EAAOsB,WAAaC,KAAKC,MAAMxB,EAAOsB,UAAU,EAC5BtB,EAAOsB,WAC1BD,EAAWA,EAASI,OAAOlB,OAAOC,KAAKR,EAAOsB,WAAWJ,EAAS,CAAC,EAIpE,IAAQC,KAFRE,EAAW,CAAC,GAAG,IAAIK,IAAIL,CAAQ,GAAGM,KAAK,EAEX,CAE3B1B,IAAIC,EAAM,CAACmB,EAASF,GAIpB,IAAIlB,IAAI2B,EAAW1B,EAHF,EAGuB0B,GAHvB,EAGmC1B,EAAqB0B,CAAQ,GAC3C,KAAA,IAA1B5B,EAAOI,KAAKwB,IACtBjG,OAAO,cAAc,EAAEc,QAAQyD,IAAQ0B,EAjBtB,kLAiBoDR,GAAcf,OAAOuB,EAAU5B,EAAOI,KAAKwB,EAAS,CAAC,EAK5HjG,OAAO,cAAc,EAAEc,OAAO2E,EAAiBf,OAAO,GAAI,EAAE,CAAC,CAE9D,CAGA1E,OAAO,kBAAkB,EAAEkG,KAAK,EAAEC,OAAO,EAEzC7B,IAAIK,EAAqD,GAApC3E,OAAO,kBAAkB,EAAEG,OAAc,GAAK,GAAyC,GAApCH,OAAO,kBAAkB,EAAEG,OAClG2E,EAAkBxE,SAAS2D,gBAA4B,aAAI,IAAM,GACjEF,EAAiBY,EAAiBG,EAAiB,YAAc,SACjEd,EAA8B,UAAbD,EAAwBe,EAAiBH,EAE3D3E,OAAO,cAAc,EAAE6C,OAAO,CAC7BC,MAAM,CAAA,EACNC,MAAOsB,EAAOU,UACd9D,SAAU,CAAE+B,GAAI,aAAcC,GAAI,mBAAqBC,GAAIZ,MAAO,EAClEa,MAASnD,OAAO,SAAS,EAAEmD,MAAM,EAAI,IAAM,GAC3CC,KAAM,CAAEC,OAAQ,QAASC,SAAU,GAAI,EACvCC,UAAW,CAAA,EACXC,UAAW,CAAA,EACXC,UAAW,IACXC,QAAS,CAACC,YAAa,YAAY,EACnCzB,KAAM,SAAS0B,EAAOC,GACrBD,EAAM3D,OAAO6D,MAAMC,SAAWA,EAC9B/D,OAAO,cAAc,EAAEgE,OAAOA,CAAM,EACpChE,OAAO,oBAAoB,EAAEmB,GAAG,QAAS,WACxCnB,OAAO,cAAc,EAAE6C,OAAO,OAAO,CACtC,CAAC,CACF,EACAqB,YAAa,SAASN,EAAOC,GAC5BvD,SAAS6D,KAAKL,MAAMC,SAAW,OAC/B/D,OAAO,cAAc,EAAEa,MAAM,CAC9B,CACD,CAAC,CACF,CAEA,SAASwE,mCAAmChB,EAAQ9C,EAAMG,GAEzDsD,QAAQC,IAAI,sBAAsB,EAElCD,QAAQC,IAAIK,SAAS,EAErBhB,IAAI8B,EAAa,OAEjB,GAAuB,GAAlB/B,EAAOgC,QAAkB,CAC7BrB,QAAQC,IAAIZ,CAAM,EAClB,IAWQkB,EAXJE,EAAmB,uKAQtBC,EAAW,GAGZ,IAAQH,KADRlB,EAAOsB,WAAaC,KAAKC,MAAMxB,EAAOsB,UAAU,EAC5BtB,EAAOsB,WAC1BD,EAAWA,EAASI,OAAOlB,OAAOC,KAAKR,EAAOsB,WAAWJ,EAAS,CAAC,EAKpEjB,IACQkB,EAHRE,EAAW,CAAC,GAAG,IAAIK,IAAIL,CAAQ,GAAGM,KAAK,EAEnCM,EAAkB,IAAIC,IAAI3B,OAAO4B,QAAQnC,EAAOsB,WAAWc,QAAQ,CAAC,EACxE,IAAQjB,KAAWE,EAAS,CAE3BpB,IAAIC,EAAM,CAACmB,EAASF,GAIpB,IAAIlB,IAAI2B,EAAW1B,EAHF,EAGuB0B,GAHvB,EAGmC1B,EAAqB0B,CAAQ,GAChF,GAAqC,KAAA,IAA1B5B,EAAOI,KAAKwB,GAA2B,CACjD3B,IAAIoC,EAAiBnC,IAAQ0B,EAC7B3B,IAAIqC,EACAC,EAEHD,EADGD,EAzBa,6MA4BEjB,EAGlBmB,EADGF,EACaC,EAAgBjC,OAAOuB,EAAUK,EAAgBO,IAAInB,EAASF,EAAQ,CAAC,EAEvEmB,EAAgBjC,OAAOuB,EAAU5B,EAAOI,KAAKwB,EAAS,EAEvEjG,OAAO,cAAc,EAAEc,OAAO8F,CAAa,CAC5C,CAID5G,OAAO,cAAc,EAAEc,OAAO2E,EAAiBf,OAAO,GAAI,EAAE,CAAC,EAG7D1E,OAAO,kBAAkB,EAAEkG,KAAK,EAAEC,OAAO,CAC1C,CACD,MAECnG,OAAO,cAAc,EAAEc,OADF,uDACwB4D,OAAOL,EAAOyC,OAAO,CAAC,EACnEV,EAAa,KAAO9F,SAASiC,SAASC,OAAO,CAAE,EAGhD8B,IAAIK,EAAqD,GAApC3E,OAAO,kBAAkB,EAAEG,OAAc,GAAK,GAAyC,GAApCH,OAAO,kBAAkB,EAAEG,OAClG2E,EAAkBxE,SAAS2D,gBAA4B,aAAI,IAAM,GAEjEF,EAAiBY,EAAiBG,EAAiB,YAAc,SAElE9E,OAAO,cAAc,EAAE6C,OAAO,CAC7BC,MAAM,CAAA,EACNC,MAAOsB,EAAOU,UACd9D,SAAU,CAAE+B,GAAI,aAAcC,GAAI,mBAAqBC,GAAIZ,MAAO,EAClEa,MAASnD,OAAO,SAAS,EAAEmD,MAAM,EAAI,IAAM,GAC3CC,KAAM,CAAEC,OAAQ,QAASC,SAAU,GAAI,EACvCC,UAAW,CAAA,EACXC,UAAW,CAAA,EACXC,UAAW,IACXC,QAAS,CAACC,YAAa,YAAY,EACnCzB,KAAM,SAAS0B,EAAOC,GACrBD,EAAM3D,OAAO6D,MAAMC,SAAWA,EAC9B/D,OAAO,cAAc,EAAEgE,OAfP,MAeoB,EACpChE,OAAO,oBAAoB,EAAEmB,GAAG,QAAS,WACxCnB,OAAO,cAAc,EAAE6C,OAAO,OAAO,CACtC,CAAC,CACF,EACAqB,YAAa,SAASN,EAAOC,GAC5BvD,SAAS6D,KAAKL,MAAMC,SAAW,OAC/B/D,OAAO,cAAc,EAAEa,MAAM,CAC9B,EACAkG,MAAOX,CACR,CAAC,CACF,CAEA,SAASY,uCAAuCrG,GAC/C,IAAIW,EAAOtB,OAAOW,CAAG,EACjBY,EAAO,CACVC,OAAQ,4BACRC,QAASH,EAAKF,QAAQ,cAAc,EAAEX,KAAK,KAAK,CACjD,EACIiB,EAAS,CACZC,QAASL,EAAKpB,OAAO,EAAE0B,SAAS,sBAAsB,EACtDC,SAAUoF,uCACVlF,YAAa,SAASC,GAAMC,UAAUC,KAAK,EAAEC,SAAUH,CAAI,CAAG,CAC/D,EACAI,qBAAqBb,EAAMG,CAAM,CAClC,CAEA,SAASuF,uCAAuC5C,EAAQ9C,EAAMG,GAE7DsD,QAAQC,IAAI,eAAe,EAE3BX,IAAImB,EAAe,yLAGnBzF,OAAO,cAAc,EAAEc,OAAO2E,EAAaf,OAAO,2DAA4D,OAAQ,0DAA0D,CAAC,EAEjL,IAAI,IAAIH,EAAI,EAA0D,KAAA,IAApBF,EAAOI,KAAKF,IAA2D,KAAA,IAA7BF,EAAO6C,cAAc3C,GAAqBA,CAAG,GAMxI,GAJ8B,KAAA,IAApBF,EAAOI,KAAKF,KAA8BF,EAAOI,KAAKF,GAAO,IAChC,KAAA,IAA7BF,EAAO6C,cAAc3C,KAAqBF,EAAO6C,cAAc3C,GAAO,IAG3C,CAAC,GAAnCF,EAAO8C,WAAWC,QAAQ7C,CAAG,EAAQ,CACvC,IAAID,IAAuB2B,EAAW1B,EAAd,EAAmC0B,GAAY1B,EAA/C,EAAoE0B,CAAQ,GAC9D,KAAA,IAA1B5B,EAAOI,KAAKwB,IAAkE,KAAA,IAA9B5B,EAAO6C,cAAc3C,IAC/EvE,OAAO,cAAc,EAAEc,QACrByD,IAAQ0B,EAdS,kOAcqBR,GAAcf,OACpDL,EAAOI,KAAKwB,IAAoC,GAChDA,EACA5B,EAAO6C,cAAcjB,IAA6C,EACnE,CACD,EAGFjG,OAAO,cAAc,EAAEc,OAAO2E,EAAiBf,OAAO,GAAI,GAAI,EAAE,CAAC,CAClE,CAGD,IAAIC,EAAqD,GAApC3E,OAAO,kBAAkB,EAAEG,OAAc,GAC7D2E,EAAkBxE,SAAS2D,gBAA4B,aAAI,IAAM,GACjEF,EAAWY,EAAiBG,EAAiB,YAAc,SAC3Dd,EAAsB,UAAbD,EAAwBe,EAAiBH,EAEnD3E,OAAO,cAAc,EAAE6C,OAAO,CAC7BC,MAAM,CAAA,EACNC,MAAOsB,EAAOU,UACd9D,SAAU,CAAE+B,GAAI,aAAcC,GAAI,mBAAqBC,GAAIZ,MAAO,EAClEa,MAASnD,OAAO,SAAS,EAAEmD,MAAM,EAAI,IAAM,GAC3Ca,OAAQA,EACRZ,KAAM,CAAEC,OAAQ,QAASC,SAAU,GAAI,EACvCC,UAAW,CAAA,EACXC,UAAW,CAAA,EACXC,UAAW,IACXC,QAAS,CAACC,YAAa,YAAY,EACnCzB,KAAM,SAAS0B,EAAOC,GACrBvD,SAAS6D,KAAKL,MAAMC,SAAW,SAC/BH,EAAM3D,OAAO6D,MAAMC,SAAWA,EAC9B/D,OAAO,cAAc,EAAEgE,OAAOA,CAAM,CACrC,EACAE,YAAa,SAASN,EAAOC,GAC5BvD,SAAS6D,KAAKL,MAAMC,SAAW,OAC/B/D,OAAO,cAAc,EAAEa,MAAM,CAC9B,CACD,CAAC,CACF,CAEA,SAASwG,iCACRrH,OAAO,6BAA6B,EAAEsH,KAAKC,WAAWC,uBAAuB,EAS7EpF,qBARa,CACZZ,OAAQ,8BACT,EACe,CACdK,SAAU,IACTvB,SAASmH,eAAe,8BAA8B,EAAEC,UAAYrD,EAAO9C,IAC5E,CACD,CACiC,CAClC,CAMA,SAASoG,mDAAmDhH,GAE3D,IAAMW,EAAOtB,OAAOW,CAAG,EACjBiH,EAAStG,EAAKF,QAAQ,cAAc,EAAEX,KAAK,KAAK,EACtD,MAAMoH,EAAYvG,EAAKwG,QAAQ,cAAc,EAAEC,KAAK,QAAQ,EAAET,KAAK,EAG7DU,EAAUhI,OAAO,8CAA8C,EAC/CgI,EAAQA,QAAQ,EACxB9F,KAAK,EAGfX,EAAO,CACVC,OAAQ,sCACRC,QAASmG,EACTK,SAAUC,aAAaC,UACxB,EAEAnI,OAAOoI,KAAK,CACXC,KAAM,OACNC,MAAO,CAAA,EACPC,IAAKL,aAAaM,QAClBjH,KAAMA,EACN8E,QAAS,SAAShC,GACbA,EAAOgC,UACV2B,EAAQD,KAAK,2BAA2B,EAAE5B,OAAO,EACjD6B,EAAQD,KAAK,6BAA6B,EAAET,KAAKO,CAAS,EAC1DY,iBAAiBpE,EAAO9C,KAAMyG,CAAO,EACrCU,oBAAoBrE,EAAO9C,KAAK,GAAGoH,GAAIX,CAAO,EAIhD,CACD,CAAC,CACF,CAOA,SAASS,iBAAiBlH,EAAMyG,GAE/B1D,IAAIsE,EAAO,GAEX,IAAKtE,IAAIuE,KAAQtH,EAChBqH,4BAAiCC,EAAKF,OAAOE,EAAKC,kBAG/CC;cAESH;eAGbZ,EAAQD,KAAK,wBAAwB,EAAEjH,OAAOiI,CAAI,CACnD,CAEA,SAASL,oBAAoBM,EAAahB,GAGzC1D,IAAI/C,EAAO,CACVC,OAAQ,6CACRwH,YAAAA,EACAf,SAAUC,aAAaC,UACxB,EAEAnI,OAAOoI,KAAK,CACXC,KAAM,OACNC,MAAO,CAAA,EACPC,IAAKL,aAAaM,QAClBjH,KAAMA,EACN0H,WAAY,WACXjJ,OAAO,uCAAuC,EAAEoD,KAAK,CACtD,EACAiD,QAAS,SAAShC,GACbA,EAAOgC,UACV2B,EAAQD,KAAK,8BAA8B,EAAE5B,OAAO,EACpD6B,EAAQD,KAAK,mBAAmB,EAAEmB,YAAY,QAAQ,EACtDlB,EAAQD,KAAK,qBAAuBiB,EAAc,GAAG,EAAEG,SAAS,QAAQ,EAEpEJ;;;kCAI0B1E,EAAO9C,KAAKuF;;;4BAK1C9G,OAAO,uCAAuC,EAAEK,KAAK,EACrD2H,EAAQD,KAAK,wBAAwB,EAAEjH,OAAOiI,CAAI,EAClDzI,SAAS8I,iBAAiB,UAAU,EAAEC,QAAQ,IAC7CC,KAAKC,iBAAiBC,CAAE,CACzB,CAAC,EAIH,CACD,CAAC,CACF,CAMA,SAASC,2CAA2C9I,GAK/CY,EAAO,CACVC,OAAQ,6BACRkI,eALY1J,OAAOW,CAAG,EACGS,QAAQ,cAAc,EAAEX,KAAK,KAAK,EAK3DwH,SAAUC,aAAaC,UACxB,EAEAnI,OAAOoI,KAAK,CACXC,KAAM,OACNC,MAAO,CAAA,EACPC,IAAKL,aAAaM,QAClBjH,KAAMA,EACN8E,QAAS,SAAShC,GACbA,EAAOgC,SACVpE,UAAUC,KAAK,EAAEyH,IAAItF,EAAO9C,IAAI,EAChCjB,SAASsJ,iBAAiB,kBAAmB,SAAU7J,GACtDO,SAASiC,SAASC,OAAO,CAC1B,CAAC,GAEDP,UAAUC,KAAK,EAAEC,SAASkC,EAAO9C,IAAI,CAEvC,CACD,CAAC,CACF,CAMA,SAASsI,qDAAqDlJ,GAKzDY,EAAO,CACVC,OAAQ,4CACRkI,eALY1J,OAAOW,CAAG,EACGS,QAAQ,cAAc,EAAEX,KAAK,KAAK,EAK3DwH,SAAUC,aAAaC,UACxB,EAEAnI,OAAOoI,KAAK,CACXC,KAAM,OACNC,MAAO,CAAA,EACPC,IAAKL,aAAaM,QAClBjH,KAAMA,EACN8E,QAAS,SAAShC,GACbA,EAAOgC,SACVpE,UAAUC,KAAK,EAAEyH,IAAItF,EAAO9C,IAAI,EAChCjB,SAASsJ,iBAAiB,kBAAmB,SAAU7J,GACtDO,SAASiC,SAASC,OAAO,CAC1B,CAAC,GAEDP,UAAUC,KAAK,EAAEC,SAASkC,EAAO9C,IAAI,CAEvC,CACD,CAAC,CACF,CAOA,SAASuI,2CAA2CvB,GAEnDvI,OAAO,6CAA6C,EAAE+J,KAAK,WAAY,CAAA,CAAI,EACrExI,EAAO,CACZC,OAAQ,yBACRmH,GAAIJ,EAAIyB,IACT,EAUA5H,qBAAqBb,EARN,CACdM,SAAU,IACT7B,OAAO,0CAA0C,EAAEiK,IAAI,EAAE,EACzDC,0CAA0C7F,EAAO9C,IAAI,EACrDvB,OAAO,6CAA6C,EAAE+J,KAAK,WAAY,CAAA,CAAK,CAC7E,CACD,CAEiC,CAClC,CAEA,SAASG,0CAA0C5C,GAElDtH,OAAO,6CAA6C,EAAEsH,KAAKA,CAAI,EAC/D6C,WAAW,WACVnK,OAAO,6CAA6C,EAAEsH,KAAK,EAAE,CAC9D,EAAG,GAAI,CACR,CAEAtH,OAAOM,QAAQ,EAAE8J,MAAM,WAGtBC,+BAA+B,EAC/BC,8BAA8B,EAC9BC,6BAA6B,EAC7BC,uBAAuB,EAEvBC,kBAAkB,EAGlBzK,OAAO,2BAA2B,EAAE0K,YAAY,CAC/CC,MAAO,EACPC,OAAQ,SAAUhH,EAAOC,GACxBD,EAAM3D,OAAO6D,MAAM7C,SAAW,WAC9B2C,EAAM3D,OAAO6D,MAAM+G,aAAe,MACnC,EACAC,OAAQ,SAASlH,EAAOC,GACvB7D,OAAO,gCAAgC,EAAEsH,KAAKtH,OAAO4D,EAAM3D,MAAM,EAAEyK,YAAY,SAAU,OAAO,EAAI,IAAI,CACzG,CACD,CAAC,EAGD1K,OAAO,sBAAsB,EAAE+K,UAAU,CACxCC,OAAQ,KACRC,YAAa,UACbC,YAAa,CAAA,EACbC,OAAQ,CAAA,EACRC,SAAU,SAAUxH,EAAOC,GACC,IAAvBA,EAAGwH,SAASlL,QAAwC,IAAxB0D,EAAGyH,UAAUnL,QAC5CH,OAAO,sBAAsB,EAAE+K,UAAU,SAAU,+BAAgC,yCAAyC,CAC9H,EACAQ,eAAgB,SAAU3H,EAAOC,GACL,IAAvBA,EAAGwH,SAASlL,QAAwC,IAAxB0D,EAAGyH,UAAUnL,QAC5CH,OAAO,sBAAsB,EAAE+K,UAAU,SAAU,+BAAgC,kBAAkB,CACvG,CACD,CAAC,EAGDzI,OAAOkJ,aAAe,IAAIC,mBAAmB,CAC5CC,SAAUnE,WAAWmE,SACrBC,OAAQpE,WAAWoE,OACnBC,OAAQ5L,OAAO,oBAAoB,EACnC2B,QAAS3B,OAAO,oBAAoB,EAAE6L,KAAK,EAC3ChK,SAAU,KACViK,iBAAkB9L,OAAO,+BAA+B,EACxD0K,YAAa1K,OAAO,2BAA2B,EAC/C+L,iBAAkB/L,OAAO,gCAAgC,EACzDgM,QAAS1L,SAAS2L,uBAAuB,0BAA0B,EACnEC,SAAU,CACTC,UAAWnM,OAAO,+BAA+B,EACjDoM,SAAWpM,OAAO,8BAA8B,CACjD,CACD,CAAC,EAEDA,OAAOM,QAAQ,EAAEa,GAAG,QAAS,+BAAgC,WAC5DvB,sBAAuBI,OAAQqM,IAAK,CAAE,CACvC,CAAC,EAEDrM,OAAO,oBAAoB,EAAEmB,GAAG,QAAS,WACxCnB,OAAO,8BAA8B,EAAEmG,OAAO,EAC9CqF,aAAac,cAAc,EAEtBtM,OAAO,+BAA+B,EAAEG,QAC5CH,OAAO,mBAAmB,EAAEc,OAAO,gCAAgC,EAGpEd,OAAO,mBAAmB,EAAEwD,UAAU,CACrC+I,QAAS,OACTC,YAAa,UACd,CAAC,CACF,CAAC,EAEDxM,OAAO,8BAA8B,EAAEwD,UAAU,CAChD+I,QAAS,OACTC,YAAa,UACd,CAAC,EAIDxM,OAAO,qBAAqB,EAAEmB,GAAG,QAAS,WAEnCsL,QAAQ,sDAAsD,IAGpEzH,QAAQC,IAAI,OAAO,EAEnB7C,qBACC,CAAEZ,OAAQ,oBAAsB,EAChC,CACC6G,KAAM,MACNqE,gBAAiB,WAAYpM,SAASiC,SAAWjC,SAASiC,QAAS,EACnEoK,SAAU,KACV5K,YAAa,KACb6K,QAASP,KACTQ,QAAS,GACV,CACD,EACD,CAAC,EAED7M,OAAO,2BAA2B,EAAEmB,GAAG,QAAS,WAC/CnB,OAAOoI,KAAK,CACXG,IAAKL,aAAaM,QAClBH,KAAM,OACN9G,KAAM,CACLC,OAAQ,2BACRyG,SAAUC,aAAaC,WACvB2E,SAAUC,KAAKC,OAAO,CACvB,EACAC,UAAW,CACVC,aAAc,MACf,EACA7G,QAAS,SAAS9E,GACjBvB,OAAOoI,KAAK,CACVG,IAAKL,aAAaM,QAClBH,KAAM,OACN9G,KAAM,CACLC,OAAQ,iCACRyG,SAAUC,aAAaC,WACvB2E,SAAUC,KAAKC,OAAO,CACvB,EACAC,UAAW,CACVC,aAAc,MACf,EACA7G,QAAS,SAAS8G,GACjB7I,IAAI8I,EAAK,IAAIC,KAAK,CAAC9L,EAAK,EACpB+L,EAAKhN,SAASiN,cAAc,GAAG,EACnCD,EAAKtD,KAAK1H,OAAOkL,IAAIC,gBAAgBL,CAAI,EACzCE,EAAKI,SAASP,EAAS5L,KACvB+L,EAAKK,MAAM,CACZ,CACD,CACD,CACD,CACD,CAAC,CACF,CAAC,EAGD3N,OAAOM,QAAQ,EAAEa,GAAG,QAAS,4CAA6C,WACzE,IAAMyM,EAAoB5N,OAAOqM,IAAI,EAAE9K,KAAK,aAAa,EAGrDqM,IAFqB5N,OAAO,kDAAkD,EAAEuB,KAAK,aAAa,GAOtGmH,oBAAoBkF,EADJ5N,OAAO,8CAA8C,CACvB,CAC/C,CAAC,EAKDA,OAAO,6CAA6C,EAAEmB,GAAG,QAAS,SAASpB,GAC1EA,EAAE8N,eAAe,EACXC,EAAW9N,OAAO,0CAA0C,EAAEiK,IAAI,EACxE,IAEC,OAAOH,2CADK,IAAI0D,IAAIM,CAAQ,CACyB,CAItD,CAHE,MAAOC,GAER,OAAO7D,0CADO,yBACwC,CACvD,CACD,CAAC,CACF,CAAC"}