{"version":3,"sources":["spbc-admin.js"],"names":["spbc_admin_set_cookie","name","data","expires","date","Date","getTime","document","cookie","toUTCString","spbcGetGoogleQrCode","res","security","spbcSettings","ajax_nonce","action","jQuery","ajax","type","async","url","ajaxurl","success","result","spbcCheckGoogleCode","code","val","dialog","location","reload","alert","spbcDisableG2fa","ready","on","e","preventDefault","spbcGoogleQrCode","html","modal","title","buttons","Cancel","this","Ok","draggable","resizable","confirm","target"],"mappings":"AAAA,SAASA,sBAAsBC,EAAMC,EAAMC,GAC1C,IAAIC,EAAO,IAAIC,MAAK,IAAIA,MAAOC,UAAY,IAAOH,GAClDI,SAASC,OAASP,EAAO,IAAMC,EAAO,qBAAuBE,EAAKK,cAGnE,SAASC,sBACR,IAAIR,EAAO,GACPS,EAAM,GAaV,OAZAT,EAAKU,SAAWC,aAAaC,WAC7BZ,EAAKa,OAAS,0BAEdC,OAAOC,KAAK,CACXC,KAAM,OACNC,OAAO,EACPC,IAAKP,aAAaQ,QAClBnB,KAAMA,EACNoB,QAAS,SAASC,GACjBZ,EAAMY,KAGDZ,EAGR,SAASa,sBACR,IAAItB,EAAO,GACXA,EAAKU,SAAWC,aAAaC,WAC7BZ,EAAKa,OAAS,yBACdb,EAAKuB,KAAOT,OAAO,+BAA+BU,MAElDV,OAAOC,KAAK,CACXC,KAAM,OACNC,OAAO,EACPC,IAAKP,aAAaQ,QAClBnB,KAAMA,EACNoB,QAAS,SAASC,GACdA,EAAOD,SACTN,OAAO,yBAAyBW,OAAQ,SACxCpB,SAASqB,SAASC,UAElBC,MAAMP,EAAOrB,SAMjB,SAAS6B,kBACR,IAAI7B,EAAO,GACXA,EAAKU,SAAWC,aAAaC,WAC7BZ,EAAKa,OAAS,0BAEdC,OAAOC,KAAK,CACXC,KAAM,OACNC,OAAO,EACPC,IAAKP,aAAaQ,QAClBnB,KAAMA,EACNoB,QAAS,SAASC,GACdA,EAAOD,QACTf,SAASqB,SAASC,SAElBC,MAAMP,EAAOrB,SAMjBc,OAAOT,UAAUyB,MAAM,WAGtBhB,OAAO,uBAAuBiB,GAAG,QAAS,SAAU,WACnDjC,sBAAsB,4BAA6B,EAAG,UAIvDgB,OAAOT,UAAU0B,GAAG,QAAS,oBAAqB,SAASC,GAE1DA,EAAEC,iBACF,IAAIC,EAAmB1B,sBAEnB0B,EAAiBd,SACpBN,OAAO,6BAA6BqB,KAAKD,EAAiBlC,MAC1Dc,OAAO,+BAA+BU,IAAI,IAC1CV,OAAO,yBAAyBW,OAAO,CACtCW,OAAO,EACPC,MAAO,kCACPC,QAAS,CACRC,OAAQ,WACPzB,OAAQ0B,MAAOf,OAAQ,UAExBgB,GAAI,WACHnB,wBAGFoB,WAAW,EACXC,WAAW,KAGZf,MAAMpB,oBAAoBR,QAM5Bc,OAAOT,UAAU0B,GAAG,QAAS,qBAAsB,SAASC,GAE3DA,EAAEC,iBACEW,QAAS,kBACZf,kBAED,IAAIK,EAAmB1B,sBAEnB0B,EAAiBd,SACpBN,OAAO,6BAA6BqB,KAAKD,EAAiBlC,MAC1Dc,OAAO,+BAA+BU,IAAI,IAC1CV,OAAO,yBAAyBW,OAAO,CACtCW,OAAO,EACPC,MAAO,kCACPC,QAAS,CACRC,OAAQ,WACPzB,OAAQ0B,MAAOf,OAAQ,UAExBgB,GAAI,WACHnB,oBAAoBU,EAAEa,UAGxBH,WAAW,EACXC,WAAW,KAGZf,MAAMpB,oBAAoBR","file":"spbc-admin.min.js","sourcesContent":["function spbc_admin_set_cookie(name, data, expires){\r\n\tvar date = new Date(new Date().getTime() + 1000 * expires );\r\n\tdocument.cookie = name + '=' + data + '; path=/; expires=' + date.toUTCString();\r\n}\r\n\r\nfunction spbcGetGoogleQrCode() {\r\n\tvar data = {};\r\n\tvar res = {};\r\n\tdata.security = spbcSettings.ajax_nonce;\r\n\tdata.action = 'spbc_get_google_qr_code';\r\n\r\n\tjQuery.ajax({\r\n\t\ttype: \"POST\",\r\n\t\tasync: false,\r\n\t\turl: spbcSettings.ajaxurl,\r\n\t\tdata: data,\r\n\t\tsuccess: function(result){\r\n\t\t\tres = result;\r\n\t\t},\r\n\t});\r\n\treturn res;\r\n}\r\n\r\nfunction spbcCheckGoogleCode() {\r\n\tvar data = {};\r\n\tdata.security = spbcSettings.ajax_nonce;\r\n\tdata.action = 'spbc_check_google_code';\r\n\tdata.code = jQuery('#spbct-google-qr-code input').val();\r\n\r\n\tjQuery.ajax({\r\n\t\ttype: \"POST\",\r\n\t\tasync: false,\r\n\t\turl: spbcSettings.ajaxurl,\r\n\t\tdata: data,\r\n\t\tsuccess: function(result){\r\n\t\t\tif(result.success) {\r\n\t\t\t\tjQuery('#spbct-google-qr-code').dialog( \"close\" );\r\n\t\t\t\tdocument.location.reload();\r\n\t\t\t} else {\r\n\t\t\t\talert(result.data);\r\n\t\t\t}\r\n\t\t},\r\n\t});\r\n}\r\n\r\nfunction spbcDisableG2fa() {\r\n\tvar data = {};\r\n\tdata.security = spbcSettings.ajax_nonce;\r\n\tdata.action = 'spbc_disable_google_2fa';\r\n\r\n\tjQuery.ajax({\r\n\t\ttype: \"POST\",\r\n\t\tasync: false,\r\n\t\turl: spbcSettings.ajaxurl,\r\n\t\tdata: data,\r\n\t\tsuccess: function(result){\r\n\t\t\tif(result.success) {\r\n\t\t\t\tdocument.location.reload();\r\n\t\t\t} else {\r\n\t\t\t\talert(result.data);\r\n\t\t\t}\r\n\t\t},\r\n\t});\r\n}\r\n\r\njQuery(document).ready(function(){\r\n\t\r\n\t// Auto update banner close handler \r\n\tjQuery('.spbc_update_notice').on('click', 'button', function(){\r\n\t\tspbc_admin_set_cookie('spbc_update_banner_closed', 1, 86400 * 30);\r\n\t});\r\n\r\n\t// Enable G2FA from user profile page\r\n\tjQuery(document).on('click', '#spbc-g2fa-enable', function(e){\r\n\r\n\t\te.preventDefault();\r\n\t\tvar spbcGoogleQrCode = spbcGetGoogleQrCode();\r\n\r\n\t\tif( spbcGoogleQrCode.success ) {\r\n\t\t\tjQuery('#spbct-google-qr-code-img').html(spbcGoogleQrCode.data);\r\n\t\t\tjQuery('#spbct-google-qr-code input').val('');\r\n\t\t\tjQuery('#spbct-google-qr-code').dialog({\r\n\t\t\t\tmodal: true,\r\n\t\t\t\ttitle: 'Google authenticator activation',\r\n\t\t\t\tbuttons: {\r\n\t\t\t\t\tCancel: function() {\r\n\t\t\t\t\t\tjQuery( this ).dialog( \"close\" );\r\n\t\t\t\t\t},\r\n\t\t\t\t\tOk: function() {\r\n\t\t\t\t\t\tspbcCheckGoogleCode();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tdraggable: false,\r\n\t\t\t\tresizable: false,\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\talert(spbcGetGoogleQrCode.data);\r\n\t\t}\r\n\r\n\t});\r\n\r\n\t// Disable G2FA from user profile page\r\n\tjQuery(document).on('click', '#spbc-g2fa-disable', function(e){\r\n\r\n\t\te.preventDefault();\r\n\t\tif( confirm( 'Are you sure?' ) ) {\r\n\t\t\tspbcDisableG2fa();\r\n\t\t}\r\n\t\tvar spbcGoogleQrCode = spbcGetGoogleQrCode();\r\n\r\n\t\tif( spbcGoogleQrCode.success ) {\r\n\t\t\tjQuery('#spbct-google-qr-code-img').html(spbcGoogleQrCode.data);\r\n\t\t\tjQuery('#spbct-google-qr-code input').val('');\r\n\t\t\tjQuery('#spbct-google-qr-code').dialog({\r\n\t\t\t\tmodal: true,\r\n\t\t\t\ttitle: 'Google authenticator activation',\r\n\t\t\t\tbuttons: {\r\n\t\t\t\t\tCancel: function() {\r\n\t\t\t\t\t\tjQuery( this ).dialog( \"close\" );\r\n\t\t\t\t\t},\r\n\t\t\t\t\tOk: function() {\r\n\t\t\t\t\t\tspbcCheckGoogleCode(e.target);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tdraggable: false,\r\n\t\t\t\tresizable: false,\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\talert(spbcGetGoogleQrCode.data);\r\n\t\t}\r\n\r\n\t});\r\n\t\r\n});"]}