{"version":3,"file":"spbc-admin.min.js","sources":["spbc-admin.js"],"sourcesContent":["function spbcGetGoogleQrCode() {\n\tvar data = {};\n\tvar res = {};\n\tdata.security = spbcSettings.ajax_nonce;\n\tdata.action = 'spbc_get_google_qr_code';\n\n\tjQuery.ajax({\n\t\ttype: \"POST\",\n\t\tasync: false,\n\t\turl: spbcSettings.ajaxurl,\n\t\tdata: data,\n\t\tsuccess: function(result){\n\t\t\tres = result;\n\t\t},\n\t});\n\treturn res;\n}\n\nfunction spbcCheckGoogleCode() {\n\tvar data = {};\n\tdata.security = spbcSettings.ajax_nonce;\n\tdata.action = 'spbc_check_google_code';\n\tdata.code = jQuery('#spbct-google-qr-code input').val();\n\n\tjQuery.ajax({\n\t\ttype: \"POST\",\n\t\tasync: false,\n\t\turl: spbcSettings.ajaxurl,\n\t\tdata: data,\n\t\tsuccess: function(result){\n\t\t\tif(result.success) {\n\t\t\t\tjQuery('#spbct-google-qr-code').dialog( \"close\" );\n\t\t\t\tdocument.location.reload();\n\t\t\t} else {\n\t\t\t\talert(result.data);\n\t\t\t}\n\t\t},\n\t});\n}\n\nfunction spbcDisableG2fa( element ) {\n\tvar data = {};\n\tdata.security = spbcSettings.ajax_nonce;\n\tdata.action = 'spbc_disable_google_2fa';\n    data.user_id = jQuery(element).data('user-id');\n\n\tjQuery.ajax({\n\t\ttype: \"POST\",\n\t\tasync: false,\n\t\turl: spbcSettings.ajaxurl,\n\t\tdata: data,\n\t\tsuccess: function(result){\n\t\t\tif(result.success) {\n\t\t\t\tdocument.location.reload();\n\t\t\t} else {\n\t\t\t\talert(result.data);\n\t\t\t}\n\t\t},\n\t});\n}\n\njQuery(document).ready(function(){\n\n\t// Auto update banner close handler\n\tjQuery('.spbc_update_notice').on('click', 'button', function(){\n\t\tspbc_setCookie('spbc_update_banner_closed', 1, 86400 * 30);\n\t});\n\n\t// Enable G2FA from user profile page\n\tjQuery(document).on('click', '#spbc-g2fa-enable', function(e){\n\n\t\te.preventDefault();\n\t\tvar spbcGoogleQrCode = spbcGetGoogleQrCode();\n\n\t\tif( spbcGoogleQrCode.success ) {\n\t\t\tvar qr_code_div = jQuery('#spbct-google-qr-code-img');\n\t\t\tqr_code_div.html(spbcGoogleQrCode.data.img + '<p>' + spbcGoogleQrCode.data.code + '</p>');\n\t\t\tjQuery('#spbct-google-qr-code input').val('');\n\t\t\tjQuery('#spbct-google-qr-code').dialog({\n\t\t\t\tmodal: true,\n\t\t\t\ttitle: 'Google authenticator activation',\n\t\t\t\tbuttons: {\n\t\t\t\t\tCancel: function() {\n\t\t\t\t\t\tjQuery( this ).dialog( \"close\" );\n\t\t\t\t\t},\n\t\t\t\t\tOk: function() {\n\t\t\t\t\t\tspbcCheckGoogleCode();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tdraggable: false,\n\t\t\t\tresizable: false,\n\t\t\t});\n\t\t} else {\n\t\t\talert(spbcGetGoogleQrCode.data);\n\t\t}\n\n\t});\n\n\t// Disable G2FA from user profile page\n\tjQuery(document).on('click', '#spbc-g2fa-disable', function(e){\n\n\t\te.preventDefault();\n\t\tif( confirm( 'Are you sure?' ) ) {\n\t\t\tspbcDisableG2fa( this );\n\t\t}\n\n\t});\n\n\tvar refresh_user_online_counter = function( result, data, params ){\n\t\tsetTimeout(function () {\n\t\t\tif( result !== null ){\n\t\t\t\tjQuery('.spbc-admin_bar--user_counter').html(result.count);\n\t\t\t\tif( result.count <= 3 ) {\n\t\t\t\t\tjQuery('#wp-admin-bar-spbc_admin_bar__online_admins').show();\n\t\t\t\t\tjQuery('.spbc-admin_bar--online_admins').html(result.users.join(', '));\n\t\t\t\t}else{\n\t\t\t\t\tjQuery('#wp-admin-bar-spbc_admin_bar__online_admins').hide();\n\t\t\t\t}\n\n\t\t\t}\n\t\t\tspbc_sendAJAXRequest( data, params );\n\t\t}, 15000 );\n\t};\n\n\tif( +spbcSettings.admin_bar__admins_online_counter === 1 ) {\n\t\trefresh_user_online_counter(null, {action: 'spbc_get_authorized_admins'}, {callback: refresh_user_online_counter});\n\t}\n\n\t// Dismiss admin banner\n\tjQuery('body').on('click', '.spbc-notice .notice-dismiss', function(e){\n\t\tvar bannerId = jQuery(e.target).parent('.notice').attr('id');\n\t\tif( bannerId ) {\n\t\t\tspbc_sendAJAXRequest( { 'action' : 'spbc_dismiss_banner', 'banner_id' : bannerId }, { 'callback' : null } );\n\t\t}\n\t});\n\n\tif (+spbcSettings.needToWhitelist === 1) {\n\t\tspbc_sendAJAXRequest( { 'action' : 'spbc_private_list_add' }, { 'callback' : null } );\n\t}\n});\n\nfunction spbcSummaryShowCDNCheckerTable()\n{\n\tevent.preventDefault()\n\tlet table = document.getElementById('spbc_stats_cdn_checker_table')\n\tif (typeof (table) !== 'undefined') {\n\t\tif (table.style.display === 'block') {\n\t\t\ttable.style.display = 'none'\n\t\t} else {\n\t\t\ttable.style.display = 'block'\n\t\t}\n\t}\n}\n"],"names":["spbcGetGoogleQrCode","data","res","security","spbcSettings","ajax_nonce","action","jQuery","ajax","type","async","url","ajaxurl","success","result","spbcCheckGoogleCode","code","val","dialog","document","location","reload","alert","spbcDisableG2fa","element","user_id","spbcSummaryShowCDNCheckerTable","event","preventDefault","let","table","getElementById","style","display","ready","on","spbc_setCookie","e","spbcGoogleQrCode","html","img","modal","title","buttons","Cancel","this","Ok","draggable","resizable","confirm","refresh_user_online_counter","params","setTimeout","count","show","users","join","hide","spbc_sendAJAXRequest","admin_bar__admins_online_counter","callback","bannerId","target","parent","attr","banner_id","needToWhitelist"],"mappings":"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"}