function spbc_popup_tip___show(e){var t=e.attr("spbc_tip_title")||null,o=e.attr("spbc_tip_text")||null,s=function(e){void 0!==e&&(0!=jQuery(e.target).parent(".spbc_popup_tip--wrapper").length&&!jQuery(e.target).hasClass("spbc_popup_tip--icon---cancel")||jQuery(e.target).hasClass("spbc_popup_tip--icon---show"))||(jQuery(".spbc_popup_tip--wrapper").hide(),jQuery(document).off("click",s))};s(),e.after("<div class='spbc_popup_tip--wrapper'></div>");var n=jQuery(".spbc_popup_tip--wrapper");n.empty().append("<div class='spbc_popup_tip--angle'></div>").css({top:e.position().top-2,left:e.position().left+25}),n.append("<i class='spbc_popup_tip--icon---cancel icon-cancel'></i>").append("<h3 class='spbc_popup_tip--title'>"+t+"</h3>").append("<p class='spbc_popup_tip--text'>"+o+"</p>"),jQuery(document).on("click",s),e.parents("tr").on("mouseout",s)}function spbc_scanner_button_file_view_event(e){var t=jQuery(e),o={action:"spbc_scanner_file_view",file_id:t.parents(".row-actions").attr("uid")},s={spinner:t.parent().siblings(".tbl-preloader--tiny"),callback:spbc_scannerButtonView_callback,errorOutput:function(e){spbcModal.open().putError(e)}};spbc_sendAJAXRequest(o,s)}function spbc_scanner_button_page_view_event(e){var t=jQuery(e),o={action:"spbc_scanner_page_view",page_url:t.parents(".row-actions").attr("uid")},s={spinner:t.parent().siblings(".tbl-preloader--tiny"),callback:spbc_scannerButtonView_callback,errorOutput:function(e){spbcModal.open().putError(e)}};spbc_sendAJAXRequest(o,s)}function spbc_scannerButtonView_callback(e,t,o){console.log("FILE_VIEWED");for(let t in e.file)jQuery("#spbc_dialog").append('<div class="spbc_view_file_row_wrapper"><span class="spbc_view_file_row_num">%s</span><p class="spbc_view_file_row">%s</p><br /></div>'.printf(t,e.file[t]));let s=19*Object.keys(e.file).length<76?76:19*Object.keys(e.file).length,n=document.documentElement.clientHeight/100*75,c=s<n?"hidden":"scroll",r="scroll"===c?n:s;jQuery("#spbc_dialog").dialog({modal:!0,title:e.file_path,position:{my:"center top",at:"center top+100px",of:window},width:+jQuery("#wpwrap").width()/100*90,show:{effect:"blind",duration:500},draggable:!1,resizable:!1,closeText:"X",classes:{"ui-dialog":"spbc---top"},open:function(e,t){e.target.style.overflow=c,jQuery("#spbc_dialog").height(r)},beforeClose:function(e,t){document.body.style.overflow="auto",jQuery("#spbc_dialog").empty()}})}function spbc_scanner_button_file_view_bad_event(e){var t=jQuery(e),o={action:"spbc_scanner_file_view",file_id:t.parents(".row-actions").attr("uid")},s={spinner:t.parent().siblings(".tbl-preloader--tiny"),callback:spbc_scannerButtonViewBad_callback,errorOutput:function(e){spbcModal.open().putError(e)}};spbc_sendAJAXRequest(o,s)}function spbc_scanner_button_page_view_bad_event(e){var t=jQuery(e),o={action:"spbc_scanner_page_view",page_url:t.parent().attr("uid")},s={spinner:t.parent().siblings(".tbl-preloader--tiny"),callback:spbc_scannerButtonViewBad_callback,errorOutput:function(e){spbcModal.open().putError(e)}};spbc_sendAJAXRequest(o,s)}function spbc_scannerButtonViewBad_callback(e,t,o){console.log("FILE_VIEWED_BAD_CODE"),console.log(arguments);var s='<div class="spbc_view_file_row_wrapper"><span class="spbc_view_file_row_num">%s</span><p class="spbc_view_file_row" style="word-break: break-all">%s</p><br /></div>',n=[];e.weak_spots=JSON.parse(e.weak_spots);for(let t in e.weak_spots)n=n.concat(Object.keys(e.weak_spots[t]));n=[...new Set(n)].sort();let c=new Map(Object.entries(e.weak_spots.CRITICAL));for(let t in n){let o=+n[t],r=2;for(let p=o-r;p<=o+r;p++)if(void 0!==e.file[p]){let r,a,i=o===p;r=i?'<div class="spbc_view_file_row_wrapper" style="background: rgb(200,120,120);"><span class="spbc_view_file_row_num">%s</span><p class="spbc_view_file_row" style="word-break: break-all">%s</p><br /></div>':s,a=i?r.printf(p,c.get(n[t])):r.printf(p,e.file[p]),jQuery("#spbc_dialog").append(a)}jQuery("#spbc_dialog").append(s.printf("",""))}jQuery("#spbc_dialog div").last().remove();let r=19*jQuery("#spbc_dialog div").length<76?76:19*jQuery("#spbc_dialog div").length,p=document.documentElement.clientHeight/100*75,a=r<p?"no_scroll":"scroll";jQuery("#spbc_dialog").dialog({modal:!0,title:e.file_path,position:{my:"center top",at:"center top+100px",of:window},width:+jQuery("#wpwrap").width()/100*90,show:{effect:"blind",duration:500},draggable:!0,resizable:!1,closeText:"X",classes:{"ui-dialog":"spbc---top"},open:function(e,t){e.target.style.overflow=a,jQuery("#spbc_dialog").height("auto")},beforeClose:function(e,t){document.body.style.overflow="auto",jQuery("#spbc_dialog").empty()}})}function spbc_scanner_button_file_compare_event(e){var t=jQuery(e),o={action:"spbc_scanner_file_compare",file_id:t.parents(".row-actions").attr("uid")},s={spinner:t.parent().siblings(".tbl-preloader--tiny"),callback:spbc_scannerButtonFileCompare_callback,errorOutput:function(e){spbcModal.open().putError(e)}};spbc_sendAJAXRequest(o,s)}function spbc_scannerButtonFileCompare_callback(e,t,o){console.log("FILE_COMPARED");let s='<div class="spbc_compare_file_row_wrapper"><p class="spbc_compare_file_row">%s</p><span class="spbc_compare_file_row_num">%s</span><p class="spbc_compare_file_row">%s</p><br /></div>';jQuery("#spbc_dialog").append(s.printf('<span class="spbc_compare_file_headings">Modified</span>',"Line",'<span class="spbc_compare_file_headings">Original</span>'));for(var n=1;void 0!==e.file[n]||void 0!==e.file_original[n];n++)if(void 0===e.file[n]&&(e.file[n]=""),void 0===e.file_original[n]&&(e.file_original[n]=""),-1!=e.difference.indexOf(n)){for(let t=2,o=n-t;o<=n+t;o++)void 0!==e.file[o]&&void 0!==e.file_original[n]&&jQuery("#spbc_dialog").append((n===o?'<div class="spbc_compare_file_row_wrapper" style="background: rgba(200,40,40,0.8);"><p class="spbc_compare_file_row">%s</p><span class="spbc_compare_file_row_num">%s</span><p class="spbc_compare_file_row">%s</p><br /></div>':s).printf(e.file[o]?e.file[o]:"",o,e.file_original[o]?e.file_original[o]:""));jQuery("#spbc_dialog").append(s.printf("","",""))}var c=19*jQuery("#spbc_dialog div").length+19,r=document.documentElement.clientHeight/100*75,p=c<r?"no_scroll":"scroll",a="scroll"===p?r:c;jQuery("#spbc_dialog").dialog({modal:!0,title:e.file_path,position:{my:"center top",at:"center top+100px",of:window},width:+jQuery("#wpwrap").width()/100*90,height:a,show:{effect:"blind",duration:500},draggable:!0,resizable:!0,closeText:"X",classes:{"ui-dialog":"spbc---top"},open:function(e,t){document.body.style.overflow="hidden",e.target.style.overflow=p,jQuery("#spbc_dialog").height(a)},beforeClose:function(e,t){document.body.style.overflow="auto",jQuery("#spbc_dialog").empty()}})}jQuery(document).ready(function(){spbc_tbl__bulk_actions__listen(),spbc_tbl__row_actions__listen(),spbc_tbl__pagination__listen(),spbc_tbl__sort__listen(),spbcStartShowHide(),jQuery("#spbc_scaner_progress_bar").progressbar({value:0,create:function(e,t){e.target.style.position="relative",e.target.style.marginBottom="12px"},change:function(e,t){jQuery(".spbc_progressbar_counter span").text(jQuery(e.target).progressbar("option","value")+" %")}}),jQuery("#spbc_scan_accordion").accordion({header:"h3",heightStyle:"content",collapsible:!0,active:!1,activate:function(e,t){0===t.oldPanel.length&&0===t.oldHeader.length&&jQuery("#spbc_scan_accordion").accordion("option","classes.ui-accordion-content","ui-corner-bottom spbc-overflow--visible")},beforeActivate:function(e,t){1===t.oldPanel.length&&1===t.oldHeader.length&&jQuery("#spbc_scan_accordion").accordion("option","classes.ui-accordion-content","ui-corner-bottom")}}),window.spbc_scanner=new spbcMalwareScanner({settings:spbcScaner.settings,states:spbcScaner.states,button:jQuery("#spbc_perform_scan"),spinner:jQuery("#spbc_perform_scan").next(),callback:null,progress_overall:jQuery("#spbc_scaner_progress_overall"),progressbar:jQuery("#spbc_scaner_progress_bar"),progressbar_text:jQuery(".spbc_progressbar_counter span"),wrapper:document.getElementsByClassName("spbc_unchecked_file_list"),warnings:{long_scan:jQuery(".spbc_hint_warning__long_scan"),outdated:jQuery(".spbc_hint_warning__outdated")}}),jQuery(document).on("click",".spbc_popup_tip--icon---show",function(){spbc_popup_tip___show(jQuery(this))}),jQuery("#spbc_perform_scan").on("click",function(){spbc_scanner.actionControl()}),jQuery("#spbc_scanner_clear").on("click",function(){confirm("Do you wanna clear the table with file scan results?")&&(console.log("CLEAR"),spbc_sendAJAXRequest({action:"spbc_scanner_clear"},{type:"GET",successCallback:function(){document.location=document.location},complete:null,errorOutput:null,context:this,timeout:4e4}))})});
//# sourceMappingURL=spbc-settings_tab--scanner.min.js.map
