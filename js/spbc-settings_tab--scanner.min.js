function spbc_popup_tip___show(e){function n(e){void 0!==e&&(0!=jQuery(e.target).parent(".spbc_popup_tip--wrapper").length&&!jQuery(e.target).hasClass("spbc_popup_tip--icon---cancel")||jQuery(e.target).hasClass("spbc_popup_tip--icon---show"))||(jQuery(".spbc_popup_tip--wrapper").hide(),jQuery(document).off("click",n))}var s=e.attr("spbc_tip_title")||null,t=e.attr("spbc_tip_text")||null,o=(n(),e.after("<div class='spbc_popup_tip--wrapper'></div>"),jQuery(".spbc_popup_tip--wrapper"));o.empty().append("<div class='spbc_popup_tip--angle'></div>").css({top:e.position().top-2,left:e.position().left+25}),o.append("<i class='spbc_popup_tip--icon---cancel icon-cancel'></i>").append("<h3 class='spbc_popup_tip--title'>"+s+"</h3>").append("<p class='spbc_popup_tip--text'>"+t+"</p>"),jQuery(document).on("click",n),e.parents("tr").on("mouseout",n)}function spbc_scanner_button_file_view_event(e){var e=jQuery(e),n={action:"spbc_scanner_file_view",file_id:e.parents(".row-actions").attr("uid")},e={spinner:e.parent().siblings(".tbl-preloader--tiny"),callback:spbc_scannerButtonView_callback,errorOutput:function(e){spbcModal.open().putError(e)}};spbc_sendAJAXRequest(n,e)}function spbc_scanner_analysis_log_delete_from_log(e){var e=jQuery(e),n={action:"spbc_scanner_analysis_log_delete_from_log",file_id:e.parents(".row-actions").attr("uid")},e={spinner:e.parent().siblings(".tbl-preloader--tiny"),callback:window.location.reload(),errorOutput:function(e){spbcModal.open().putError(e)}};spbc_sendAJAXRequest(n,e)}function spbc_scanner_button_page_view_event(e){var e=jQuery(e),n={action:"spbc_scanner_page_view",page_url:e.parents(".row-actions").attr("uid")},e={spinner:e.parent().siblings(".tbl-preloader--tiny"),callback:spbc_scannerButtonView_callback,errorOutput:function(e){spbcModal.open().putError(e)}},s=jQuery("#wpwrap"),t=jQuery("#spbc_dialog"),o=(t.dialog({modal:!0,title:"Loading..",position:{my:"center top",at:"center top+100px",of:window},width:s.width()/100*90,show:{effect:"blind",duration:500},draggable:!1,resizable:!1,closeText:"X",classes:{"ui-dialog":"spbc---top"},open:function(e,n){e.target.style.overflow="auto",jQuery("#spbc_dialog").height(document.documentElement.clientHeight/100*25)},beforeClose:function(e,n){document.body.style.overflow="auto",jQuery("#spbc_dialog").empty()}}),t.append('<img id="spbc_file_view_preloader" alt="Wait for downloading" class="spbc_preloader" src="../../wp-content/plugins/security-malware-firewall/images/preloader2.gif" style="display: block; position: absolute; ">'),jQuery("#spbc_file_view_preloader")),s=4e-4*s.width();o.height(128*s),o.width(128*s),o.css({left:t.width()/2-128*s/2}),o.css({top:t.height()/2-128*s/2}),spbc_sendAJAXRequest(n,e)}function spbc_scannerButtonView_callback(e){var n,s=jQuery("#spbc_dialog");s.empty(),jQuery("#spbc_file_view_preloader").css({display:"none"});for(n in e.file)s.append('<div class="spbc_view_file_row_wrapper"><span class="spbc_view_file_row_num">%s</span><p class="spbc_view_file_row">%s</p><br /></div>'.printf(n,e.file[n]));let t=19*Object.keys(e.file).length<76?76:19*Object.keys(e.file).length,o=document.documentElement.clientHeight/100*75,r=t<o?"hidden":"scroll",a="scroll"==r?o:t;s.css({height:a,overflow:r}),s.dialog({modal:!0,title:"Loaded: "+e.file_path,position:{my:"center top",at:"center top+100px",of:window},width:jQuery("#wpwrap").width()/100*90,show:{effect:"blind",duration:500},draggable:!0,resizable:!1,closeText:"X",classes:{"ui-dialog":"spbc---top"},open:function(e,n){e.target.style.overflow=r,jQuery("#spbc_dialog").height(a)},beforeClose:function(e,n){document.body.style.overflow="auto",jQuery("#spbc_dialog").empty()}}),console.log("FILE_VIEWED")}function spbc_scanner_button_file_view_bad_event(e){var e=jQuery(e),n={action:"spbc_scanner_file_view",file_id:e.parents(".row-actions").attr("uid")},e={spinner:e.parent().siblings(".tbl-preloader--tiny"),callback:spbc_scannerButtonViewBadFile_callback,errorOutput:function(e){spbcModal.open().putError(e)}};spbc_sendAJAXRequest(n,e)}function spbc_scanner_button_page_view_bad_event(e){var e=jQuery(e),n={action:"spbc_scanner_page_view",page_url:e.parent().attr("uid")},e={spinner:e.parent().siblings(".tbl-preloader--tiny"),callback:spbc_scannerButtonViewBad_callback,errorOutput:function(e){spbcModal.open().putError(e)}};spbc_sendAJAXRequest(n,e)}function spbc_scannerButtonViewBadFile_callback(n,e,s){console.log("FILE_VIEWED_BAD_CODE_FILE"),console.log(arguments),jQuery("#spbc_dialog").empty();var t,o,r='<div class="spbc_view_file_row_wrapper"><span class="spbc_view_file_row_num">%s</span><p class="spbc_view_file_row">%s</p><br /></div>',a=[];for(t in n.weak_spots=JSON.parse(n.weak_spots),n.weak_spots)a=a.concat(Object.keys(n.weak_spots[t]));for(o in a=[...new Set(a)].sort()){var c=+a[o];for(let e=c-2;e<=2+c;e++)void 0!==n.file[e]&&jQuery("#spbc_dialog").append((c===e?'<div class="spbc_view_file_row_wrapper" style="background: rgba(200,40,40,0.8);"><span class="spbc_view_file_row_num">%s</span><p class="spbc_view_file_row">%s</p><br /></div>':r).printf(e,n.file[e]));jQuery("#spbc_dialog").append(r.printf("",""))}jQuery("#spbc_dialog div").last().remove();let p=19*jQuery("#spbc_dialog div").length<76?76:19*jQuery("#spbc_dialog div").length,i=document.documentElement.clientHeight/100*75,l=p<i?"no_scroll":"scroll",_="scroll"==l?i:p;jQuery("#spbc_dialog").dialog({modal:!0,title:n.file_path,position:{my:"center top",at:"center top+100px",of:window},width:jQuery("#wpwrap").width()/100*90,show:{effect:"blind",duration:500},draggable:!0,resizable:!1,closeText:"X",classes:{"ui-dialog":"spbc---top"},open:function(e,n){e.target.style.overflow=l,jQuery("#spbc_dialog").height(_)},beforeClose:function(e,n){document.body.style.overflow="auto",jQuery("#spbc_dialog").empty()}})}function spbc_scannerButtonViewBad_callback(t,e,n){console.log("FILE_VIEWED_BAD_CODE"),console.log(arguments);let s=()=>{};if(1==t.success){console.log(t);var o,r='<div class="spbc_view_file_row_wrapper"><span class="spbc_view_file_row_num">%s</span><p class="spbc_view_file_row" style="word-break: break-all">%s</p><br /></div>',a=[];for(o in t.weak_spots=JSON.parse(t.weak_spots),t.weak_spots)a=a.concat(Object.keys(t.weak_spots[o]));var c,a=[...new Set(a)].sort(),p=new Map(Object.entries(t.weak_spots.CRITICAL));for(c in a){var i=+a[c];for(let s=i-2;s<=2+i;s++)if(void 0!==t.file[s]){var l=i===s;let e,n;e=l?'<div class="spbc_view_file_row_wrapper" style="background: rgb(200,120,120);"><span class="spbc_view_file_row_num">%s</span><p class="spbc_view_file_row" style="word-break: break-all">%s</p><br /></div>':r,n=l?e.printf(s,p.get(a[c])):e.printf(s,t.file[s]),jQuery("#spbc_dialog").append(n)}jQuery("#spbc_dialog").append(r.printf("","")),jQuery("#spbc_dialog div").last().remove()}}else jQuery("#spbc_dialog").append('<div style="margin:40px;text-align:center;">%s</div>'.printf(t.content)),s=()=>{document.location.reload()};let _=19*jQuery("#spbc_dialog div").length<76?76:19*jQuery("#spbc_dialog div").length,d=document.documentElement.clientHeight/100*75,u=_<d?"no_scroll":"scroll";jQuery("#spbc_dialog").dialog({modal:!0,title:t.file_path,position:{my:"center top",at:"center top+100px",of:window},width:jQuery("#wpwrap").width()/100*90,show:{effect:"blind",duration:500},draggable:!0,resizable:!1,closeText:"X",classes:{"ui-dialog":"spbc---top"},open:function(e,n){e.target.style.overflow=u,jQuery("#spbc_dialog").height("auto")},beforeClose:function(e,n){document.body.style.overflow="auto",jQuery("#spbc_dialog").empty()},close:s})}function spbc_scanner_button_page_approve(e){var e=jQuery(e),n={action:"spbc_scanner_page_approve",page_url:e.parent().attr("uid"),page_id:e.parent().parent().siblings(".page_id").text()},e={spinner:e.parent().siblings(".tbl-preloader--tiny"),callback:()=>{window.location.reload()},errorOutput:function(e){spbcModal.open().putError(e)}};spbc_sendAJAXRequest(n,e)}function spbc_scanner_button_file_compare_event(e){var e=jQuery(e),n={action:"spbc_scanner_file_compare",file_id:e.parents(".row-actions").attr("uid")},e={spinner:e.parent().siblings(".tbl-preloader--tiny"),callback:spbc_scannerButtonFileCompare_callback,errorOutput:function(e){spbcModal.open().putError(e)}};spbc_sendAJAXRequest(n,e)}function spbc_scannerButtonFileCompare_callback(n,e,s){console.log("FILE_COMPARED");var t='<div class="spbc_compare_file_row_wrapper"><p class="spbc_compare_file_row">%s</p><span class="spbc_compare_file_row_num">%s</span><p class="spbc_compare_file_row">%s</p><br /></div>';jQuery("#spbc_dialog").append(t.printf('<span class="spbc_compare_file_headings">Modified</span>',"Line",'<span class="spbc_compare_file_headings">Original</span>'));for(var o=1;void 0!==n.file[o]||void 0!==n.file_original[o];o++)if(void 0===n.file[o]&&(n.file[o]=""),void 0===n.file_original[o]&&(n.file_original[o]=""),-1!=n.difference.indexOf(o)){for(let e=o-2;e<=o+2;e++)void 0!==n.file[e]&&void 0!==n.file_original[o]&&jQuery("#spbc_dialog").append((o===e?'<div class="spbc_compare_file_row_wrapper" style="background: rgba(200,40,40,0.8);"><p class="spbc_compare_file_row">%s</p><span class="spbc_compare_file_row_num">%s</span><p class="spbc_compare_file_row">%s</p><br /></div>':t).printf(n.file[e]||"",e,n.file_original[e]||""));jQuery("#spbc_dialog").append(t.printf("","",""))}var r=19*jQuery("#spbc_dialog div").length+19,a=document.documentElement.clientHeight/100*75,c=r<a?"no_scroll":"scroll",p="scroll"==c?a:r;jQuery("#spbc_dialog").dialog({modal:!0,title:n.file_path,position:{my:"center top",at:"center top+100px",of:window},width:jQuery("#wpwrap").width()/100*90,height:p,show:{effect:"blind",duration:500},draggable:!0,resizable:!0,closeText:"X",classes:{"ui-dialog":"spbc---top"},open:function(e,n){document.body.style.overflow="hidden",e.target.style.overflow=c,jQuery("#spbc_dialog").height(p)},beforeClose:function(e,n){document.body.style.overflow="auto",jQuery("#spbc_dialog").empty()}})}function spbc_scanner__reload_scan_info(){jQuery(".spbc_hint__last_scan_title").text(spbcScaner.look_below_for_scan_res);spbc_sendAJAXRequest({action:"spbc_scanner__last_scan_info"},{callback:e=>{document.getElementById("spbc_scanner__last_scan_info").innerText=e.data}})}let spbcScannerFrontendMalwareSendInProgress=!1;function spbc_scanner__frontend_malware_send_button(e){spbcScannerFrontendMalwareSendInProgress=!0;e={action:"spbc_scanner_page_send",id:e.href};spbc_sendAJAXRequest(e,{callback:e=>{jQuery("#spbc_scanner__frontend_malware_send_url").val(""),spbc_scanner__frontend_malware_send_error(e.data),spbcScannerFrontendMalwareSendInProgress=!1}})}function spbc_scanner__frontend_malware_send_error(e){jQuery("#spbc_scanner__frontend_malware_send_result").text(e),setTimeout(function(){jQuery("#spbc_scanner__frontend_malware_send_result").text("")},3e3)}jQuery(document).ready(function(){spbc_tbl__bulk_actions__listen(),spbc_tbl__row_actions__listen(),spbc_tbl__pagination__listen(),spbc_tbl__sort__listen(),spbcStartShowHide(),jQuery("#spbc_scaner_progress_bar").progressbar({value:0,create:function(e,n){e.target.style.position="relative",e.target.style.marginBottom="12px"},change:function(e,n){jQuery(".spbc_progressbar_counter span").text(jQuery(e.target).progressbar("option","value")+" %")}}),jQuery("#spbc_scan_accordion").accordion({header:"h3",heightStyle:"content",collapsible:!0,active:!1,activate:function(e,n){0===n.oldPanel.length&&0===n.oldHeader.length&&jQuery("#spbc_scan_accordion").accordion("option","classes.ui-accordion-content","ui-corner-bottom spbc-overflow--visible")},beforeActivate:function(e,n){1===n.oldPanel.length&&1===n.oldHeader.length&&jQuery("#spbc_scan_accordion").accordion("option","classes.ui-accordion-content","ui-corner-bottom")}}),window.spbc_scanner=new spbcMalwareScanner({settings:spbcScaner.settings,states:spbcScaner.states,button:jQuery("#spbc_perform_scan"),spinner:jQuery("#spbc_perform_scan").next(),callback:null,progress_overall:jQuery("#spbc_scaner_progress_overall"),progressbar:jQuery("#spbc_scaner_progress_bar"),progressbar_text:jQuery(".spbc_progressbar_counter span"),wrapper:document.getElementsByClassName("spbc_unchecked_file_list"),warnings:{long_scan:jQuery(".spbc_hint_warning__long_scan"),outdated:jQuery(".spbc_hint_warning__outdated")}}),jQuery(document).on("click",".spbc_popup_tip--icon---show",function(){spbc_popup_tip___show(jQuery(this))}),jQuery("#spbc_perform_scan").on("click",function(){jQuery("#spbcscan-results-log-module").remove(),spbc_scanner.actionControl(),jQuery(".spbc_log-wrapper .panel-body").length||jQuery(".spbc_log-wrapper").append('<div class="panel-body"></div>'),jQuery(".spbc_log-wrapper").resizable({handles:"n, s",containment:"document"})}),jQuery("#spbcscan-results-log-module").resizable({handles:"n, s",containment:"document"}),jQuery("#spbc_scanner_clear").on("click",function(){confirm("Do you wanna clear the table with file scan results?")&&(console.log("CLEAR"),spbc_sendAJAXRequest({action:"spbc_scanner_clear"},{type:"GET",successCallback:function(){document.location=document.location},complete:null,errorOutput:null,context:this,timeout:4e4}))}),jQuery("#spbc_scanner_save_to_pdf").on("click",function(){jQuery.ajax({url:spbcSettings.ajaxurl,type:"POST",data:{action:"spbc_scanner_save_to_pdf",security:spbcSettings.ajax_nonce,no_cache:Math.random()},xhrFields:{responseType:"blob"},success:function(t){jQuery.ajax({url:spbcSettings.ajaxurl,type:"POST",data:{action:"spbc_scanner_get_pdf_file_name",security:spbcSettings.ajax_nonce,no_cache:Math.random()},xhrFields:{responseType:"text"},success:function(e){var n=new Blob([t]),s=document.createElement("a");s.href=window.URL.createObjectURL(n),s.download=e.data,s.click()}})}})}),jQuery("#spbc_scanner__frontend_malware_send_button").on("click",function(e){e.preventDefault();e=jQuery("#spbc_scanner__frontend_malware_send_url").val();try{return spbc_scanner__frontend_malware_send_button(new URL(e))}catch(e){return spbc_scanner__frontend_malware_send_error("Provided URL is invalid")}})});
//# sourceMappingURL=spbc-settings_tab--scanner.min.js.map
