{"version":3,"file":"spbc-table.min.js","sources":["spbc-table.js"],"sourcesContent":["spbc_bulk_action = null;\n\n// TABLE BULK ACTIONS\nfunction spbc_tbl__bulk_actions__listen(){\n\n\tjQuery('.tbl-bulk_actions-all--apply').on('click', function(){\n\n\t\tvar self = jQuery(this);\n\t\tvar allowed_bulk_actions = ['approve','disapprove'];\n\t\tvar action = self.siblings('select').children()[self.siblings('select').first()[0].selectedIndex].value;\n\t\tconsole.log(self);\n\t\tif( allowed_bulk_actions.indexOf( action ) !== -1 ){\n\n\t\t\tif(!confirm(spbcTable.warning_bulk))\n\t\t\t\treturn;\n\n\t\t\tconsole.log('spbc_tbl__bulk_action_all__listen click');\n\t\t\tvar data = {\n\t\t\t\taction: 'spbc_tbl-action--bulk',\n\t\t\t\tadd_action: action,\n\t\t\t\tstatus: self.parents('.tbl-root').attr('type'),\n\t\t\t};\n\t\t\tvar params = {\n\t\t\t\tbutton: this,\n\t\t\t\tspinner: self.children('.tbl-preloader--small'),\n\t\t\t};\n\n\t\t\tspbc_sendAJAXRequest(data, params);\n\n\t\t}else{\n\t\t\talert('This action is not supported for all files yet =(')\n\t\t}\n\t});\n\n\tjQuery('.tbl-bulk_actions--apply').on('click', function(){\n\n\t\tif(!spbc_bulk_action && !confirm(spbcTable.warning_bulk))\n\t\t\treturn;\n\n\t\tvar self = spbc_bulk_action || jQuery(this);\n\t\tspbc_bulk_action = self;\n\t\tvar action = self.siblings('select').children()[self.siblings('select').first()[0].selectedIndex].value;\n\t\tif( action !== '-1' && self.parents('.tbl-root').find('.cb-select').is(':checked') ){\n\t\t\tself.children('.tbl-preloader--small').show();\n\t\t\tif(self.parents('.tbl-root').find('.cb-select:checked').first().parents('tr').find('.tbl-row_action--'+action)[0]){\n\t\t\t\tself.parents('.tbl-root').find('.cb-select:checked').first().parents('tr').find('.tbl-row_action--'+action).click();\n\t\t\t\tself.parents('.tbl-root').find('.cb-select:checked').first().prop('checked', false);\n\t\t\t}else{\n\t\t\t\tself.parents('.tbl-root').find('.cb-select:checked').first().prop('checked', false);\n\t\t\t\tself.click();\n\t\t\t}\n\t\t}else{\n\t\t\tself.children('.tbl-preloader--small').hide();\n\t\t\tspbc_bulk_action = null;\n\t\t}\n\t});\n}\t\n\n// TABLE ROW ACTIONS\nfunction spbc_tbl__row_actions__listen(){\n\tjQuery('.tbl-row_action--ajax').on('click', function(){\n\t\tconsole.log('spbc_tbl__row_actions__listen click');\n\t\tvar self = jQuery(this);\n\t\tvar data = {\n\t\t\taction: 'spbc_tbl-action--row',\n\t\t\tadd_action: self.attr('row-action'),\n\t\t\tid: self.parents('.row-actions').attr('uid'),\n\t\t\tcols: self.parents('.row-actions').attr('cols_amount'),\n\t\t};\n\t\tvar params = {\n\t\t\tcallback: spbc_tbl__row_actions__callback,\n\t\t\tspinner: self.parents('.row-actions').children('.tbl-preloader--tiny'),\n\t\t};\n\t\tif(!spbc_bulk_action){\n\t\t\tvar confirmation = spbcTable['warning_'+self.attr('row-action')] || spbcTable.warning_default;\n\t\t\tif(confirm(confirmation))\n\t\t\t\tspbc_sendAJAXRequest(data, params, self.parents('tr'));\n\t\t}\n\t\tif(spbc_bulk_action){\n\t\t\tspbc_sendAJAXRequest(data, params, self.parents('tr'));\n\t\t}\n\t});\n}\n\n\t// Callback for TABLE ROW ACTIONS\nfunction spbc_tbl__row_actions__callback(result, data, params, obj){\n\tif(result.color)    {obj.css({background: result.background, color: result.color});}\n\tif(result.html)     {obj.html(result.html); setTimeout(function(){obj.fadeOut(300);}, 1500);}\n\tif(result.temp_html){\n\t\tvar tmp=obj.html(); \n\t\tobj.html(result.temp_html);\n\t\tsetTimeout(function(){\n\t\t\tobj.html(tmp).css({background: 'inherit'}).find('.column-primary .row-actions .tbl-row_action--'+data.add_action).remove();\n\t\t},5000);\n\t}\n\tif(spbc_bulk_action)\n\t\tspbc_bulk_action.click();\n}\n\n// TABLE PAGINATION ACTIONS\nfunction spbc_tbl__pagination__listen(){\n\tvar data = {action: 'spbc_tbl-pagination',};\n\tvar params = {callback: spbc_tbl__pagination__callback, notJson: true,};\n\tjQuery('.tbl-pagination--button').on('click', function(){\n\t\tjQuery(this).parents('.tbl-root').find('.tbl-pagination--button').attr('disabled', 'disabled');\n\t});\n\tjQuery('.tbl-pagination--go').on('click', function(){\n\t\tvar self = jQuery(this);\n\t\tvar obj = self.parents('.tbl-root');\n\t\tdata.page = self.siblings('.tbl-pagination--curr_page').val();\n\t\tdata.args = eval('args_'+obj.attr('id'));\n\t\tparams.spinner = self.siblings('.tbl-preloader--small');\n\t\tspbc_sendAJAXRequest(data, params, obj);\n\t});\n\tjQuery('.tbl-pagination--prev').on('click', function(){\n\t\tvar self = jQuery(this);\n\t\tvar obj = self.parents('.tbl-root');\n\t\tdata.page=self.parents('.tbl-pagination--wrapper').attr('prev_page');\n\t\tdata.args=eval('args_'+obj.attr('id'));\n\t\tparams.spinner = self.siblings('.tbl-preloader--small');\n\t\tspbc_sendAJAXRequest(data, params, obj);\n\t});\n\tjQuery('.tbl-pagination--next').on('click', function(){\n\t\tvar self = jQuery(this);\n\t\tvar obj = self.parents('.tbl-root');\n\t\tdata.page=self.parents('.tbl-pagination--wrapper').attr('next_page');\n\t\tdata.args=eval('args_'+obj.attr('id'));\n\t\tparams.spinner = self.siblings('.tbl-preloader--small');\n\t\tspbc_sendAJAXRequest(data, params, obj);\n\t});\n\tjQuery('.tbl-pagination--end').on('click', function(){\n\t\tvar self = jQuery(this);\n\t\tvar obj = self.parents('.tbl-root');\n\t\tdata.page=self.parents('.tbl-pagination--wrapper').attr('last_page');\n\t\tdata.args=eval('args_'+obj.attr('id'));\n\t\tparams.spinner = self.siblings('.tbl-preloader--small');\n\t\tspbc_sendAJAXRequest(data, params, obj);\n\t});\n\tjQuery('.tbl-pagination--start').on('click', function(){\n\t\tvar self = jQuery(this);\n\t\tvar obj = self.parents('.tbl-root');\n\t\tdata.page=1;\n\t\tdata.args=eval('args_'+obj.attr('id'));\n\t\tparams.spinner = self.siblings('.tbl-preloader--small');\n\t\tspbc_sendAJAXRequest(data, params, obj);\n\t});\n}\n\nfunction spbc_scanner__switch_table(obj, table){\n\tvar obj = jQuery(obj);\n\tconsole.log(obj.parents('.row-actions').attr('uid'));\n\tvar data = {action: 'spbc_tbl-switch', table: table, test: 'test', domain: obj.parents('.row-actions').attr('uid'),};\n\tvar params = {callback: spbc_tbl__pagination__callback, notJson: true,};\n\tspbc_sendAJAXRequest(data, params, obj.parents('.tbl-root'));\n}\n\n\t// Callback for TABLE PAGINATION ACTIONS\nfunction spbc_tbl__pagination__callback(result, data, params, obj){\n\t\n\tjQuery(obj)\n\t\t.html(result)\n\t\t.find('.tbl-pagination--button').removeAttr('disabled');\n\tspbc_tbl__bulk_actions__listen();\n\tspbc_tbl__row_actions__listen();\n\tspbc_tbl__pagination__listen();\n\tspbc_tbl__sort__listen();\n\tspbcStartShowHide();\n}\n\n// TABLE SORT ACTIONS\nfunction spbc_tbl__sort__listen(){\n\t\n\tvar params = {callback: spbc_tbl__sort__callback, notJson: true,};\n\tjQuery('.tbl-column-sortable').on('click', function(){\n\t\tvar self = jQuery(this);\n\t\tvar obj = self.parents('.tbl-root');\n\t\tvar data = {\n\t\t\taction: 'spbc_tbl-sort',\n\t\t\torder_by: self.attr('id'),\n\t\t\torder: self.attr('sort_direction'),\n\t\t\targs: eval('args_'+obj.attr('id')),\n\t\t};\n\t\tspbc_sendAJAXRequest(data, params, obj);\n\t});\n}\n\n\t// Callback for TABLE SORT ACTIONS\nfunction spbc_tbl__sort__callback(result, data, params, obj){\n\tjQuery(obj).html(result);\n\tspbc_tbl__bulk_actions__listen();\n\tspbc_tbl__row_actions__listen();\n\tspbc_tbl__pagination__listen();\n\tspbc_tbl__sort__listen();\n}\n\njQuery(document).ready(function(){\n\t\n\t// Table. Row actions handler\n\tspbc_tbl__bulk_actions__listen();\n\tspbc_tbl__row_actions__listen();\n\tspbc_tbl__pagination__listen();\n\tspbc_tbl__sort__listen();\n});"],"names":["spbc_tbl__bulk_actions__listen","jQuery","on","self","this","action","siblings","children","first","selectedIndex","value","console","log","indexOf","confirm","spbcTable","warning_bulk","data","add_action","status","parents","attr","params","button","spinner","spbc_sendAJAXRequest","alert","spbc_bulk_action","find","is","show","click","prop","hide","spbc_tbl__row_actions__listen","confirmation","id","cols","callback","spbc_tbl__row_actions__callback","warning_default","result","obj","tmp","color","css","background","html","setTimeout","fadeOut","temp_html","remove","spbc_tbl__pagination__listen","spbc_tbl__pagination__callback","notJson","page","val","args","eval","spbc_scanner__switch_table","table","test","domain","removeAttr","spbc_tbl__sort__listen","spbcStartShowHide","spbc_tbl__sort__callback","order_by","order","document","ready"],"mappings":"AAGA,SAASA,iCAERC,OAAO,gCAAgCC,GAAG,QAAS,WAElD,IAAIC,EAAOF,OAAOG,MAEdC,EAASF,EAAKG,SAAS,UAAUC,WAAWJ,EAAKG,SAAS,UAAUE,QAAQ,GAAGC,eAAeC,MAClGC,QAAQC,IAAIT,IACoC,IAHrB,CAAC,UAAU,cAGbU,QAASR,GAE7BS,QAAQC,UAAUC,gBAGtBL,QAAQC,IAAI,2CACRK,EAAO,CACVZ,OAAQ,wBACRa,WAAYb,EACZc,OAAQhB,EAAKiB,QAAQ,aAAaC,KAAK,SAEpCC,EAAS,CACZC,OAAQnB,KACRoB,QAASrB,EAAKI,SAAS,0BAGxBkB,qBAAqBR,EAAMK,IAG3BI,MAAM,uDAIRzB,OAAO,4BAA4BC,GAAG,QAAS,WAE9C,IAGIC,EAEAE,GALAsB,kBAAqBb,QAAQC,UAAUC,iBAGvCb,EAAOwB,kBAAoB1B,OAAOG,MAGvB,QADXC,GADJsB,iBAAmBxB,GACDG,SAAS,UAAUC,WAAWJ,EAAKG,SAAS,UAAUE,QAAQ,GAAGC,eAAeC,QAC3EP,EAAKiB,QAAQ,aAAaQ,KAAK,cAAcC,GAAG,aACtE1B,EAAKI,SAAS,yBAAyBuB,OACpC3B,EAAKiB,QAAQ,aAAaQ,KAAK,sBAAsBpB,QAAQY,QAAQ,MAAMQ,KAAK,oBAAoBvB,GAAQ,IAC9GF,EAAKiB,QAAQ,aAAaQ,KAAK,sBAAsBpB,QAAQY,QAAQ,MAAMQ,KAAK,oBAAoBvB,GAAQ0B,QAC5G5B,EAAKiB,QAAQ,aAAaQ,KAAK,sBAAsBpB,QAAQwB,KAAK,WAAW,KAE7E7B,EAAKiB,QAAQ,aAAaQ,KAAK,sBAAsBpB,QAAQwB,KAAK,WAAW,GAC7E7B,EAAK4B,WAGN5B,EAAKI,SAAS,yBAAyB0B,OACvCN,iBAAmB,SAMtB,SAASO,gCACRjC,OAAO,yBAAyBC,GAAG,QAAS,WAC3CS,QAAQC,IAAI,uCACZ,IAYKuB,EAZDhC,EAAOF,OAAOG,MACda,EAAO,CACVZ,OAAQ,uBACRa,WAAYf,EAAKkB,KAAK,cACtBe,GAAIjC,EAAKiB,QAAQ,gBAAgBC,KAAK,OACtCgB,KAAMlC,EAAKiB,QAAQ,gBAAgBC,KAAK,gBAErCC,EAAS,CACZgB,SAAUC,gCACVf,QAASrB,EAAKiB,QAAQ,gBAAgBb,SAAS,yBAE5CoB,mBACCQ,EAAepB,UAAU,WAAWZ,EAAKkB,KAAK,gBAAkBN,UAAUyB,gBAC3E1B,QAAQqB,IACVV,qBAAqBR,EAAMK,EAAQnB,EAAKiB,QAAQ,QAE/CO,kBACFF,qBAAqBR,EAAMK,EAAQnB,EAAKiB,QAAQ,SAMnD,SAASmB,gCAAgCE,EAAQxB,EAAMK,EAAQoB,GAG9D,IACKC,EAHFF,EAAOG,OAAWF,EAAIG,IAAI,CAACC,WAAYL,EAAOK,WAAYF,MAAOH,EAAOG,QACxEH,EAAOM,OAAWL,EAAIK,KAAKN,EAAOM,MAAOC,WAAW,WAAWN,EAAIO,QAAQ,MAAQ,OACnFR,EAAOS,YACLP,EAAID,EAAIK,OACZL,EAAIK,KAAKN,EAAOS,WAChBF,WAAW,WACVN,EAAIK,KAAKJ,GAAKE,IAAI,CAACC,WAAY,YAAYlB,KAAK,iDAAiDX,EAAKC,YAAYiC,UACjH,MAEAxB,kBACFA,iBAAiBI,QAInB,SAASqB,+BACR,IAAInC,KAAO,CAACZ,OAAQ,uBAChBiB,OAAS,CAACgB,SAAUe,+BAAgCC,SAAS,GACjErD,OAAO,2BAA2BC,GAAG,QAAS,WAC7CD,OAAOG,MAAMgB,QAAQ,aAAaQ,KAAK,2BAA2BP,KAAK,WAAY,cAEpFpB,OAAO,uBAAuBC,GAAG,QAAS,WACzC,IAAIC,KAAOF,OAAOG,MACdsC,IAAMvC,KAAKiB,QAAQ,aACvBH,KAAKsC,KAAOpD,KAAKG,SAAS,8BAA8BkD,MACxDvC,KAAKwC,KAAOC,KAAK,QAAQhB,IAAIrB,KAAK,OAClCC,OAAOE,QAAUrB,KAAKG,SAAS,yBAC/BmB,qBAAqBR,KAAMK,OAAQoB,OAEpCzC,OAAO,yBAAyBC,GAAG,QAAS,WAC3C,IAAIC,KAAOF,OAAOG,MACdsC,IAAMvC,KAAKiB,QAAQ,aACvBH,KAAKsC,KAAKpD,KAAKiB,QAAQ,4BAA4BC,KAAK,aACxDJ,KAAKwC,KAAKC,KAAK,QAAQhB,IAAIrB,KAAK,OAChCC,OAAOE,QAAUrB,KAAKG,SAAS,yBAC/BmB,qBAAqBR,KAAMK,OAAQoB,OAEpCzC,OAAO,yBAAyBC,GAAG,QAAS,WAC3C,IAAIC,KAAOF,OAAOG,MACdsC,IAAMvC,KAAKiB,QAAQ,aACvBH,KAAKsC,KAAKpD,KAAKiB,QAAQ,4BAA4BC,KAAK,aACxDJ,KAAKwC,KAAKC,KAAK,QAAQhB,IAAIrB,KAAK,OAChCC,OAAOE,QAAUrB,KAAKG,SAAS,yBAC/BmB,qBAAqBR,KAAMK,OAAQoB,OAEpCzC,OAAO,wBAAwBC,GAAG,QAAS,WAC1C,IAAIC,KAAOF,OAAOG,MACdsC,IAAMvC,KAAKiB,QAAQ,aACvBH,KAAKsC,KAAKpD,KAAKiB,QAAQ,4BAA4BC,KAAK,aACxDJ,KAAKwC,KAAKC,KAAK,QAAQhB,IAAIrB,KAAK,OAChCC,OAAOE,QAAUrB,KAAKG,SAAS,yBAC/BmB,qBAAqBR,KAAMK,OAAQoB,OAEpCzC,OAAO,0BAA0BC,GAAG,QAAS,WAC5C,IAAIC,KAAOF,OAAOG,MACdsC,IAAMvC,KAAKiB,QAAQ,aACvBH,KAAKsC,KAAK,EACVtC,KAAKwC,KAAKC,KAAK,QAAQhB,IAAIrB,KAAK,OAChCC,OAAOE,QAAUrB,KAAKG,SAAS,yBAC/BmB,qBAAqBR,KAAMK,OAAQoB,OAIrC,SAASiB,2BAA2BjB,EAAKkB,GACpClB,EAAMzC,OAAOyC,GACjB/B,QAAQC,IAAI8B,EAAItB,QAAQ,gBAAgBC,KAAK,QACzCJ,EAAO,CAACZ,OAAQ,kBAAmBuD,MAAOA,EAAOC,KAAM,OAAQC,OAAQpB,EAAItB,QAAQ,gBAAgBC,KAAK,QAE5GI,qBAAqBR,EADR,CAACqB,SAAUe,+BAAgCC,SAAS,GAC9BZ,EAAItB,QAAQ,cAIhD,SAASiC,+BAA+BZ,EAAQxB,EAAMK,EAAQoB,GAE7DzC,OAAOyC,GACLK,KAAKN,GACLb,KAAK,2BAA2BmC,WAAW,YAC7C/D,iCACAkC,gCACAkB,+BACAY,yBACAC,oBAID,SAASD,yBAER,IAAI1C,OAAS,CAACgB,SAAU4B,yBAA0BZ,SAAS,GAC3DrD,OAAO,wBAAwBC,GAAG,QAAS,WAC1C,IAAIC,KAAOF,OAAOG,MACdsC,IAAMvC,KAAKiB,QAAQ,aACnBH,KAAO,CACVZ,OAAQ,gBACR8D,SAAUhE,KAAKkB,KAAK,MACpB+C,MAAOjE,KAAKkB,KAAK,kBACjBoC,KAAMC,KAAK,QAAQhB,IAAIrB,KAAK,QAE7BI,qBAAqBR,KAAMK,OAAQoB,OAKrC,SAASwB,yBAAyBzB,EAAQxB,EAAMK,EAAQoB,GACvDzC,OAAOyC,GAAKK,KAAKN,GACjBzC,iCACAkC,gCACAkB,+BACAY,yBAhMDrC,iBAAmB,KAmMnB1B,OAAOoE,UAAUC,MAAM,WAGtBtE,iCACAkC,gCACAkB,+BACAY"}