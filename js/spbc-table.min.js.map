{"version":3,"file":"spbc-table.min.js","sources":["spbc-table.js"],"sourcesContent":["spbc_bulk_action = null;\n\n/**\n * Reloads scanner accordion and set all the listeners\n */\nfunction spbc_reload_accordion(){\n\tspbc_sendAJAXRequest(\n\t\t{action: 'spbc_scanner_tab__reload_accordion'},\n\t\t{\n\t\t\tnotJson: true,\n\t\t\tcallback: function(result, data, params, obj){\n\t\t\t\tjQuery(obj).accordion('destroy');\n\t\t\t\tjQuery(obj).html(result);\n\t\t\t\tjQuery(obj).accordion({\n\t\t\t\t\theader: 'h3',\n\t\t\t\t\theightStyle: 'content',\n\t\t\t\t\tcollapsible: true,\n\t\t\t\t\tactive: false,\n\t\t\t\t});\n\t\t\t\tspbc_tbl__bulk_actions__listen();\n\t\t\t\tspbc_tbl__row_actions__listen();\n\t\t\t\tspbc_tbl__pagination__listen();\n\t\t\t\tspbc_tbl__sort__listen();\n\t\t\t\tspbcStartShowHide();\n\t\t\t},\n\t\t},\n\t\tjQuery('#spbc_scan_accordion')\n\t);\n}\n\n// TABLE BULK ACTIONS\nfunction spbc_tbl__bulk_actions__listen(){\n\n\tjQuery('.tbl-bulk_actions-all--apply')\n\t\t.off('click')\n\t\t.on('click', function(){\n\n\t\tif ( spbc_scanner.active ) {\n\t\t\talert(spbcTableLocalize.scannerIsActive);\n\t\t\treturn;\n\t\t}\n\n\t\tvar self = jQuery(this);\n\t\tvar allowed_bulk_actions = ['approve','disapprove','send','check_analysis_status','approve_page','disapprove_page','cure', 'delete_from_analysis_log'];\n\t\tvar action = self.siblings('select').children()[self.siblings('select').first()[0].selectedIndex].value;\n\n\t\tif( allowed_bulk_actions.indexOf( action ) !== -1 ){\n\n\t\t\tif(!confirm(spbcTable.warning_bulk))\n\t\t\t\treturn;\n\n\t\t\tvar data = {\n\t\t\t\taction: 'spbc_tbl-action--bulk',\n\t\t\t\tadd_action: action,\n\t\t\t\tstatus: self.parents('.tbl-root').attr('type'),\n\t\t\t};\n\n\t\t\tif (action === 'cure') {\n\t\t\t\tconst selectedItems = self.closest('#spbc_tbl__scanner_cure_log').find('.cb-select');\n\t\t\t\tlet selectedIds = [];\n\n\t\t\t\tselectedItems.each(function (index, element) {\n\t\t\t\t\tconst elementId = jQuery(element).val();\n\t\t\t\t\tselectedIds.push(elementId);\n\t\t\t\t});\n\t\t\t\tdata.selectedIds = selectedIds;\n\t\t\t}\n\n\t\t\tif (action === 'delete_from_analysis_log') {\n\t\t\t\tconst selectedItems = self.closest('#spbc_tbl__scanner_analysis_log').find('.cb-select');\n\t\t\t\tlet fileIds = [];\n\n\t\t\t\tselectedItems.each(function (index, element) {\n\t\t\t\t\tconst elementId = jQuery(element).val();\n\t\t\t\t\tfileIds.push(elementId);\n\t\t\t\t});\n\t\t\t\tdata.file_ids = fileIds;\n\t\t\t}\n\n\t\t\tvar params = {\n\t\t\t\tbutton: this,\n\t\t\t\tspinner: self.children('.tbl-preloader--small'),\n\t\t\t\tcallback: function(out) {\n\t\t\t\t\tspbc_reload_accordion();\n\t\t\t\t\tif ( action === 'check_analysis_status' && typeof out !== undefined){\n\t\t\t\t\t\tlet html = '<p> Analysis status updated.'\n\t\t\t\t\t\t\t+ ' Total: ' +  out.counters.total\n\t\t\t\t\t\t\t+ ', updated: ' +  out.counters.updated\n\t\t\t\t\t\t\t+ ', skipped: ' +  out.counters.skipped\n\t\t\t\t\t\t\t+ ', failed: ' + out.counters.failed\n\t\t\t\t\t\t\t+ ', queued: ' +  out.counters.queued\n\t\t\t\t\t\t\t+ '</p>';\n\t\t\t\t\t\tspbcModal.open().put( html );\n\t\t\t\t\t}\n\t\t\t\t\tif ( action === 'send' && typeof out !== undefined){\n\t\t\t\t\t\tlet html = '<p> Files have been sent: '\n\t\t\t\t\t\t\t+ out.files_sent_counter\n\t\t\t\t\t\t\t+ '</p>';\n\t\t\t\t\t\tspbcModal.open().put( html );\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\terrorOutput: function( error_text, comment ){\n\t\t\t\t\tif( comment ){\n\t\t\t\t\t\terror_text = error_text + '<br>Additional information:<br>' + comment;\n\t\t\t\t\t}\n\t\t\t\t\tspbcModal.open().putError( error_text );\n\t\t\t\t},\n\t\t\t\ttimeout: 60000,\n\t\t\t};\n\n\t\t\tspbc_sendAJAXRequest(data, params);\n\n\t\t}else{\n\t\t\talert('This action is not supported for all files yet =(')\n\t\t}\n\t});\n\n\tjQuery('.tbl-bulk_actions--apply')\n\t\t.off('click')\n\t\t.on('click', function(e){\n\n\t\tif(!spbc_bulk_action && !confirm(spbcTable.warning_bulk))\n\t\t\treturn;\n\n\t\tvar self = spbc_bulk_action || jQuery(this);\n\t\tspbc_bulk_action = self;\n\t\tvar action = self.siblings('select').children()[self.siblings('select').first()[0].selectedIndex].value;\n\n\t\tif (action === 'cure') {\n\t\t\tspbc_scanner__cure_selected(jQuery(this));\n\t\t\treturn;\n\t\t}\n\n\t\tif (action === 'delete_from_analysis_log') {\n\t\t\tspbc_scanner_analysis_log_delete_from_log(jQuery(this));\n\t\t\treturn;\n\t\t}\n\n\t\tif (action === 'allow' || action === 'ban') {\n\t\t\tlet send_action = action === 'ban' ? 'deny' : action;\n\t\t\tlet items = self.parents('.tbl-root').find('.cb-select:checked');\n\t\t\tif (items) {\n\t\t\t\tself.children('.tbl-preloader--small').show();\n\t\t\t\titems.each(function() {\n\t\t\t\t\tlet ip = jQuery(this).parents('tr').find('.tbl-row_action--'+action).data('ip');\n\t\t\t\t\tspbc_sec_logs__filter_ip(ip, send_action, true);\n\t\t\t\t\tjQuery(this).prop('checked', false);\n\t\t\t\t});\n\t\t\t}\n\t\t\tself.children('.tbl-preloader--small').hide();\n\t\t\tlet msg = action === 'allow' ? 'Allowed' : 'Banned';\n\t\t\tlet html = '<p> Success. Selected IPs have been ' + msg + '. Changes will be applied within 10 minutes.' + '</p>';\n\t\t\tspbcModal.open().put( html );\n\t\t\tsetTimeout(spbc_reload_accordion, 1900);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif( action !== '-1' && self.parents('.tbl-root').find('.cb-select').is(':checked') ){\n\t\t\tself.children('.tbl-preloader--small').show();\n\t\t\tif(self.parents('.tbl-root').find('.cb-select:checked').first().parents('tr').find('.tbl-row_action--'+action)[0]){\n\t\t\t\tself.parents('.tbl-root').find('.cb-select:checked').first().parents('tr').find('.tbl-row_action--'+action).click();\n\t\t\t\tself.parents('.tbl-root').find('.cb-select:checked').first().prop('checked', false);\n\t\t\t}else{\n\t\t\t\tself.parents('.tbl-root').find('.cb-select:checked').first().prop('checked', false);\n\t\t\t\tself.click();\n\t\t\t}\n\t\t}else{\n\t\t\tself.children('.tbl-preloader--small').hide();\n\t\t\tspbc_bulk_action = null;\n\t\t\tif ( action === 'check_analysis_status' && typeof out !== undefined){\n\t\t\t\tlet html = '<p> All available files are updated.' + '</p>';\n\t\t\t\tspbcModal.open().put( html );\n\t\t\t}\n\t\t\tif ( action === 'send' && typeof out !== undefined){\n\t\t\t\tlet html = '<p> All available files are sent.' + '</p>';\n\t\t\t\tspbcModal.open().put( html );\n\t\t\t}\n\t\t\tsetTimeout(spbc_reload_accordion, 1900);\n\t\t}\n\t});\n}\n\n/**\n * Cure selected files\n * @param current\n */\nfunction spbc_scanner__cure_selected(current)\n{\n\tconst selectedItems = current.closest('#spbc_tbl__scanner_cure_log').find('.cb-select:checked');\n\tlet selectedIds = [];\n\n\tif (selectedItems.length === 0) {\n\t\talert('Please, select elements.');\n\t}\n\n\tselectedItems.each(function (index, element) {\n\t\tconst elementId = jQuery(element).val();\n\t\tselectedIds.push(elementId);\n\t});\n\n\tconst data = {\n\t\taction: 'spbc_cure_selected',\n\t\tsecurity: spbcSettings.ajax_nonce,\n\t\tselectedIds: selectedIds,\n\t};\n\tjQuery.ajax({\n\t\ttype: \"POST\",\n\t\turl: spbcSettings.ajaxurl,\n\t\tdata: data,\n\t\tbeforeSend: function () {\n\t\t\tcurrent.closest('#spbc_tbl__scanner_cure_log').find('.tbl-button---white_blue .tbl-preloader--in_button').show();\n\t\t},\n\t\tsuccess: function(result) {\n\t\t\tcurrent.closest('#spbc_tbl__scanner_cure_log').find('.tbl-button---white_blue .tbl-preloader--in_button').hide();\n\t\t\tif (result.success) {\n\t\t\t\tspbcModal.open().put(result.data);\n\t\t\t\tdocument.addEventListener(\"spbcModalClosed\", function( e ) {\n\t\t\t\t\tdocument.location.reload();\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tspbcModal.open().putError(result.data);\n\t\t\t}\n\t\t},\n\t});\n}\n\n// TABLE ROW ACTIONS\nfunction spbc_tbl__row_actions__listen(){\n\tjQuery('.tbl-row_action--ajax')\n\t\t.off('click')\n\t\t.on('click', function(){\n\t\tconsole.log('spbc_tbl__row_actions__listen click');\n\t\tif ( spbc_scanner.active ) {\n\t\t\talert(spbcTableLocalize.scannerIsActive);\n\t\t\treturn;\n\t\t}\n\t\tvar self = jQuery(this);\n\t\tvar data = {\n\t\t\taction: 'spbc_tbl-action--row',\n\t\t\tadd_action: self.attr('row-action'),\n\t\t\tid: self.parents('.row-actions').attr('uid'),\n\t\t\tcols: self.parents('.row-actions').attr('cols_amount'),\n\t\t\tpage_url: self.parent().attr('uid'),\n\t\t\tpage_id: self.parent().attr('page_id'),\n\t\t};\n\t\tvar params = {\n\t\t\tcallback: spbc_tbl__row_actions__callback,\n\t\t\terrorOutput: function(msg){ spbcModal.open().putError( msg ); },\n\t\t\tspinner: self.parent().siblings('.tbl-preloader--tiny'),\n\t\t};\n\t\tif(!spbc_bulk_action){\n\t\t\tvar confirmation = spbcTable['warning_'+self.attr('row-action')] || spbcTable.warning_default;\n\t\t\tif ( data.add_action === 'copy_file_info' || data.add_action === 'check_analysis_status' || confirm(confirmation) ) {\n\t\t\t\tspbc_sendAJAXRequest(data, params, self.parents('tr'));\n\t\t\t}\n\t\t}\n\t\tif(spbc_bulk_action){\n\t\t\tspbc_sendAJAXRequest(data, params, self.parents('tr'));\n\t\t}\n\t});\n}\n\n\t// Callback for TABLE ROW ACTIONS\nfunction spbc_tbl__row_actions__callback(result, data, params, obj){\n\tif(result.color)    {obj.css({background: result.background, color: result.color});}\n\tif(result.html)     {\n\t\tobj.parent().parent().parent().prepend(result.html)\n\t\tsetTimeout(function(){obj.fadeOut(300);}, 1500);\n\t\tif( ! spbc_bulk_action) {\n\t\t\tsetTimeout(spbc_reload_accordion, 1900);\n\t\t}\n\t}\n\n\tif (\n\t\tdata.add_action === 'copy_file_info'\n\t) {\n\t\tif (result.success === true && result.data.file_info){\n\t\t\twindow.prompt(\"Copy the file info below and send it to support@cleantalk.org: \", result.data.file_info);\n\t\t} else {\n\t\t\tlet error_text = (typeof result.data.error !== 'undefined') ? result.data.error : 'Unknown copy_file_info error'\n\t\t\tspbcModal.open().putError( error_text );\n\t\t}\n\t}\n\n\tif(result.temp_html){\n\t\tvar tmp=obj.html(); \n\t\tobj.html(result.temp_html);\n\t\tif (result.updated_template !== undefined) {\n\t\t\tlet updatedType = result.updated_template_type;\n\t\t\tlet template = result.updated_template;\n\t\t\tlet rowsInTemplate = jQuery(template).find('.wp-list-table tbody tr');\n\t\t\tlet countRowInTemplate = rowsInTemplate.length;\n\t\t\tlet targetTab = jQuery('[aria-controls=\"spbc_scan_accordion_tab_' + updatedType + '\"]');\n\n\t\t\tif (targetTab.length > 0) {\n\t\t\t\tlet table = jQuery('#spbc_tbl__scanner_' + updatedType);\n\t\t\t\t// Count files in header\n\t\t\t\tjQuery('.spbc_bad_type_count.' + updatedType + '_counter').text(countRowInTemplate);\n\t\t\t\t// Count rows in table\n\t\t\t\tlet countExistingRows = table.find('.wp-list-table tbody tr').length;\n\t\t\t\ttable.remove();\n\t\t\t\tjQuery('#spbc_scan_accordion_tab_' + updatedType).append(template);\n\t\t\t\t// Marked new rows\n\t\t\t\tjQuery(jQuery('#spbc_scan_accordion_tab_' + updatedType).find('.wp-list-table tbody tr')).each(function (index, element) {\n\t\t\t\t\tif (++index > countExistingRows) {\n\t\t\t\t\t\tjQuery(element).css('outline', '1px solid green');\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\ttargetTab.click();\n\t\t\t} else {\n\t\t\t\tif (updatedType === 'analysis_log') {\n\t\t\t\t\tlet tabHeaderTemplate = '<h3 class=\"ui-accordion-header ui-corner-top ui-state-default ui-accordion-icons ui-accordion-header-collapsed ui-corner-all\" role=\"tab\" id=\"ui-id-2\" aria-controls=\"spbc_scan_accordion_tab_analysis_log\" aria-selected=\"false\" aria-expanded=\"false\" tabindex=\"-1\"><span class=\"ui-accordion-header-icon ui-icon ui-icon-triangle-1-e\"></span><a href=\"#\">Analysis Log (<span class=\"spbc_bad_type_count analysis_log_counter\">' + countRowInTemplate + '</span>)</a></h3>';\n\t\t\t\t\tlet tabBodyTemplate = '<div id=\"spbc_scan_accordion_tab_analysis_log\" class=\"ui-accordion-content ui-corner-bottom ui-helper-reset ui-widget-content\" aria-labelledby=\"ui-id-2\" role=\"tabpanel\" aria-hidden=\"true\" style=\"display: none;\"><p class=\"spbc_hint\">Files sent for analysis.</p><div id=\"spbc_tbl__scanner_analysis_log\" type=\"analysis_log\" class=\"tbl-root\">' +\n\t\t\t\t\t\ttemplate +\n\t\t\t\t\t\t'</div>';\n\t\t\t\t\tjQuery('#spbc_scan_accordion_tab_critical').after(tabHeaderTemplate + tabBodyTemplate);\n\t\t\t\t\ttargetTab.click();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tsetTimeout(function(){\n\t\t\tobj.html(tmp).css({background: 'inherit'}).find('.column-primary .row-actions .tbl-row_action--'+data.add_action).remove();\n\t\t\tspbc_tbl__bulk_actions__listen();\n\t\t\tspbc_tbl__row_actions__listen();\n\t\t\tspbcStartShowHide();\n\t\t},5000);\n\t}\n\tif(spbc_bulk_action)\n\t\tspbc_bulk_action.click();\n}\n\n// TABLE PAGINATION ACTIONS\nfunction spbc_tbl__pagination__listen(){\n\tvar data = {action: 'spbc_tbl-pagination',};\n\tvar params = {callback: spbc_tbl__pagination__callback, notJson: true,};\n\tjQuery('.tbl-pagination--button').on('click', function(){\n\t\tjQuery(this).parents('.tbl-root').find('.tbl-pagination--button').attr('disabled', 'disabled');\n\t});\n\tjQuery('.tbl-pagination--go').on('click', function(){\n\t\tvar self = jQuery(this);\n\t\tvar obj = self.parents('.tbl-root');\n\t\tdata.page = self.siblings('.tbl-pagination--curr_page').val();\n\t\tdata.type = obj.attr('type');\n\t\tparams.spinner = self.siblings('.tbl-preloader--small');\n\t\tspbc_sendAJAXRequest(data, params, obj);\n\t});\n\tjQuery('.tbl-pagination--prev').on('click', function(){\n\t\tvar self = jQuery(this);\n\t\tvar obj = self.parents('.tbl-root');\n\t\tdata.page = self.parents('.tbl-pagination--wrapper').attr('prev_page');\n\t\tdata.type = obj.attr('type');\n\t\tparams.spinner = self.siblings('.tbl-preloader--small');\n\t\tspbc_sendAJAXRequest(data, params, obj);\n\t});\n\tjQuery('.tbl-pagination--next').on('click', function(){\n\t\tvar self = jQuery(this);\n\t\tvar obj = self.parents('.tbl-root');\n\t\tdata.page = self.parents('.tbl-pagination--wrapper').attr('next_page');\n\t\tdata.type = obj.attr('type');\n\t\tparams.spinner = self.siblings('.tbl-preloader--small');\n\t\tspbc_sendAJAXRequest(data, params, obj);\n\t});\n\tjQuery('.tbl-pagination--end').on('click', function(){\n\t\tvar self = jQuery(this);\n\t\tvar obj = self.parents('.tbl-root');\n\t\tdata.page = self.parents('.tbl-pagination--wrapper').attr('last_page');\n\t\tdata.type = obj.attr('type');\n\t\tparams.spinner = self.siblings('.tbl-preloader--small');\n\t\tspbc_sendAJAXRequest(data, params, obj);\n\t});\n\tjQuery('.tbl-pagination--start').on('click', function(){\n\t\tvar self = jQuery(this);\n\t\tvar obj = self.parents('.tbl-root');\n\t\tdata.page = 1;\n\t\tdata.type = obj.attr('type');\n\t\tparams.spinner = self.siblings('.tbl-preloader--small');\n\t\tspbc_sendAJAXRequest(data, params, obj);\n\t});\n}\n\nfunction spbc_scanner__switch_table(obj, table){\n\tvar obj = jQuery(obj);\n\tconsole.log(obj.parents('.row-actions').attr('uid'));\n\tvar data = {action: 'spbc_tbl-switch', type: table, domain: obj.parents('.row-actions').attr('uid'),};\n\tvar params = {callback: spbc_tbl__pagination__callback, notJson: true,};\n\tspbc_sendAJAXRequest(data, params, obj.parents('.tbl-root'));\n}\n\n\t// Callback for TABLE PAGINATION ACTIONS\nfunction spbc_tbl__pagination__callback(result, data, params, obj){\n\t\n\tjQuery(obj)\n\t\t.html(result)\n\t\t.find('.tbl-pagination--button').removeAttr('disabled');\n\tspbc_tbl__bulk_actions__listen();\n\tspbc_tbl__row_actions__listen();\n\tspbc_tbl__pagination__listen();\n\tspbc_tbl__sort__listen();\n\tspbcStartShowHide();\n}\n\n// TABLE SORT ACTIONS\nfunction spbc_tbl__sort__listen(){\n\t\n\tvar params = {callback: spbc_tbl__sort__callback, notJson: true,};\n\tjQuery('.tbl-column-sortable').on('click', function(e){\n\t\tif (e.target.classList.contains('tbl-sorting_indicator')) {\n\t\t\tvar self = jQuery(this);\n\t\t\tvar obj = self.parents('.tbl-root');\n\t\t\tvar data = {\n\t\t\t\taction:   'spbc_tbl-sort',\n\t\t\t\torder_by: self.attr('id'),\n\t\t\t\torder:    self.attr('sort_direction'),\n\t\t\t\ttype:     obj.attr('type'),\n\t\t\t};\n\t\t\tspbc_sendAJAXRequest(data, params, obj);\n\t\t}\n\t});\n}\n\n\t// Callback for TABLE SORT ACTIONS\nfunction spbc_tbl__sort__callback(result, data, params, obj){\n\tjQuery(obj).html(result);\n\tspbc_tbl__bulk_actions__listen();\n\tspbc_tbl__row_actions__listen();\n\tspbc_tbl__pagination__listen();\n\tspbc_tbl__sort__listen();\n}\n\njQuery(document).ready(function(){\n\t\n\t// Table. Row actions handler\n\tspbc_tbl__bulk_actions__listen();\n\tspbc_tbl__row_actions__listen();\n\tspbc_tbl__pagination__listen();\n\tspbc_tbl__sort__listen();\n});\n\nfunction show_hide_rows(block_id, column_key) {\n\tlet className = '.' + column_key + '_block_' + block_id;\n\tlet block = jQuery(className);\n\tif (block.hasClass(\"mob_table_active\")){\n\t\tconsole.log('true');\n\t\tblock.removeClass(\"mob_table_active\")\n\t} else {\n\t\tconsole.log('false');\n\t\tblock.addClass(\"mob_table_active\");\n\t}\n\t/*if (jQuery(block).attr('style') == 'display:block'){\n\t\tjQuery(block).attr('style', 'display:none');\n\t} else {\n\t\tjQuery(block).attr('style', 'display:block');\n\t}*/\n}\n"],"names":["spbc_reload_accordion","spbc_sendAJAXRequest","action","notJson","callback","result","data","params","obj","jQuery","accordion","html","header","heightStyle","collapsible","active","spbc_tbl__bulk_actions__listen","spbc_tbl__row_actions__listen","spbc_tbl__pagination__listen","spbc_tbl__sort__listen","spbcStartShowHide","off","on","spbc_scanner","alert","spbcTableLocalize","scannerIsActive","self","this","siblings","children","first","selectedIndex","value","indexOf","confirm","spbcTable","warning_bulk","add_action","status","parents","attr","selectedItems","closest","find","let","selectedIds","each","index","element","elementId","val","push","fileIds","file_ids","button","spinner","out","counters","total","updated","skipped","failed","queued","spbcModal","open","put","files_sent_counter","errorOutput","error_text","comment","putError","timeout","e","spbc_bulk_action","spbc_scanner__cure_selected","spbc_scanner_analysis_log_delete_from_log","send_action","items","msg","show","ip","spbc_sec_logs__filter_ip","prop","hide","setTimeout","is","click","current","length","security","spbcSettings","ajax_nonce","ajax","type","url","ajaxurl","beforeSend","success","document","addEventListener","location","reload","confirmation","console","log","id","cols","page_url","parent","page_id","spbc_tbl__row_actions__callback","warning_default","color","css","background","prepend","fadeOut","file_info","window","prompt","error","temp_html","tmp","undefined","updated_template","updatedType","updated_template_type","template","countRowInTemplate","targetTab","table","text","countExistingRows","remove","append","tabHeaderTemplate","tabBodyTemplate","after","spbc_tbl__pagination__callback","page","spbc_scanner__switch_table","domain","removeAttr","spbc_tbl__sort__callback","target","classList","contains","order_by","order","show_hide_rows","block_id","column_key","block","hasClass","removeClass","addClass","ready"],"mappings":"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"}