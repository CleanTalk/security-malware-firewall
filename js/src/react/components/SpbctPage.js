import React from 'react';

class SpbctPage extends React.Component{
    constructor(props) {
        super(props);
        this.state = {date: new Date()};
    }

    componentDidMount() {
        jQuery('#spbc_gdpr_open_modal').on('click', function(){
            jQuery('#gdpr_dialog').dialog({
                modal:true,
                show: true,
                position: { my: "center", at: "center", of: window },
                width: +(jQuery('#wpbody').width() / 100 * 70), // 70% of #wpbody
                height: 'auto',
                title: 'GDPR compliance',
                draggable: false,
                resizable: false,
                closeText: "Close",
            });
        });
        jQuery('#wpfooter').hide();

        // Sync button
        jQuery('#spbc_button__sync').on('click', function(){
        jQuery('#spbc_button__sync_regular').hide();
        jQuery('#spbc_button__sync_action').show();
            spbc_sendAJAXRequest(
                {action: 'spbc_sync'},
                {
                    timeout: 25000,
                    button: document.getElementById('spbc_button__sync' ),
                    spinner: [jQuery('#spbc_button__sync .spbc_preloader_button')],
                    callback: function(result, data, params, obj){
                        jQuery('#spbc_button__sync .spbc_success').show(300);
                        setTimeout(function(){jQuery('#spbc_button__sync .spbc_success').hide(300);}, 2000);
                        jQuery('#spbc_button__sync_regular').show();
                        jQuery('#spbc_button__sync_action').hide();
                        if(result.reload) {
                            spbc_switchTab(jQuery('.spbc_tab_nav-scanner')[0]);
                            document.location.reload();
                        }
                    }
                }
            );
        });

        if( spbcSettings.key_changed ){
            jQuery('#spbc_button__sync').click();
        }
    }

    render() {
        console.log(this.props);
        const data = this.props.data;

        let feedback;
        if (data.feedback !== '') {
            feedback = <div style={{ marginTop: "1em" }} dangerouslySetInnerHTML={{__html: data.feedback }}></div>
        }

        let premium;
        if (data.premium !== '') {
            premium = <div style={{ marginTop: "1em" }} dangerouslySetInnerHTML={{__html: data.premium }}></div>
        }

        let goToCleanTalk;
        if (data.goToCleanTalkLink !== '') {
            goToCleanTalk = <div id="goToCleanTalk" className="spbc-div-2"
                style={{ display: "inline-block", position: "relative", top: "-2px", marginRight: "7px" }}>

                <a id="goToCleanTalkLink" className="spbc_manual_link" style={{ display: "flex", alignItems: "center" }}
                    target="_blank" href={data.goToCleanTalkLink}>
                    <svg width="18" height="18" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <g clipPath="url(#clip0_2972_159)">
                        <path d="M10.1669 7.69043H9.92542V5.16602C9.92542 4.81006 9.63684 4.52148 9.28089 4.52148C8.92494 4.52148 8.63636 4.81006 8.63636 5.16602V7.69043H7.34713V5.59575C7.34713 5.23979 7.05855 4.95121 6.70259 4.95121C6.34664 4.95121 6.05806 5.23979 6.05806 5.59575V7.69043H4.76883V6.45516C4.76883 6.09921 4.48025 5.81063 4.1243 5.81063C3.76834 5.81063 3.47977 6.09921 3.47977 6.45516V7.69043H3.23828C2.88233 7.69043 2.59375 7.97901 2.59375 8.33496C2.59375 8.69091 2.88233 8.97949 3.23828 8.97949H10.1669C10.5229 8.97949 10.8114 8.69091 10.8114 8.33496C10.8114 7.97901 10.5229 7.69043 10.1669 7.69043Z" fill="#026E88"/>
                        <path d="M7.15888 10.2695H3.23828C2.88233 10.2695 2.59375 10.5581 2.59375 10.9141C2.59375 11.27 2.88233 11.5586 3.23828 11.5586H7.15892C7.51487 11.5586 7.80345 11.27 7.80345 10.9141C7.80345 10.5581 7.51483 10.2695 7.15888 10.2695Z" fill="#026E88"/>
                        <path d="M22 1.68164C22 1.32569 21.7114 1.03711 21.3555 1.03711H0.644531C0.288578 1.03711 0 1.32569 0 1.68164V17.3808C0 17.7367 0.288578 18.0253 0.644531 18.0253H7.63224H14.3678H21.3555C21.7114 18.0253 22 17.7367 22 17.3808V1.68164ZM18.0461 15.9651L17.1296 16.5057L16.2131 15.9651C14.5561 14.9876 13.5266 13.1852 13.5266 11.2613V9.26421C14.26 9.0968 14.9079 8.6492 15.323 8.01566H18.9362C19.3471 8.64288 19.9864 9.08748 20.7109 9.25871V11.7362C20.5571 13.4779 19.5659 15.0685 18.0461 15.9651ZM1.28906 2.32617H20.7109V7.90394C20.359 7.7453 20.0664 7.4639 19.8993 7.10129C19.7939 6.87295 19.5654 6.72664 19.3139 6.72664H14.9453C14.6938 6.72664 14.4653 6.87291 14.36 7.10129C14.0948 7.6763 13.5147 8.04785 12.8822 8.04785C12.5262 8.04785 12.2376 8.33643 12.2376 8.69238V11.2613C12.2376 12.1256 12.4065 12.9698 12.7188 13.7527H1.28906V2.32617ZM1.28906 15.0418H13.4013C13.8409 15.6925 14.3938 16.2686 15.041 16.7363H1.28906V15.0418ZM19.2183 16.7363C19.7954 16.3193 20.2973 15.8161 20.7109 15.2507V16.7363H19.2183Z" fill="#026E88"/>
                        <path d="M18.3438 10.5598L16.8519 12.0518L16.3464 11.5464C16.0947 11.2947 15.6866 11.2947 15.4349 11.5464C15.1832 11.798 15.1832 12.2061 15.4349 12.4579L16.3961 13.4191C16.517 13.5399 16.6809 13.6079 16.8518 13.6079C17.0228 13.6079 17.1867 13.54 17.3075 13.4191L19.2553 11.4713C19.507 11.2197 19.507 10.8116 19.2553 10.5598C19.0036 10.3082 18.5955 10.3082 18.3438 10.5598Z" fill="#026E88"/>
                        </g>
                        <defs>
                        <clipPath id="clip0_2972_159">
                        <rect width="22" height="22" fill="white"/>
                        </clipPath>
                        </defs>
                    </svg>
                    &nbsp;&nbsp;
                    {data.goToCleanTalkText}
                </a>
            </div>;
        }

        let support;
        if (data.support2Link !== '') {
            support = <a target="_blank" href={data.support2Link}
                style={{ display: "inline-block", position: "relative", top: "-2px", textDecoration: "none" }}>
                <button type="button" className="spbc_manual_link" style={{ display: "flex", alignItems: "center" }}>
                    <svg width="18" height="18" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <g clipPath="url(#clip0_2972_165)">
                        <mask id="mask0_2972_165" style={{maskType: "luminance"}} maskUnits="userSpaceOnUse" x="0" y="0" width="22" height="23">
                        <path d="M0 0.00195503H22V22.002H0V0.00195503Z" fill="white"/>
                        </mask>
                        <g mask="url(#mask0_2972_165)">
                        <path d="M8.54492 16.1564C9.13342 19.1218 11.7492 21.3574 14.8875 21.3574C16.1852 21.3574 17.3933 20.975 18.4059 20.317L21.0435 21.0465L20.3139 18.409C20.9719 17.3963 21.3543 16.1882 21.3543 14.8906C21.3543 11.7523 19.1187 9.13651 16.1533 8.54801" stroke="#026E88" strokeWidth="1.26953" strokeMiterlimit="10"/>
                        <path d="M8.40039 0.646486C4.11696 0.646486 0.644531 4.11892 0.644531 8.40234C0.644531 9.93796 1.09093 11.3693 1.86085 12.5738L0.95541 15.8473L4.22894 14.9419C5.43348 15.7118 6.86477 16.1582 8.40039 16.1582C12.6838 16.1582 16.1562 12.6858 16.1562 8.40234C16.1562 4.11892 12.6838 0.646486 8.40039 0.646486Z" stroke="#026E88" strokeWidth="1.26953" strokeMiterlimit="10"/>
                        <path d="M9.04492 12.9355H7.75586V11.6465H9.04492V12.9355Z" fill="#026E88"/>
                        <path d="M6.46484 6.44727C6.46484 5.37936 7.33054 4.51367 8.39844 4.51367C9.46634 4.51367 10.332 5.37936 10.332 6.44727C10.332 7.0123 10.0896 7.52067 9.7031 7.87417L8.39844 9.06836V10.3574" stroke="#026E88" strokeWidth="1.26953" strokeMiterlimit="10"/>
                        </g>
                        </g>
                        <defs>
                        <clipPath id="clip0_2972_165">
                        <rect width="22" height="22" fill="white"/>
                        </clipPath>
                        </defs>
                    </svg>
                    &nbsp;&nbsp;
                    {data.support2Text}
                </button>
            </a>;
        }

        let sync;
        if (data.sync !== '') {
            sync = <button type="button" className="spbc_manual_link" id="spbc_button__sync"
                style={{ display: "inline-block", position: "relative", top: "-6px", marginRight: "7px" }}>
                <svg width="18" height="18" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg" style={{ position: "absolute", top: "5px" }}>
                    <g clipPath="url(#clip0_2972_179)">
                    <path d="M16.5 21.9991C16.4083 21.9991 16.3167 21.9808 16.2305 21.9441C16.0178 21.8534 11 19.668 11 15.1736V11.4905C11 11.1962 11.187 10.935 11.4666 10.8396L16.2791 9.20245C16.4221 9.15387 16.5779 9.15387 16.7209 9.20245L21.5334 10.8396C21.813 10.935 22 11.1962 22 11.4905V15.1736C22 19.668 16.9822 21.8534 16.7695 21.945C16.6833 21.9808 16.5917 21.9991 16.5 21.9991ZM12.375 11.9827V15.1727C12.375 18.228 15.543 20.065 16.5 20.549C17.457 20.065 20.625 18.228 20.625 15.1727V11.9827L16.5 10.5793L12.375 11.9827Z" fill="#026E88"/>
                    <path d="M16.2706 17.8756C16.0891 17.8756 15.9131 17.8041 15.7848 17.6739L13.9514 15.8406C13.6829 15.572 13.6829 15.1366 13.9514 14.868C14.22 14.5994 14.6554 14.5994 14.924 14.868L16.1973 16.1413L18.4706 13.1089C18.6961 12.8055 19.1288 12.7432 19.4331 12.9723C19.7365 13.1997 19.7979 13.6305 19.5697 13.9348L16.8197 17.6015C16.7005 17.761 16.5181 17.86 16.3183 17.8747C16.3027 17.8747 16.2871 17.8756 16.2706 17.8756Z" fill="#026E88"/>
                    <path d="M9.7075 19.25H2.52083C1.13025 19.25 0 18.1198 0 16.7292V2.52083C0 1.13025 1.13025 0 2.52083 0H13.0625C14.4531 0 15.5833 1.13025 15.5833 2.52083V7.49833C15.5833 7.87783 15.2753 8.18583 14.8958 8.18583C14.5163 8.18583 14.2083 7.87783 14.2083 7.49833V2.52083C14.2083 1.88925 13.6941 1.375 13.0625 1.375H2.52083C1.88925 1.375 1.375 1.88925 1.375 2.52083V16.7292C1.375 17.3608 1.88925 17.875 2.52083 17.875H9.7075C10.087 17.875 10.395 18.183 10.395 18.5625C10.395 18.942 10.087 19.25 9.7075 19.25Z" fill="#026E88"/>
                    <path d="M12.1458 8.70898H3.4375C3.058 8.70898 2.75 8.40098 2.75 8.02148C2.75 7.64198 3.058 7.33398 3.4375 7.33398H12.1458C12.5253 7.33398 12.8333 7.64198 12.8333 8.02148C12.8333 8.40098 12.5253 8.70898 12.1458 8.70898Z" fill="#026E88"/>
                    <path d="M8.47917 12.375H3.4375C3.058 12.375 2.75 12.067 2.75 11.6875C2.75 11.308 3.058 11 3.4375 11H8.47917C8.85867 11 9.16667 11.308 9.16667 11.6875C9.16667 12.067 8.85867 12.375 8.47917 12.375Z" fill="#026E88"/>
                    <path d="M7.5625 5.04102H3.4375C3.058 5.04102 2.75 4.73302 2.75 4.35352C2.75 3.97402 3.058 3.66602 3.4375 3.66602H7.5625C7.942 3.66602 8.25 3.97402 8.25 4.35352C8.25 4.73302 7.942 5.04102 7.5625 5.04102Z" fill="#026E88"/>
                    </g>
                    <defs>
                    <clipPath id="clip0_2972_179">
                    <rect width="22" height="22" fill="white"/>
                    </clipPath>
                    </defs>
                </svg>
                &nbsp;&nbsp;
                <span id="spbc_button__sync_regular" style={{ paddingLeft: "18px" }}>{data.sync}</span>
                <span className="--hide" id="spbc_button__sync_action" style={{ paddingLeft: "18px" }}>{data.syncProgress}</span>
                <img style={{ marginLeft: "10px", marginTop: "1px" }} className="spbc_preloader_button"
                    src={data.syncUrl} />
                <img style={{ marginLeft: "10px" }} className="spbc_success --hide" src={data.syncUrlProgress} />
            </button>
        }

        return (
           <div className="wrap">
                <div style={{display: "flex", flexWrap: "wrap", justifyContent: "space-between"}}>
                    <div>
                        <div style={{display: "flex", alignItems: "center", height: "40px"}}>
                            <h2 style={{marginRight: "0.5em"}}>{data.brandname}</h2>
                            <div>(Admins online: {data.adminsOnlineCount})</div>
                        </div>
                        <p style={{fontSize: "16px", fontWeight: "400", margin: "0px"}}>{data.nextScanLaunchTime}</p>
                    </div>
                    <div style={{ margin: "10px 0 10px 0", fontSize: "13px"}}>
                        <span>{data.supportOf}</span> &nbsp;
                        <span dangerouslySetInnerHTML={{__html: data.supportLink }}></span>
                        <div dangerouslySetInnerHTML={{__html: data.homepage }}></div>
                        <div dangerouslySetInnerHTML={{__html: data.gdprCompliance }}></div>
                        <div dangerouslySetInnerHTML={{__html: data.gdprDialog }}></div>
                        <div dangerouslySetInnerHTML={{__html: data.trademark }}></div>
                        {feedback}
                        {premium}
                    </div>
                </div>
                {goToCleanTalk}
                {support}&nbsp;&nbsp;
                {sync}
           </div>
        );
    }
}

export default SpbctPage;
