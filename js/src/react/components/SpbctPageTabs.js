import React from 'react';

class SpbctPage extends React.Component{
    constructor(props) {
        super(props);
        this.state = {date: new Date()};
    }

    componentDidMount() {
		jQuery('.spbc_tab_nav-summary').data('loaded', true); // Summary tab loaded by default
		jQuery('.spbc_tabs_nav_wrapper').on('click', '.spbc_tab_nav', function(event){
			spbcSwitchTab(event.currentTarget);
		});
		// Get additional params
        var params = {
            target: location.search.match(/spbc_target=(\S*?)(&|$)/) ? location.search.match(/spbc_target=(\S*?)(&|$)/)[1] : null,
            action: location.search.match(/spbc_action=(\S*?)(&|$)/) ? location.search.match(/spbc_action=(\S*?)(&|$)/)[1] : null,
            times: location.search.match(/spbc_times=(\S*?)(&|$)/)   ? location.search.match(/spbc_times=(\S*?)(&|$)/)[1]  : 3,
        };
        // Legacy support
        params.target = location.search.match(/spbc_highlight=(\S*?)(&|$)/) ? location.search.match(/spbc_highlight=(\S*?)(&|$)/)[1] : params.target;
        params.action = location.search.search(/spbc_highlight=(\S*?)(&|$)/) != -1
            ? 'highlight'
            : params.action;

		// Get open tab form query
		var spbc_tab = document.getElementsByClassName('spbc_tab_nav-' + (location.search.match(/spbc_tab=(\S*?)(&|$)/) ? location.search.match(/spbc_tab=(\S*?)(&|$)/)[1] : ''))[0] || null;

		// TAB SWITCHING
		// Switch by URL
		if(spbc_tab){

		// Switch to DEBUG
		}else if( +spbcSettings.debug ){
			spbc_tab = document.getElementsByClassName('spbc_tab_nav-debug')[0];
		// Switch by DEFAULT
		}else if( +spbcSettings.wpms && !+spbcSettings.is_main_site){
			spbc_tab = document.getElementsByClassName('spbc_tab_nav-security_log')[0];
		// Switch if Key is OK and SFW is ON
		}else if( +spbcSettings.key_is_ok && +spbcSettings.secfw_enabled ){
			spbc_tab = document.getElementsByClassName('spbc_tab_nav-traffic_control')[0];
		// Switch if Key is OK
		}else if( +spbcSettings.key_is_ok ){
			spbc_tab = document.getElementsByClassName('spbc_tab_nav-scanner')[0];
		// Switch if KEY IS BAD
		}else{
			spbc_tab = document.getElementsByClassName('spbc_tab_nav-settings_general')[0];
			params = {
			    target: 'spbc_key',
                action: 'highlight',
                times: 3,
            };
		}

		// Switch tab
		if(spbc_tab) spbcSwitchTab(spbc_tab, params);

        var ctrlKeyDown = false;

        jQuery(document).on("keyup", function(e) {
            if ((e.which || e.keyCode) == 17) ctrlKeyDown = false;
        });

        jQuery(document).on("keydown", function(e) {
            if (((e.which || e.keyCode) == 116) && ctrlKeyDown) {
                e.preventDefault();

                var active_tab = jQuery('.spbc_tab_nav--active')[0];
                var tab_name = active_tab.classList[1].replace('spbc_tab_nav-', '');

                if (tab_name === 'scanner') return;

                jQuery(active_tab).data('loaded', false);

                spbcSwitchTab(active_tab);

            } else if ((e.which || e.keyCode) == 17) {
                ctrlKeyDown = true;
            }
        });
    }

    render() {
        return this.getTabsHeader();
    }

    getTabsHeader() {
        //console.log(this.props);
        this.dataPrepared = {
            'criticalCount': null,
            'criticalDot': null,
            'vulnerabilitiesCount': null,
            'vulnerabilitiesDot': null,
            'keyIsOk': null,
            'displayDebug': null,
            'isWPMSMainSite': false,
            'isSecFWEnabled': true,
            'isFsWatcherEnabled': true,
            'isVulnerabilityCheckEnabled': true,
        };

        this.dataPrepared.isWPMSMainSite = +this.props.data.isWPMSMainSite;
        this.dataPrepared.isSecFWEnabled = +this.props.data.isSecFWEnabled;
        this.dataPrepared.isFsWatcherEnabled = +this.props.data.isFsWatcherEnabled;
        this.dataPrepared.isVulnerabilityCheckEnabled = +this.props.data.isVulnerabilityCheckEnabled;

        let dot = <div className="spbc_ring-container"><div className = "spbc_ringring"></div><div className="spbc_circle"></div></div>;

        if (this.props.data.criticalCount && this.props.data.criticalCount > 0) {
            this.dataPrepared.criticalCount = <span>({+this.props.data.criticalCount})</span>;
            this.dataPrepared.criticalDot = dot;
        }

        if (this.props.data.vulnerabilitiesCount && this.props.data.vulnerabilitiesCount > 0) {
            this.dataPrepared.vulnerabilitiesCount = <span>({+this.props.data.vulnerabilitiesCount})</span>;
            this.dataPrepared.vulnerabilitiesDot = dot;
        }

        if (!this.props.data.keyIsOk) {
            this.dataPrepared.keyIsOk = dot;
        }

        this.dataPrepared.displayDebug = "none";
        if (this.props.data.displayDebug === true) {
            this.dataPrepared.displayDebug = "flex";
        }
        return (
            <div>
                {/* <hr style={{ marginBottom: "1em", marginTop: "1em" }} /> */}
                <div className="spbc_tabs_nav_wrapper" style={{display: "flex", flexWrap: "wrap"}}>
                    {this.dataPrepared.isSecFWEnabled ? this.getFirewallTab() : ''}
                    {this.dataPrepared.isWPMSMainSite && this.dataPrepared.isVulnerabilityCheckEnabled ? this.getCriticalUpdatesTab() : ''}
                    {this.dataPrepared.isWPMSMainSite && this.dataPrepared.isFsWatcherEnabled ? this.getFSWTab() : ''}
                    {this.dataPrepared.isWPMSMainSite ? this.getScannerTab() : ''}
                    {this.getSecurityLogTab()}
                    {this.getSettingsTab()}
                    {this.getSummaryTab()}
                    {this.dataPrepared.isWPMSMainSite ? this.getDebugTab() : ''}
                </div>
            </div>
        )
    }

    getFirewallTab() {
        return (
            <h2 className="spbc_tab_nav spbc_tab_nav-traffic_control spbc_tab_nav--active"
                style={{display: "flex"}}>
                <svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path
                        d="M21.3554 5.20115H18.3724C18.2553 5.03834 18.1338 4.87983 18.011 4.71986C17.3452 3.85275 16.5907 2.86993 16.1948 0.538579C16.1561 0.310717 15.9984 0.120967 15.7814 0.0413889C15.5643 -0.038232 15.3213 0.00452184 15.1444 0.153279C12.6517 2.25037 12.0335 4.01887 11.8906 5.92917C11.5892 5.49678 11.3885 4.96066 11.3885 4.55667C11.3885 4.31359 11.2517 4.09119 11.0347 3.98149C10.8178 3.87179 10.5576 3.89353 10.3618 4.0376C9.87282 4.39755 9.45165 4.78633 9.09831 5.2012H0.64453C0.288578 5.2012 0 5.48977 0 5.84573V21.3574C0 21.7134 0.288578 22.0019 0.64453 22.0019H21.3554C21.7114 22.0019 22 21.7134 22 21.3574V5.84568C22 5.48973 21.7114 5.20115 21.3554 5.20115ZM10.3436 5.75162C10.6939 6.65912 11.3952 7.53775 12.2819 7.84845C12.7006 7.99532 13.1395 7.68367 13.1395 7.24019C13.1395 5.25229 13.2941 3.74095 15.1619 1.8798C15.6459 3.7562 16.38 4.71238 16.9884 5.50486C17.6481 6.36419 18.0871 6.95939 18.0871 8.4238C18.0871 10.9116 16.0632 12.9355 13.5754 12.9355C11.6675 12.9355 9.85306 11.6267 9.26091 9.82355C8.78774 8.38264 9.18232 6.93949 10.3436 5.75162ZM15.5117 14.2246V16.8027H6.48827V14.2246H15.5117ZM6.48827 6.49026H8.2615C8.17793 6.66858 8.10363 6.85008 8.04086 7.03549C7.81772 7.69445 7.73711 8.38242 7.79765 9.06838H6.48827V6.49026ZM1.28906 6.49021H5.19921V9.06833H1.28906V6.49021ZM1.28906 10.3574H8.08253C8.4372 11.3486 9.09097 12.2534 9.94591 12.9355H1.28906V10.3574ZM1.28906 14.2246H5.19921V16.8027H1.28906V14.2246ZM10.3554 20.7128H1.28906V18.0918H10.3554V20.7128ZM20.7109 20.7128H11.6445V18.0918H20.7109V20.7128ZM20.7109 16.8027H16.8007V14.2246H20.7109V16.8027ZM20.7109 12.9355H17.217C18.0431 12.2675 18.6826 11.3777 19.0444 10.3574H20.7109V12.9355ZM20.7109 9.06833H19.3402C19.3637 8.85663 19.3762 8.64165 19.3762 8.4238C19.3762 7.62171 19.2609 7.00425 19.0759 6.49021H20.7109V9.06833Z"
                        fill="#1D2327"/>
                </svg>
                <div style={{marginLeft: "5px"}}>Firewall</div>
            </h2>
        )
    }

    getFSWTab() {
        return (
            <h2 className="spbc_tab_nav spbc_tab_nav-fswatcher" style={{display: "flex"}}>
                <svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <g clipPath="url(#clip0_3710_3316)">
                        <mask id="mask0_3710_3316" style={{maskType: "luminance"}} maskUnits="userSpaceOnUse" x="0" y="0" width="22" height="23">
                            <path d="M0 0.00390816H22V22.0039H0V0.00390816Z" fill="white"/>
                        </mask>
                        <g mask="url(#mask0_3710_3316)">
                            <path d="M16.1133 4.94336H11.8164V0.646485L16.1133 4.94336Z" stroke="#1D2327" strokeWidth="1.32813" strokeMiterlimit="10" strokeLinecap="round" strokeLinejoin="round"/>
                        </g>
                        <path d="M3.22266 7.52148H10.5273" stroke="#1D2327" strokeWidth="1.32813" strokeMiterlimit="10" strokeLinecap="round" strokeLinejoin="round"/>
                        <path d="M3.22266 10.0996H8.80859" stroke="#1D2327" strokeWidth="1.32813" strokeMiterlimit="10" strokeLinecap="round" strokeLinejoin="round"/>
                        <path d="M3.22266 12.6777H8.80859" stroke="#1D2327" strokeWidth="1.32813" strokeMiterlimit="10" strokeLinecap="round" strokeLinejoin="round"/>
                        <path d="M3.22266 15.2559H8.80859" stroke="#1D2327" strokeWidth="1.32813" strokeMiterlimit="10" strokeLinecap="round" strokeLinejoin="round"/>
                        <mask id="mask1_3710_3316" style={{maskType: "luminance"}} maskUnits="userSpaceOnUse" x="0" y="0" width="22" height="23">
                            <path d="M0 0.00390816H22V22.0039H0V0.00390816Z" fill="white"/>
                        </mask>
                        <g mask="url(#mask1_3710_3316)">
                            <path d="M17.7072 9.51355C19.2174 11.0238 19.2174 13.4723 17.7072 14.9826C16.197 16.4928 13.7483 16.4928 12.2382 14.9826C10.7279 13.4723 10.7279 11.0238 12.2382 9.51355C13.7483 8.00333 16.197 8.00333 17.7072 9.51355Z" stroke="#1D2327" strokeWidth="1.32813" strokeMiterlimit="10" strokeLinecap="round" strokeLinejoin="round"/>
                            <path d="M21.355 18.6309L17.709 14.9848" stroke="#1D2327" strokeWidth="1.32813" strokeMiterlimit="10" strokeLinecap="round" strokeLinejoin="round"/>
                            <path d="M16.1133 8.55413V4.94531L11.8166 0.648438H2.36328C1.41402 0.648438 0.644531 1.41796 0.644531 2.36719V19.6406C0.644531 20.5898 1.41402 21.3594 2.36328 21.3594H14.3945C15.3438 21.3594 16.1133 20.5898 16.1133 19.6406V15.9459" stroke="#1D2327" strokeWidth="1.32813" strokeMiterlimit="10" strokeLinecap="round" strokeLinejoin="round"/>
                        </g>
                    </g>
                    <defs>
                        <clipPath id="clip0_3710_3316">
                            <rect width="22" height="22" fill="white"/>
                        </clipPath>
                    </defs>
                </svg>
                <div style={{marginLeft: "5px"}}>File System Watcher</div>
            </h2>
        )
    }

    getScannerTab() {
        return (
            <h2 className="spbc_tab_nav spbc_tab_nav-scanner" style={{display: "flex"}}>
                <svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <g clipPath="url(#clip0_2972_209)">
                        <mask id="mask0_2972_209" style={{maskType: "luminance"}} maskUnits="userSpaceOnUse" x="-1"
                              y="0" width="23" height="23">
                            <path d="M21.9961 0.00390816H-0.00390434V22.0039H21.9961V0.00390816Z" fill="white"/>
                        </mask>
                        <g mask="url(#mask0_2972_209)">
                            <path
                                d="M0.644533 8.38281C0.644533 12.6544 4.10734 16.1172 8.37891 16.1172C12.6505 16.1172 16.1133 12.6544 16.1133 8.38281C16.1133 4.11125 12.6505 0.648439 8.37891 0.648439C4.10734 0.648439 0.644533 4.11125 0.644533 8.38281Z"
                                strokeWidth="1.30623" strokeMiterlimit="10" strokeLinecap="round"
                                strokeLinejoin="round"/>
                            <path d="M10.6741 6.58789L12.2422 5.80384V4.51478" strokeWidth="1.30623"
                                  strokeMiterlimit="10" strokeLinecap="round" strokeLinejoin="round"/>
                            <path d="M6.07422 6.58789L4.50616 5.80384" strokeWidth="1.30623" strokeMiterlimit="10"
                                  strokeLinecap="round" strokeLinejoin="round"/>
                            <path d="M12.2422 8.38281H10.9531" strokeWidth="1.30623" strokeMiterlimit="10"
                                  strokeLinecap="round" strokeLinejoin="round"/>
                            <path d="M5.80078 8.38281H4.51172" strokeWidth="1.30623" strokeMiterlimit="10"
                                  strokeLinecap="round" strokeLinejoin="round"/>
                            <path
                                d="M5.80078 8.38281C5.80078 11.2305 6.95505 12.25 8.37891 12.25C9.80276 12.25 10.957 11.2305 10.957 8.38281C10.957 5.5351 9.80276 5.80469 8.37891 5.80469C6.95505 5.80469 5.80078 5.5351 5.80078 8.38281Z"
                                strokeWidth="1.30623" strokeMiterlimit="10" strokeLinecap="round"
                                strokeLinejoin="round"/>
                            <path d="M10.7443 10.212L12.2422 10.9609V12.25" strokeWidth="1.30623"
                                  strokeMiterlimit="10" strokeLinecap="round" strokeLinejoin="round"/>
                            <path d="M6.00781 10.212L4.50988 10.9609V12.25" strokeWidth="1.30623"
                                  strokeMiterlimit="10" strokeLinecap="round" strokeLinejoin="round"/>
                            <path
                                d="M9.66602 5.83594V4.51336C9.66602 3.80141 9.08886 3.2243 8.37695 3.2243C7.66505 3.2243 7.08789 3.80141 7.08789 4.51336V5.83594"
                                strokeWidth="1.30623" strokeMiterlimit="10" strokeLinecap="round"
                                strokeLinejoin="round"/>
                            <path d="M4.50977 5.80469V4.51562" strokeWidth="1.30623" strokeMiterlimit="10"
                                  strokeLinecap="round" strokeLinejoin="round"/>
                            <path
                                d="M12.8566 14.6872L19.1511 20.9817C19.4029 21.2335 19.7327 21.3594 20.0625 21.3594C20.3923 21.3594 20.7221 21.2335 20.9739 20.9817C21.4775 20.4782 21.4775 19.6625 20.9739 19.1589L14.6794 12.8644"
                                strokeWidth="1.30623" strokeMiterlimit="10"/>
                        </g>
                    </g>
                    <defs>
                        <clipPath id="clip0_2972_209">
                            <rect width="22" height="22" fill="white" transform="matrix(-1 0 0 1 22 0)"/>
                        </clipPath>
                    </defs>
                </svg>
                <div style={{position: "relative"}}>
                    <div style={{marginLeft: "5px"}}>Malware Scanner {this.dataPrepared.criticalCount}</div>
                    {this.dataPrepared.criticalDot}
                </div>
            </h2>
        )
    }

    getSecurityLogTab() {
        return (
            <h2 className="spbc_tab_nav spbc_tab_nav-security_log" style={{display: "flex"}}>
                <svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <g clipPath="url(#clip0_2972_239)">
                        <mask id="mask0_2972_239" style={{maskType: "luminance"}} maskUnits="userSpaceOnUse" x="0"
                              y="0" width="23" height="22">
                            <path d="M0.0078125 3.8147e-06H22.0078V22H0.0078125V3.8147e-06Z" fill="white"/>
                        </mask>
                        <g mask="url(#mask0_2972_239)">
                            <path
                                d="M1.93359 14.4785H20.0664C20.7783 14.4785 21.3555 15.0557 21.3555 15.7676V20.0645C21.3555 20.7764 20.7783 21.3535 20.0664 21.3535H1.93359C1.22169 21.3535 0.644531 20.7764 0.644531 20.0645V15.7676C0.644531 15.0557 1.22169 14.4785 1.93359 14.4785Z"
                                strokeWidth="1.2985" strokeMiterlimit="10" strokeLinecap="round"
                                strokeLinejoin="round"/>
                            <path d="M7.7832 18.8867L9.7168 16.9531" strokeWidth="1.2985" strokeMiterlimit="10"
                                  strokeLinecap="round" strokeLinejoin="round"/>
                            <path d="M9.7168 18.8867L7.7832 16.9531" strokeWidth="1.2985" strokeMiterlimit="10"
                                  strokeLinecap="round" strokeLinejoin="round"/>
                            <path d="M3.26562 18.8867L5.19922 16.9531" strokeWidth="1.2985" strokeMiterlimit="10"
                                  strokeLinecap="round" strokeLinejoin="round"/>
                            <path d="M5.19922 18.8867L3.26562 16.9531" strokeWidth="1.2985" strokeMiterlimit="10"
                                  strokeLinecap="round" strokeLinejoin="round"/>
                            <path d="M12.2891 18.8867L14.2227 16.9531" strokeWidth="1.2985" strokeMiterlimit="10"
                                  strokeLinecap="round" strokeLinejoin="round"/>
                            <path d="M14.2227 18.8867L12.2891 16.9531" strokeWidth="1.2985" strokeMiterlimit="10"
                                  strokeLinecap="round" strokeLinejoin="round"/>
                            <path d="M16.8066 18.8867L18.7402 16.9531" strokeWidth="1.2985" strokeMiterlimit="10"
                                  strokeLinecap="round" strokeLinejoin="round"/>
                            <path d="M18.7402 18.8867L16.8066 16.9531" strokeWidth="1.2985" strokeMiterlimit="10"
                                  strokeLinecap="round" strokeLinejoin="round"/>
                            <path
                                d="M5.41992 6.22656C5.41992 3.14154 7.92083 0.640626 11.0059 0.640626C14.0909 0.640626 16.5918 3.14154 16.5918 6.22656C16.5918 9.31159 14.0909 11.8125 11.0059 11.8125C7.92083 11.8125 5.41992 9.31159 5.41992 6.22656Z"
                                strokeWidth="1.2985" strokeMiterlimit="10" strokeLinecap="round"
                                strokeLinejoin="round"/>
                            <path
                                d="M11 3.2207C11.8306 3.2207 12.5039 3.89402 12.5039 4.72461V5.58398C12.5039 6.41457 11.8306 7.08789 11 7.08789C10.1694 7.08789 9.49609 6.41457 9.49609 5.58398V4.72461C9.49609 3.89402 10.1694 3.2207 11 3.2207Z"
                                strokeWidth="1.2985" strokeMiterlimit="10" strokeLinecap="round"
                                strokeLinejoin="round"/>
                            <path
                                d="M7.99805 10.9277V10.0929C7.99805 8.43172 9.34469 7.08508 11.0059 7.08508C12.667 7.08508 14.0137 8.43172 14.0137 10.0929V10.9277"
                                strokeWidth="1.2985" strokeMiterlimit="10" strokeLinecap="round"
                                strokeLinejoin="round"/>
                        </g>
                    </g>
                    <defs>
                        <clipPath id="clip0_2972_239">
                            <rect width="22" height="22" fill="white"/>
                        </clipPath>
                    </defs>
                </svg>
                <div style={{marginLeft: "5px"}}>Security Log</div>
            </h2>
        )
    }

    getSettingsTab() {
        return (
            <h2 className="spbc_tab_nav spbc_tab_nav-settings_general" style={{display: "flex"}}>
                <svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <g clipPath="url(#clip0_2972_281)">
                        <path
                            d="M11.5354 13.0716C11.2269 13.0716 10.9768 13.3217 10.9768 13.6302C10.9766 15.0762 9.80426 16.2481 8.35832 16.2479C6.91238 16.2476 5.74041 15.0753 5.74066 13.6294C5.74092 12.1836 6.91298 11.0117 8.35875 11.0117C8.66727 11.0117 8.91734 10.7616 8.91734 10.4531C8.91734 10.1446 8.66727 9.89453 8.35875 9.89453C6.29616 9.89595 4.62446 11.5676 4.62305 13.6302C4.62305 15.6933 6.29548 17.3657 8.35854 17.3657C10.4216 17.3657 12.094 15.6933 12.094 13.6302C12.094 13.3217 11.8439 13.0716 11.5354 13.0716Z"
                            fill="black"/>
                        <path
                            d="M15.9784 14.9199C15.9251 14.6161 15.6356 14.4129 15.3317 14.4662L14.1625 14.6711C13.9486 14.7086 13.7759 14.8666 13.7195 15.0763C13.5948 15.539 13.4104 15.9835 13.1708 16.3985C13.0616 16.587 13.072 16.8219 13.1974 17L13.8798 17.9724C13.9752 18.1079 13.9593 18.2924 13.842 18.4094L13.1407 19.1107C13.0238 19.2279 12.8396 19.244 12.7041 19.1489L11.7318 18.4666C11.5536 18.3411 11.3187 18.3307 11.1302 18.4399C10.7152 18.6796 10.2708 18.864 9.80805 18.9886C9.59836 19.045 9.44032 19.2178 9.40285 19.4317L9.19531 20.5995C9.16691 20.7626 9.02524 20.8816 8.85973 20.8814H7.86758C7.70206 20.8816 7.56044 20.7626 7.53199 20.5995L7.32703 19.4308C7.28956 19.2169 7.13152 19.0442 6.92184 18.9878C6.45902 18.8631 6.01442 18.6787 5.59926 18.4391C5.41071 18.3298 5.17584 18.3402 4.9977 18.4657L4.02703 19.1476C3.89159 19.2431 3.70709 19.2271 3.59004 19.1098L2.88879 18.4086C2.77174 18.2916 2.75563 18.1075 2.85055 17.972L3.53289 16.9996C3.65832 16.8215 3.66876 16.5866 3.55953 16.3981C3.31981 15.9831 3.13534 15.5386 3.01082 15.0759C2.95445 14.8662 2.78167 14.7082 2.56781 14.6707L1.39906 14.4658C1.2363 14.4374 1.11745 14.2962 1.11719 14.131V13.1389C1.11702 12.9734 1.236 12.8317 1.39906 12.8033L2.56781 12.5983C2.78167 12.5609 2.95445 12.4028 3.01082 12.1931C3.13526 11.7299 3.31972 11.285 3.55953 10.8697C3.66876 10.6812 3.65832 10.4463 3.53289 10.2681L2.85098 9.29876C2.7555 9.16332 2.77149 8.97881 2.88879 8.86177L3.59047 8.16009C3.70743 8.043 3.89168 8.02706 4.02703 8.12228L4.99941 8.80462C5.17756 8.93009 5.41243 8.94049 5.60098 8.83126C6.0161 8.59162 6.4607 8.40716 6.92356 8.28255C7.13324 8.22617 7.29128 8.0534 7.32875 7.83954L7.53371 6.67079C7.58699 6.36692 7.38384 6.07739 7.07996 6.02411C6.77609 5.97083 6.48656 6.17399 6.43328 6.47786L6.28805 7.30716C5.96948 7.41239 5.65937 7.54168 5.36035 7.69388L4.6707 7.21005C4.09131 6.80236 3.30254 6.87111 2.80242 7.3729L2.09859 8.072C1.59728 8.57237 1.52874 9.36089 1.93617 9.94028L2.42 10.6299C2.26776 10.929 2.13847 11.2393 2.03328 11.5581L1.20399 11.7033C0.507118 11.8257 -0.000858177 12.4314 1.19802e-06 13.1389V14.131C-0.000901146 14.8392 0.508021 15.4454 1.2057 15.567L2.035 15.7127C2.14019 16.0313 2.26948 16.3414 2.42172 16.6404L1.93617 17.33C1.52887 17.9095 1.59758 18.698 2.09902 19.1983L2.8007 19.8996C3.30099 20.4011 4.08964 20.4696 4.66899 20.062L5.35649 19.5782C5.6555 19.7304 5.96561 19.8596 6.28418 19.9649L6.42942 20.7942C6.55179 21.4922 7.15894 22.0007 7.86758 21.9986H8.85973C9.56811 21.9995 10.1743 21.4903 10.2957 20.7925L10.4414 19.9632C10.76 19.8579 11.0701 19.7287 11.3691 19.5765L12.0592 20.0603C12.6386 20.4678 13.4273 20.399 13.9275 19.8974L14.6291 19.1958C15.1306 18.6955 15.1993 17.9069 14.792 17.3275L14.3086 16.64C14.4608 16.341 14.59 16.0308 14.6953 15.7123L15.5246 15.5666C15.8285 15.5133 16.0316 15.2238 15.9784 14.9199Z"
                            fill="black"/>
                        <path
                            d="M20.9473 5.07031L20.3629 4.96805C20.2899 4.75733 20.2038 4.55138 20.1051 4.35145L20.4489 3.86719C20.803 3.3636 20.7433 2.6782 20.3075 2.2434L19.7541 1.68867C19.319 1.25194 18.6326 1.19204 18.1286 1.54688L17.6426 1.88762C17.4426 1.78888 17.2367 1.70277 17.026 1.62981L16.9254 1.04801C16.8196 0.441377 16.2925 -0.000986629 15.6768 1.65263e-06H14.8952C14.2794 -0.000771785 13.7525 0.441806 13.6469 1.04844L13.5442 1.63281C13.3335 1.70578 13.1276 1.79188 12.9276 1.89063L12.4416 1.54688C11.938 1.19273 11.2527 1.25241 10.8179 1.68824L10.2653 2.24168C9.82854 2.6767 9.76864 3.36312 10.1235 3.86719L10.4642 4.35317C10.3655 4.5531 10.2794 4.75905 10.2064 4.96977L9.62418 5.07031C9.01772 5.1761 8.5754 5.70294 8.57617 6.31856V7.10016C8.57497 7.71607 9.01742 8.24343 9.62418 8.34926L10.2081 8.45153C10.2811 8.66224 10.3672 8.86819 10.4659 9.06813L10.1248 9.5541C9.77058 10.0575 9.82987 10.7428 10.2653 11.1779L10.8179 11.7305C11.2527 12.1666 11.9384 12.2262 12.4421 11.8718L12.9293 11.5311C13.1293 11.6298 13.3352 11.7159 13.5459 11.7889L13.6486 12.3733C13.7544 12.9797 14.2813 13.4221 14.8969 13.4213H15.6785C16.2943 13.4213 16.8207 12.978 16.9254 12.3711L17.0277 11.7872C17.2384 11.7142 17.4444 11.6281 17.6443 11.5294L18.1286 11.8723C18.6326 12.2273 19.3191 12.1674 19.7541 11.7305L20.3071 11.1775C20.7426 10.7427 20.8025 10.0577 20.4489 9.5541L20.1073 9.06641C20.206 8.86643 20.2921 8.66053 20.3651 8.44981L20.9495 8.34711C21.5546 8.24072 21.9958 7.715 21.9957 7.10059V6.31899C21.9967 5.70307 21.5541 5.17593 20.9473 5.07031ZM20.8786 7.10188C20.8786 7.17479 20.8262 7.23714 20.7544 7.24969L19.8331 7.41125C19.6193 7.44872 19.4465 7.60676 19.3901 7.81645C19.2946 8.1712 19.1531 8.51194 18.9695 8.83008C18.8602 9.01863 18.8706 9.25349 18.9961 9.43164L19.5336 10.1982C19.5757 10.2579 19.5686 10.3392 19.5169 10.3907L18.9643 10.9433C18.9122 10.9933 18.8318 10.9991 18.7731 10.957L18.0052 10.4199C17.8271 10.2945 17.5922 10.2841 17.4037 10.3933C17.0855 10.577 16.7448 10.7184 16.39 10.8139C16.1808 10.871 16.0235 11.0441 15.9866 11.2578L15.825 12.1791C15.8125 12.2509 15.7501 12.3033 15.6772 12.3032H14.8952C14.8222 12.3033 14.7599 12.2509 14.7473 12.1791L14.5854 11.2578C14.5479 11.044 14.3898 10.8712 14.1802 10.8148C13.8253 10.7192 13.4844 10.5778 13.1661 10.3941C12.9775 10.2849 12.7427 10.2953 12.5645 10.4208L11.8001 10.957C11.7404 10.9991 11.6591 10.992 11.6076 10.9403L11.055 10.3877C11.0034 10.3362 10.9963 10.2549 11.0383 10.1952L11.5758 9.42863C11.7013 9.25049 11.7117 9.01562 11.6025 8.82707C11.4187 8.50897 11.2773 8.16819 11.1818 7.81344C11.1246 7.60435 10.9516 7.44722 10.7379 7.41039L9.81668 7.24883C9.74488 7.23628 9.69246 7.17394 9.6925 7.10102L9.69293 6.31899C9.69289 6.24607 9.74531 6.18372 9.81711 6.17117L10.7379 6.00918C10.9518 5.97171 11.1246 5.81367 11.1809 5.60399C11.2765 5.24924 11.4179 4.90849 11.6016 4.59035C11.7108 4.40181 11.7004 4.16694 11.575 3.98879L11.0387 3.22266C10.9967 3.16297 11.0038 3.08168 11.0555 3.03016L11.6085 2.47715C11.66 2.42546 11.7413 2.41837 11.801 2.46039L12.5671 2.99793C12.7453 3.12336 12.9801 3.1338 13.1687 3.02457C13.4868 2.84084 13.8276 2.69943 14.1823 2.60391C14.392 2.54753 14.55 2.37476 14.5875 2.1609L14.7491 1.23965C14.7622 1.16914 14.8234 1.11783 14.8952 1.11719H15.6768C15.7497 1.11715 15.812 1.16957 15.8246 1.24137L15.9861 2.16262C16.0236 2.37647 16.1816 2.54925 16.3913 2.60563C16.7461 2.7011 17.0869 2.84251 17.405 3.02629C17.5935 3.13552 17.8284 3.12512 18.0065 2.99965L18.7731 2.46211C18.8328 2.42009 18.9141 2.42718 18.9656 2.47887L19.5186 3.03188C19.5688 3.08361 19.5751 3.1637 19.5336 3.22266L18.9961 3.99051C18.8706 4.16866 18.8602 4.40353 18.9695 4.59207C19.1531 4.91021 19.2946 5.25096 19.3901 5.60571C19.4465 5.81539 19.6193 5.97343 19.8331 6.0109L20.7544 6.17246C20.8262 6.18501 20.8786 6.24736 20.8786 6.32028V7.10188Z"
                            fill="black"/>
                        <path
                            d="M15.2938 4.03711C13.8199 4.03711 12.625 5.23198 12.625 6.7059C12.6267 8.17912 13.8206 9.37301 15.2938 9.37469C16.7677 9.37469 17.9626 8.17981 17.9626 6.7059C17.9626 5.23198 16.7677 4.03711 15.2938 4.03711ZM15.2938 8.2575C14.4369 8.2575 13.7422 7.56282 13.7422 6.7059C13.742 5.84854 14.4364 5.15309 15.2938 5.15215V5.1543C16.1507 5.1543 16.8454 5.84897 16.8454 6.7059C16.8454 7.56282 16.1507 8.2575 15.2938 8.2575Z"
                            fill="black"/>
                    </g>
                    <defs>
                        <clipPath id="clip0_2972_281">
                            <rect width="22" height="22" fill="white"/>
                        </clipPath>
                    </defs>
                </svg>
                <div style={{position: "relative"}}>
                    <div style={{marginLeft: "5px"}}>General Settings</div>
                    {this.dataPrepared.keyIsOk}
                </div>
            </h2>
        )
    }

    getSummaryTab() {
        return (
            <h2 className="spbc_tab_nav spbc_tab_nav-summary" style={{display: "flex"}}>
                <svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <g clipPath="url(#clip0_2972_309)">
                        <path
                            d="M17.4381 2.88241H15.4478V1.99201C15.4478 1.70394 15.1335 1.57301 14.8455 1.57301H13.3004C12.9337 0.525466 12.0171 0.00169566 10.9696 0.00169566C9.93357 -0.0372525 8.99125 0.597999 8.63881 1.57301H7.11988C6.8318 1.57301 6.54373 1.70394 6.54373 1.99201V2.88241H4.55336C3.37389 2.89499 2.40896 3.82543 2.35352 5.00365V20.0096C2.35352 21.1619 3.40106 21.9999 4.55336 21.9999H17.4381C18.5904 21.9999 19.6379 21.1619 19.6379 20.0096V5.0037C19.5825 3.82543 18.6176 2.89499 17.4381 2.88241ZM7.59122 2.62055H9.0316C9.28303 2.58987 9.48499 2.39859 9.5292 2.14916C9.68429 1.47376 10.2768 0.988934 10.9696 0.970688C11.6559 0.99149 12.2395 1.47782 12.3837 2.14916C12.4307 2.40721 12.646 2.60095 12.9075 2.62055H14.4003V4.71563H7.59122V2.62055ZM18.5904 20.0097C18.5904 20.5858 18.0142 20.9525 17.4381 20.9525H4.55336C3.97721 20.9525 3.40106 20.5858 3.40106 20.0097V5.0037C3.45449 4.40399 3.95134 3.94097 4.55336 3.93H6.54368V5.26561C6.57135 5.55905 6.82549 5.77856 7.11983 5.76322H14.8454C15.1452 5.77961 15.4073 5.56311 15.4477 5.26561V3.92995H17.438C18.04 3.94097 18.5369 4.40394 18.5903 5.00365V20.0097H18.5904Z"
                            fill="#1D2327"/>
                        <path
                            d="M8.98041 11.7102C8.78397 11.5031 8.45785 11.4914 8.24712 11.684L6.57104 13.2815L5.86396 12.5482C5.66751 12.3411 5.34139 12.3295 5.13066 12.522C4.9278 12.7345 4.9278 13.0689 5.13066 13.2815L6.20437 14.3814C6.2973 14.4855 6.43154 14.543 6.57099 14.5385C6.70914 14.5366 6.84092 14.4801 6.93762 14.3814L8.98031 12.4435C9.18282 12.2577 9.19636 11.9429 9.01054 11.7404C9.00102 11.7299 8.99094 11.7198 8.98041 11.7102Z"
                            fill="#1D2327"/>
                        <path
                            d="M16.4963 12.8359H10.473C10.1837 12.8359 9.94922 13.0704 9.94922 13.3597C9.94922 13.649 10.1837 13.8835 10.473 13.8835H16.4963C16.7856 13.8835 17.0201 13.649 17.0201 13.3597C17.0201 13.0704 16.7856 12.8359 16.4963 12.8359Z"
                            fill="#1D2327"/>
                        <path
                            d="M8.98041 7.51681C8.78397 7.30973 8.45785 7.29805 8.24712 7.49064L6.57104 9.08812L5.86396 8.35482C5.66751 8.14775 5.34139 8.13607 5.13066 8.32865C4.9278 8.54119 4.9278 8.87558 5.13066 9.08812L6.20437 10.188C6.2973 10.2921 6.43154 10.3496 6.57099 10.3452C6.70914 10.3432 6.84092 10.2867 6.93762 10.188L8.98031 8.2501C9.18282 8.06434 9.19636 7.74954 9.01054 7.54708C9.00102 7.53651 8.99094 7.52643 8.98041 7.51681Z"
                            fill="#1D2327"/>
                        <path
                            d="M16.4963 8.64258H10.473C10.1837 8.64258 9.94922 8.87707 9.94922 9.16635C9.94922 9.45563 10.1837 9.69012 10.473 9.69012H16.4963C16.7856 9.69012 17.0201 9.45563 17.0201 9.16635C17.0201 8.87707 16.7856 8.64258 16.4963 8.64258Z"
                            fill="#1D2327"/>
                        <path
                            d="M8.98041 15.8976C8.78397 15.6906 8.45785 15.6789 8.24712 15.8715L6.57104 17.469L5.86396 16.7357C5.66751 16.5286 5.34139 16.517 5.13066 16.7095C4.9278 16.922 4.9278 17.2564 5.13066 17.469L6.20437 18.5689C6.2973 18.6729 6.43154 18.7305 6.57099 18.726C6.70914 18.7241 6.84092 18.6676 6.93762 18.5689L8.98031 16.6309C9.18282 16.4452 9.19636 16.1304 9.01054 15.9279C9.00102 15.9174 8.99094 15.9073 8.98041 15.8976Z"
                            fill="#1D2327"/>
                        <path
                            d="M16.4963 17.0234H10.473C10.1837 17.0234 9.94922 17.2579 9.94922 17.5472C9.94922 17.8365 10.1837 18.071 10.473 18.071H16.4963C16.7856 18.071 17.0201 17.8365 17.0201 17.5472C17.0201 17.2579 16.7856 17.0234 16.4963 17.0234Z"
                            fill="#1D2327"/>
                    </g>
                    <defs>
                        <clipPath id="clip0_2972_309">
                            <rect width="22" height="22" fill="white"/>
                        </clipPath>
                    </defs>
                </svg>
                <div style={{marginLeft: "5px"}}>Summary</div>
            </h2>
        )
    }

    getCriticalUpdatesTab() {
        return (
            <h2 className="spbc_tab_nav spbc_tab_nav-critical_updates" style={{display: "flex"}}>
                <svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <g clipPath="url(#clip0_4058_112)">
                        <path
                            d="M13.2433 21.0002H2.52304C1.53779 21.0002 0.736328 20.2152 0.736328 19.2502V2.95512C0.736328 1.99009 1.53779 1.20508 2.52304 1.20508H8.46673C8.79554 1.20508 9.0623 1.46637 9.0623 1.78843C9.0623 2.11048 8.79554 2.37178 8.46673 2.37178H2.52304C2.19462 2.37178 1.92747 2.63345 1.92747 2.95512V19.2502C1.92747 19.5718 2.19462 19.8335 2.52304 19.8335H13.2433C13.5721 19.8335 13.8389 20.0948 13.8389 20.4168C13.8389 20.7389 13.5721 21.0002 13.2433 21.0002Z"
                            fill="#1D2327"/>
                        <path
                            d="M18.4042 10.4999C18.0754 10.4999 17.8087 10.2386 17.8087 9.91657V2.95512C17.8087 2.63345 17.5415 2.37178 17.2131 2.37178H11.2694C10.9406 2.37178 10.6738 2.11048 10.6738 1.78843C10.6738 1.46637 10.9406 1.20508 11.2694 1.20508H17.2131C18.1983 1.20508 18.9998 1.99009 18.9998 2.95512V9.91657C18.9998 10.2386 18.733 10.4999 18.4042 10.4999Z"
                            fill="#1D2327"/>
                        <path
                            d="M7.68541 10.8897C7.35661 10.8897 7.08984 10.6284 7.08984 10.3064C7.08984 9.98433 7.35661 9.72304 7.68541 9.72304L16.0234 9.72266C16.3522 9.72266 16.619 9.98395 16.619 10.306C16.619 10.6281 16.3522 10.8894 16.0234 10.8894L7.68541 10.8897Z"
                            fill="#1D2327"/>
                        <path
                            d="M4.30822 11.4675C4.1349 11.4675 3.97011 11.3934 3.85728 11.265L3.2617 10.5883C3.04689 10.3441 3.07481 9.97566 3.32374 9.76564C3.57306 9.55486 3.94917 9.58259 4.16359 9.82641L4.30163 9.98326L4.84447 9.34902C5.0554 9.10254 5.43073 9.06988 5.68354 9.27686C5.93557 9.48384 5.96853 9.85147 5.75721 10.0987L4.76459 11.259C4.65253 11.39 4.48697 11.4663 4.31249 11.4675H4.30822Z"
                            fill="#1D2327"/>
                        <path
                            d="M7.68541 14.0538C7.35661 14.0538 7.08984 13.7929 7.08984 13.4704C7.08984 13.1484 7.35661 12.8871 7.68541 12.8871L10.8618 12.8867C11.1906 12.8867 11.4574 13.148 11.4574 13.4701C11.4574 13.7921 11.1906 14.0534 10.8618 14.0534L7.68541 14.0538Z"
                            fill="#1D2327"/>
                        <path
                            d="M4.30828 14.6339C4.13496 14.6339 3.97017 14.5599 3.85695 14.4315L3.26138 13.7544C3.04696 13.5102 3.07488 13.1418 3.32381 12.9314C3.5739 12.7206 3.94924 12.7491 4.16404 12.9925L4.30208 13.1497L4.84453 12.5155C5.05546 12.2683 5.43157 12.236 5.68321 12.443C5.93563 12.6496 5.96859 13.0176 5.75727 13.2644L4.76465 14.4251C4.65259 14.5565 4.48703 14.6328 4.31255 14.6339L4.30828 14.6339Z"
                            fill="#1D2327"/>
                        <path
                            d="M10.8618 17.2175H7.68541C7.35661 17.2175 7.08984 16.9562 7.08984 16.6341C7.08984 16.3121 7.35661 16.0508 7.68541 16.0508H10.8618C11.1906 16.0508 11.4574 16.3121 11.4574 16.6341C11.4574 16.9562 11.1906 17.2175 10.8618 17.2175Z"
                            fill="#1D2327"/>
                        <path
                            d="M4.30828 17.798C4.13496 17.798 3.97017 17.7239 3.85695 17.5956L3.26138 16.9184C3.04696 16.6742 3.07488 16.3058 3.32381 16.0954C3.5739 15.8846 3.94924 15.9131 4.16404 16.1566L4.30208 16.3138L4.84453 15.6796C5.05546 15.4323 5.43157 15.4 5.68321 15.607C5.93563 15.8136 5.96859 16.1816 5.75727 16.4285L4.76465 17.5891C4.65259 17.7205 4.48703 17.7969 4.31255 17.798L4.30828 17.798Z"
                            fill="#1D2327"/>
                        <path
                            d="M12.8371 8.55578H6.90545C6.2552 8.55578 5.67243 8.2265 5.3475 7.6743C5.02219 7.12285 5.02219 6.46393 5.3475 5.91248L8.31334 0.881098C8.63866 0.329269 9.22104 0 9.87129 0C10.5215 0 11.1039 0.329273 11.4292 0.881098L14.3951 5.91248C14.7204 6.46393 14.7204 7.12285 14.3951 7.6743C14.0701 8.2265 13.4874 8.55578 12.8371 8.55578ZM9.34473 1.46444L6.37889 6.49583C6.22069 6.76433 6.32616 7.0017 6.37889 7.09133C6.43163 7.18096 6.58866 7.38908 6.90545 7.38908H12.8371C13.1539 7.38908 13.3109 7.18095 13.3637 7.09133C13.4164 7.0017 13.5219 6.76433 13.3637 6.49583L10.3978 1.46444C10.2392 1.19594 9.97674 1.16669 9.87128 1.16669C9.76581 1.16669 9.50331 1.19594 9.34473 1.46444Z"
                            fill="#1D2327"/>
                        <path
                            d="M9.86901 4.89281C9.54021 4.89281 9.27344 4.63151 9.27344 4.30946V3.02085C9.27344 2.69879 9.54021 2.4375 9.86901 2.4375C10.1978 2.4375 10.4646 2.69879 10.4646 3.02085V4.30946C10.4646 4.63151 10.1978 4.89281 9.86901 4.89281Z"
                            fill="#1D2327"/>
                        <path
                            d="M9.86901 6.83538C9.54021 6.83538 9.27344 6.57408 9.27344 6.25203V6.05796C9.27344 5.7359 9.54021 5.47461 9.86901 5.47461C10.1978 5.47461 10.4646 5.7359 10.4646 6.05796V6.25203C10.4646 6.57408 10.1978 6.83538 9.86901 6.83538Z"
                            fill="#1D2327"/>
                        <rect x="12.5" y="12.5" width="9" height="9" rx="0.5" fill="#FDFDFD"/>
                        <path d="M15 15.207V16.457H16.25" strokeWidth="0.8" strokeLinecap="round"
                              strokeLinejoin="round"/>
                        <path d="M19.5859 18.543V17.293H18.3359" strokeWidth="0.8"
                              strokeLinecap="round" strokeLinejoin="round"/>
                        <path
                            d="M19.0604 16.2495C18.9548 15.9509 18.7752 15.684 18.5384 15.4736C18.3017 15.2631 18.0155 15.1161 17.7066 15.0462C17.3977 14.9763 17.0761 14.9858 16.7718 15.0738C16.4676 15.1618 16.1906 15.3255 15.9667 15.5495L15 16.4578M19.5833 17.2912L18.6167 18.1995C18.3928 18.4235 18.1158 18.5872 17.8115 18.6752C17.5072 18.7632 17.1856 18.7727 16.8767 18.7028C16.5678 18.6329 16.2816 18.4859 16.0449 18.2755C15.8082 18.065 15.6286 17.7981 15.5229 17.4995"
                            strokeWidth="0.8" strokeLinecap="round" strokeLinejoin="round"/>
                    </g>
                    <defs>
                        <clipPath id="clip0_4058_112">
                            <rect width="22" height="22" fill="white"/>
                        </clipPath>
                    </defs>
                </svg>
                <div style={{position: "relative"}}>
                    <div style={{marginLeft: "5px"}}>Critical Updates{this.dataPrepared.vulnerabilitiesCount}</div>
                    {this.dataPrepared.vulnerabilitiesDot}
                </div>
            </h2>
        )
    }

    getDebugTab() {
        return (
            <h2 className="spbc_tab_nav spbc_tab_nav-debug" style={{display: this.dataPrepared.displayDebug}}>
                <div style={{marginLeft: "5px"}}>Debug</div>
            </h2>
        )
    }
}

export default SpbctPage;
