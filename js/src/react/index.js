import React from 'react';
import ReactDOM from 'react-dom/client';
import SettingsTabBackups from './components/SettingsTabBackups';
import SpbctPage from './components/SpbctPage';
import SpbctPageTabs from './components/SpbctPageTabs';
import SpbctPageNetworkDashboard from './components/SpbctPageNetworkDashboard';

addEventListener('spbctTabLoaded', (event) => {
    if ( event.detail.tab === 'backups' ) {
        const targetElement = document.getElementById('spbct-tab-backups--react');
        if ( targetElement !== null ) {
            const root = ReactDOM.createRoot(targetElement);
            root.render(<SettingsTabBackups />);
        }
    }
});

addEventListener('spbctPage', (event) => {
    const targetElement = document.getElementById('spbct-page--react');
    const data = JSON.parse(targetElement.dataset.data);

    if (targetElement !== null) {
        const root = ReactDOM.createRoot(targetElement);

        if (data.isNetworkAdminDashboard) {
            root.render(<SpbctPageNetworkDashboard data={data} />);
            return;
        }

        root.render(<SpbctPage data={data} />);
    }
});

addEventListener('spbctPageTabs', (event) => {
    console.log(event)
    const targetElement = document.getElementById('spbct-page-tabs--react');
    const data = JSON.parse(targetElement.dataset.data);

    if (targetElement !== null) {
        const root = ReactDOM.createRoot(targetElement);
        root.render(<SpbctPageTabs data={data} />);
    }
});
