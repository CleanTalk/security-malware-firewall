{"version":3,"sources":["spbc-common.js"],"names":["spbc_timestamp","Math","floor","Date","spbcHighlightElement","id","times","jQuery","addClass","animate","outlineColor","removeClass","spbc_sendAJAXRequest","data","params","obj","button","spinner","progressbar","callback","notJson","timeout","setAttribute","style","cursor","css","security","spbcSettings","ajax_nonce","ajax","type","url","ajaxurl","success","result","removeAttribute","JSON","parse","error","setTimeout","fadeOut","alert","jqXHR","textStatus","errorThrown","console","log","String","prototype","printf","formatted","this","arg","arguments","before_formatted","substring","indexOf","after_formatted","length"],"mappings":"AAWA,SAASA,iBACR,OAAOC,KAAKC,OAAO,IAAIC,KAAS,KAIjC,SAASC,qBAAqBC,EAAIC,GACjCA,EAAQA,EAAM,GAAK,EACnBC,OAAO,IAAIF,GAAIG,SAAS,oBACxBD,OAAO,IAAIF,GAAII,QAAQ,CAACC,aAAc,wBAA0B,IAAK,SAAU,WAC9EH,OAAO,IAAIF,GAAII,QAAQ,CAACC,aAAc,wBAA0B,IAAK,SAAU,WACrE,EAANJ,EACFF,qBAAqBC,EAAIC,GAEzBC,OAAO,IAAIF,GAAIM,YAAY,wBAM/B,SAASC,qBAAqBC,EAAMC,EAAQC,GAG3C,IAAIC,EAAcF,EAAOE,QAAe,KACpCC,EAAcH,EAAOG,SAAe,KACpCC,EAAcJ,EAAOI,aAAe,KACpCC,EAAcL,EAAOK,UAAe,KACpCC,EAAcN,EAAOM,SAAe,KACpCC,EAAcP,EAAOO,SAAe,KACpCN,EAAcA,GAAsB,KAGrCC,IAAUA,EAAOM,aAAa,WAAY,YAAaN,EAAOO,MAAMC,OAAS,eAC7EP,GAASV,OAAOU,GAASQ,IAAI,UAAW,UAG3CZ,EAAKa,SAAWC,aAAaC,WAE7BrB,OAAOsB,KAAK,CACXC,KAAM,OACNC,IAAKJ,aAAaK,QAClBnB,KAAMA,EACNoB,QAAS,SAASC,GACdlB,IAAUA,EAAOmB,gBAAgB,YAAanB,EAAOO,MAAMC,OAAS,WACpEP,GAAUV,OAAOU,GAASQ,IAAI,UAAW,QACxCL,IAASc,EAASE,KAAKC,MAAMH,IAC9BA,EAAOI,OACTC,WAAW,WAAerB,GAAaA,EAAYsB,QAAQ,SAAY,KACvEC,MAAM,mBAAqBP,EAAOI,OAAS,YAExCnB,GACFA,EAASe,EAAQrB,EAAMC,EAAQC,IAGlCuB,MAAO,SAASI,EAAOC,EAAYC,GAC/B5B,IAAUA,EAAOmB,gBAAgB,YAAanB,EAAOO,MAAMC,OAAS,WACpEP,GAASV,OAAOU,GAASQ,IAAI,UAAW,QAC3CoB,QAAQC,IAAI,mBACZD,QAAQC,IAAIJ,GACZG,QAAQC,IAAIH,GACZE,QAAQC,IAAIF,GACTA,GACFH,MAAMG,IAERvB,QAASA,IAzEX0B,OAAOC,UAAUC,OAAS,WACtB,IAAIC,EAAYC,KAChB,IAAK,IAAIC,KAAOC,UAAY,CAC9B,IAAIC,EAAmBJ,EAAUK,UAAU,EAAGL,EAAUM,QAAQ,KAAM,IAClEC,EAAmBP,EAAUK,UAAUL,EAAUM,QAAQ,KAAM,GAAG,EAAGN,EAAUQ,QACnFR,EAAYI,EAAmBD,UAAUD,GAAOK,EAE9C,OAAOP","file":"spbc-common.min.js","sourcesContent":["// Printf for JS\r\nString.prototype.printf = function(){\r\n    var formatted = this;\r\n    for( var arg in arguments ) {\r\n\t\tvar before_formatted = formatted.substring(0, formatted.indexOf(\"%s\", 0));\r\n\t\tvar after_formatted  = formatted.substring(formatted.indexOf(\"%s\", 0)+2, formatted.length);\r\n\t\tformatted = before_formatted + arguments[arg] + after_formatted;\r\n    }\r\n    return formatted;\r\n};\r\n\r\nfunction spbc_timestamp(){\r\n\treturn Math.floor(+new Date() / 1000);\r\n}\r\n\r\n// Hightlights element\r\nfunction spbcHighlightElement(id, times){\r\n\ttimes = times-1 || 0;\r\n\tjQuery('#'+id).addClass('spbc_highlighted');\r\n\tjQuery('#'+id).animate({outlineColor: \"rgba(255, 0, 0, 1.0)\" }, 400, 'linear', function(){\r\n\t\tjQuery('#'+id).animate({outlineColor: \"rgba(255, 0, 0, 0.0)\" }, 400, 'linear', function(){\r\n\t\t\tif(times>0){\r\n\t\t\t\tspbcHighlightElement(id, times);\r\n\t\t\t}else{\r\n\t\t\t\tjQuery('#'+id).removeClass('spbc_highlighted');\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n}\r\n\r\nfunction spbc_sendAJAXRequest(data, params, obj){\r\n\t\r\n\t// Default params\r\n\tvar button      = params.button      || null;\r\n\tvar spinner     = params.spinner     || null;\r\n\tvar progressbar = params.progressbar || null;\r\n\tvar callback    = params.callback    || null;\r\n\tvar notJson     = params.notJson     || null;\r\n\tvar timeout     = params.timeout     || 15000;\r\n\tvar obj         = obj                || null;\r\n\t\r\n\t// Button and spinner\r\n\tif(button)  {button.setAttribute('disabled', 'disabled'); button.style.cursor = 'not-allowed'; }\r\n\tif(spinner) jQuery(spinner).css('display', 'inline');\r\n\t\r\n\t// Adding security code\r\n\tdata.security = spbcSettings.ajax_nonce;\r\n\t\r\n\tjQuery.ajax({\r\n\t\ttype: \"POST\",\r\n\t\turl: spbcSettings.ajaxurl,\r\n\t\tdata: data,\r\n\t\tsuccess: function(result){\r\n\t\t\tif(button){  button.removeAttribute('disabled'); button.style.cursor = 'pointer'; }\r\n\t\t\tif(spinner)  jQuery(spinner).css('display', 'none');\r\n\t\t\tif(!notJson) result = JSON.parse(result);\r\n\t\t\tif(result.error){\r\n\t\t\t\tsetTimeout(function(){ if(progressbar) progressbar.fadeOut('slow'); }, 1000);\r\n\t\t\t\talert('Error happens: ' + (result.error || 'Unkown'));\r\n\t\t\t}else{\r\n\t\t\t\tif(callback)\r\n\t\t\t\t\tcallback(result, data, params, obj);\r\n\t\t\t}\r\n\t\t},\r\n\t\terror: function(jqXHR, textStatus, errorThrown){\r\n\t\t\tif(button){  button.removeAttribute('disabled'); button.style.cursor = 'pointer'; }\r\n\t\t\tif(spinner) jQuery(spinner).css('display', 'none');\r\n\t\t\tconsole.log('SPBC_AJAX_ERROR');\r\n\t\t\tconsole.log(jqXHR);\r\n\t\t\tconsole.log(textStatus);\r\n\t\t\tconsole.log(errorThrown);\r\n\t\t\tif(errorThrown)\r\n\t\t\t\talert(errorThrown);\r\n\t\t},\r\n\t\ttimeout: timeout,\r\n\t});\r\n}"]}