<?php

namespace CleantalkSP\Variables;

class Sanitizer {
    /**
     * Runs sanitizing process for input
     *
     * Now contains no filters: xss, url
     *
     * @param mixed $variable   Input to sanitize
     * @param string $filter_name Sanitizing filter name
     *
     * @return string
     */
    public static function sanitize($variable, $filter_name)
    {
        switch( $filter_name ){

            // XSS. Recursive.
            case 'xss':
                $variable_filtered = preg_replace( '#[\'"].*?>.*?<#i', '', $variable );
                return $variable === $variable_filtered
                    ? htmlspecialchars( $variable_filtered )
                    : static::sanitize( $variable_filtered, 'xss');

            // URL
            case 'url':
                return preg_replace( '#[^a-zA-Z0-9$\-_.+!*\'(),{}|\\^~\[\]`<>\#%";\/?:@&=.]#i', '', $variable );
        }

        return $variable;
    }
}