<?php


namespace CleantalkSP\Security\Firewall;


use CleantalkSP\Templates\DTO;

/**
 * Class Result
 *
 * Using it as contract between Firewall components
 *
 * @since   2.83
 * @version 1.0.0
 * @uses    \CleantalkSP\Templates\DTO
 * @package CleantalkSP\Security\Firewall
 */
class Result extends DTO
{
    /**
     * @var string Firewall module name
     */
	public $module        = 'FW';
    
    /**
     * @var string IP address
     */
	public $ip            = '';
    
    /**
     * @var string Firewall results status
     */
	public $status        = 'PASS';
    
    /**
     * @var int Is the Firewall result is from personal list
     */
	public $is_personal   = 0;
    
    /**
     * @var string Country code of the IP if present
     */
	public $country_code  = '';
    
    /**
     * @var int Integer that represent an IP address
     */
	public $network       = 0;
    
    /**
     * @var int Integer that represent a network mask
     */
	public $mask          = 0;
    
    /**
     * @var array The triggered WAF signature
     */
	public $pattern       = array();
    
    /**
     * @var string The part of the request which triggered WAF
     */
	public $triggered_for = '';
	
	public function __construct($params = array())
	{
		parent::__construct($params);
		
		switch ( $this->status ) {
			case 2:	 $this->status = 'PASS_BY_TRUSTED_NETWORK'; break;
			case 1:	 $this->status = 'PASS_BY_WHITELIST';       break;
			case 0:	 $this->status = 'DENY';                    break;
			case -1: $this->status = 'DENY_BY_NETWORK';         break;
			case -2: $this->status = 'DENY_BY_DOS';             break;
			case -3: $this->status = 'DENY_BY_SEC_FW';          break;
			case -4: $this->status = 'DENY_BY_SPAM_FW';         break;
		}
	}
}