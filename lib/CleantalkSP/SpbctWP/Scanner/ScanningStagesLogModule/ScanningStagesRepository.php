<?php

namespace CleantalkSP\SpbctWP\Scanner\ScanningStagesLogModule;

use CleantalkSP\SpbctWP\Scanner\ScanningStagesLogModule\Stages\GetCmsHashes;
use CleantalkSP\SpbctWP\Scanner\ScanningStagesLogModule\Stages\GetModulesHashes;

class ScanningStagesRepository
{
    const WP_OPTION_NAME = 'spbc_scanning_stages_log';

    public static function saveStageData($stage_name, $data)
    {
        self::updateStageData($stage_name, $data);
    }

    private static function updateStageData($stage_name, $data)
    {
        $log_data = get_option(self::WP_OPTION_NAME);

        switch ($stage_name) {
            case 'get_cms_hashes':
                $log_data['get_cms_hashes'] = GetCmsHashes::getFormatData($data);
            case 'get_modules_hashes':
                $log_data['get_modules_hashes'] = GetModulesHashes::getFormatData($data, $log_data);
        }

        update_option(self::WP_OPTION_NAME, $log_data);
    }

    private static function resetAllData()
    {
        update_option(self::WP_OPTION_NAME, array());
    }
}
