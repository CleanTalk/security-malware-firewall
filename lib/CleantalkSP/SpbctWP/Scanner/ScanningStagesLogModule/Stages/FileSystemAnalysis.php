<?php

namespace CleantalkSP\SpbctWP\Scanner\ScanningStagesLogModule\Stages;

use CleantalkSP\SpbctWP\Scanner\ScanningStagesLogModule\StageInterface;

class FileSystemAnalysis implements StageInterface
{
    const TITLE = 'Scanning for modifications';
    const DESCRIPTION = 'Scanning for modifications, what can i say yet';
    const STAGE_NAME = 'file_system_analysis';
    
    private $title;
    private $description;
    private $scanned_count_files;
    private $reset_scanned_count_files = 0;

    public function getFormatData($log_data)
    {
        if (!$this->reset_scanned_count_files) {
            $this->scanned_count_files += $log_data[self::STAGE_NAME]['scanned_count_files'] ?: 0;
        }
        
        return $this->toArray();
    }

    public function resetScannedCountFiles()
    {
        $this->reset_scanned_count_files = 1;
    }
    
    public function updateScannedCountFiles($count)
    {
        $this->scanned_count_files = $count;
    }

    private function toArray()
    {
        return array(
            'scanned_count_files' => $this->scanned_count_files
        );
    }
}
