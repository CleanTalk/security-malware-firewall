<?php

namespace CleantalkSP\SpbctWP\Scanner\ScanningStagesLogModule\Stages;

class SignatureAnalysis
{
    const TITLE = 'Signature analysis';
    const DESCRIPTION = 'Signature analysis - description';

    private $title;
    private $description;
    private $count_plugins;
    private $count_themes;

    public static function getFormatData($data, $log_data)
    {
        $count_files_for_analysis = !empty($data['count_files_for_analysis'])
            ? $data['count_files_for_analysis']
            : $log_data['signature_analysis']['count_files_for_analysis'];
        $count_files_to_check = !empty($log_data['signature_analysis']['count_files_to_check'])
            ? $log_data['signature_analysis']['count_files_to_check']
            : 0;
        $scanned_count_files = !empty($log_data['signature_analysis']['scanned_count_files'])
            ? $log_data['signature_analysis']['scanned_count_files']
            : 0;
        $statuses = !empty($log_data['signature_analysis']['statuses'])
            ? $log_data['signature_analysis']['statuses']
            : array();
      

        return array(
            'count_files_for_analysis' => $count_files_for_analysis,
            'count_files_to_check' => $count_files_to_check,
            'scanned_count_files' => $scanned_count_files,
            'statuses' => $statuses
        );
    }
}
