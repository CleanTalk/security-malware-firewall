<?php

namespace CleantalkSP\SpbctWP\Scanner\Frontend\Stages;

use CleantalkSP\SpbctWP\Scanner\Frontend\PublicPageModel;

class FindRedirectsStage implements FrontendMalwareInterface
{
    /**
     * @var PublicPageModel
     */
    private $page;

    public function analyse()
    {
        $dom = new \DOMDocument();

        try {
            @$dom->loadHTML($this->page->getContentPage());
        } catch (\Error $e) {
            error_log($e->getMessage());
        }
        $xpath = new \DOMXPath($dom);
        $jsTags = $xpath->evaluate("/html//script");
        dd($jsTags);
//
//        $url_exceptions = $this->except_urls
//            ? $this->home_url . '|' . implode('|', $this->except_urls)
//            : $this->home_url;
//
//        $results = $this->checkForAnything(
//            $this->js_tags,
//            '/location(?:\s*\.\s*href\s*)?\s*=\s*["\'](?:http[s]?:\/\/)(?:www\.)?(?!' . $url_exceptions . ').*/',
//            'regexp'
//        );
//
//        return $this->compileResults($results, 'redirects');
    }

    public function getResult()
    {
        // TODO: Implement getResult() method.
    }

    public  function setPage(PublicPageModel $page)
    {
        $this->page = $page;
    }
}