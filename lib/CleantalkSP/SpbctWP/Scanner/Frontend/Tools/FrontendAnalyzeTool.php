<?php

namespace CleantalkSP\SpbctWP\Scanner\Frontend\Tools;

use CleantalkSP\SpbctWP\Scanner\Frontend\FrontendScannerDispatcher;
use CleantalkSP\SpbctWP\Scanner\Frontend\Models\PublicPageModel;

abstract class FrontendAnalyzeTool
{
    /**
     * @var PublicPageModel
     */
    protected $page;
    protected $exclusions;
    protected $config;

    public function __construct(FrontendScannerDispatcher $config)
    {
        $this->config = $config;
    }

    abstract public function analyse();
    public function setPage(PublicPageModel $page) { $this->page = $page; }

    public function buildResult($type, $line, $code, $signature = null)
    {
        $result =  array(
            'type' => $type,
            'line' => $line,
            'code' => $code,
        );

        if ($signature) {
            $result['signature'] = $signature;
        }

        return $result;
    }
}