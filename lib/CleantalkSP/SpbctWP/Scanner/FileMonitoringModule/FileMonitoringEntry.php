<?php

namespace CleantalkSP\SpbctWP\Scanner\FileMonitoringModule;

class FileMonitoringEntry
{
    private static $important_files = array(
        '/.htaccess',
        '/wp-config.php',
        '/wp-admin/admin.php',
        '/wp-includes/functions.php',
        //'/wp-content/themes/*/functions.php',
    );

    /**
     * @var string
     */
    private $site_root;

    /**
     * @var array
     */
    private $theme_functions_paths;

    public function __construct()
    {
        $this->site_root = rtrim(ABSPATH, '/');
        $this->theme_functions_paths = FileMonitoringHelper::getThemeFunctionsPaths();
        $this->important_files = array_merge(self::$important_files, $this->theme_functions_paths);
        dd($this->important_files);
    }

    public function handle()
    {
        // Writing to the database of information about files
        // (_important_files, _important_file_snapshots)
//        foreach ()
        return $this;
    }

    public function getResults()
    {
        return array(
            'end' => 1,
        );
    }
}