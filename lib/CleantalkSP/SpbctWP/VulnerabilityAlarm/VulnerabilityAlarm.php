<?php

namespace CleantalkSP\SpbctWP\VulnerabilityAlarm;

class VulnerabilityAlarm
{
    const VULNERABILITY_LIST = 'spbc_vulnerabilities';

    const INSTALLED_PLUGINS_LIST = 'installed_plugins_list';

    /**
     * Get vulnerabilities from cloud and write to storage
     */
    public static function checkVulnerabilities()
    {
        VulnerabilityAlarmService::updateVulnerabilitiesLibrary();
    }

    /**
     * Show alarms in admin panel
     */
    public static function renderAlarms($content, $case = self::INSTALLED_PLUGINS_LIST)
    {
        VulnerabilityAlarmService::checkVulnerabilities();

        return VulnerabilityAlarmView::renderAlarms($content, $case);
    }

    /**
     * Render tab for spbct settings page
     * @psalm-suppress PossiblyUnusedMethod
     * @todo replace the suppressing above
     */
    public static function renderTab()
    {
        VulnerabilityAlarmService::checkVulnerabilities();
    }

    /**
     * Send report to cloud about installed vulnerability modules on site
     * @psalm-suppress PossiblyUnusedMethod
     * @todo replace the suppressing above
     */
    public static function sendReport()
    {
        VulnerabilityAlarmService::checkVulnerabilities();
    }
}
