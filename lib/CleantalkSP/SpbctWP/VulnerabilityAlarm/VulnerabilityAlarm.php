<?php

namespace CleantalkSP\SpbctWP\VulnerabilityAlarm;

class VulnerabilityAlarm
{
    const VULNERABILITY_LIST = 'spbc_vulnerabilities';

    const INSTALLED_PLUGINS_LIST = 'installed_plugins_list';

    /**
     * Get vulnerabilities from cloud and write to storage
     */
    public static function checkVulnerabilities()
    {
        VulnerabilityAlarmService::updateVulnerabilitiesLibrary();
    }

    public static function checkPluginVulnerability($plugin_file)
    {
        return VulnerabilityAlarmService::checkPlugin($plugin_file);
    }

    public static function showAlarm($plugin_file, $plugin_data)
    {
        VulnerabilityAlarmView::showPluginAlarm($plugin_file, $plugin_data);
    }

    /**
     * Render tab for spbct settings page
     * @psalm-suppress PossiblyUnusedMethod
     * @todo replace the suppressing above
     */
    public static function renderTab()
    {
        VulnerabilityAlarmService::checkVulnerabilities();
    }

    /**
     * Send report to cloud about installed vulnerability modules on site
     * @psalm-suppress PossiblyUnusedMethod
     * @todo replace the suppressing above
     */
    public static function sendReport()
    {
        VulnerabilityAlarmService::checkVulnerabilities();
    }
}
