<?php

namespace CleantalkSP\SpbctWP\VulnerabilityAlarm;

class VulnerabilityAlarm
{
    public const VULNERABILITY_LIST = 'spbc_vulnerabilities';

    public const INSTALLED_PLUGINS_LIST = 'installed_plugins_list';

    /**
     * Get vulnerabilities from cloud and write to storage
     */
    public static function checkVulnerabilities()
    {
        VulnerabilityAlarmService::updateVulnerabilitiesLibrary();
    }

    /**
     * Show alarms in admin panel
     */
    public static function renderAlarms($case = self::INSTALLED_PLUGINS_LIST, $content)
    {
        VulnerabilityAlarmService::checkVulnerabilities();

        return VulnerabilityAlarmView::renderAlarms($case, $content);
    }

    /**
     * Render tab for spbct settings page
     */
    public static function renderTab()
    {
        VulnerabilityAlarmService::checkVulnerabilities();

    }

    /**
     * Send report to cloud about installed vulnerability modules on site
     */
    public static function sendReport()
    {
        VulnerabilityAlarmService::checkVulnerabilities();

    }
}