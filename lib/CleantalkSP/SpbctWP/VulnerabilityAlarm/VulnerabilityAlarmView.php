<?php

namespace CleantalkSP\SpbctWP\VulnerabilityAlarm;

use CleantalkSP\SpbctWP\VulnerabilityAlarm\Dto\PluginReport;

class VulnerabilityAlarmView
{
    /**
     * @param string $plugin_file
     * @param PluginReport $plugin_report
     *
     * @return void
     */
    public static function showPluginAlarm($plugin_file, $plugin_report)
    {
        $active = is_plugin_active($plugin_file) ? 'active' : 'inactive';
        $slug = $plugin_report->app_name;
        ?>
        <tr
            id="<?= esc_attr($slug); ?>-vulnerable"
            class="plugin-update-tr spbc-vulnerable-notice <?= esc_attr($active); ?>"
            data-slug="<?= esc_attr($slug); ?>"
            data-plugin="<?= esc_attr($plugin_file); ?>"
        >
            <td colspan="4" class="plugin-update colspanchange">
                <div class="notice inline notice-error notice-alt">
                    <p><i class="spbc-icon-attention-alt" style="color: #d63638; font-size: 16px;"></i>The plugin contains known vulnerability <?= $plugin_report->CVE ?></p>
                </div>
            </td>
        </tr>
        <?php
    }

    /**
     * @psalm-suppress PossiblyUnusedMethod
     * @todo replace the suppressing above
     */
    public function renderTab()
    {
    }
}
